{"version":3,"file":"spreadsheet.min.js","sources":["../sources/math/parser.js","../sources/locale.js","../sources/locales/en.js","../sources/views/align.js","../sources/views/border.js","../sources/views/color.js","../sources/views/dialog.js","../sources/views/form.js","../sources/views/formlate.js","../sources/views/icons.js","../sources/views/list_suggest.js","../sources/views/suggest_formula.js","../sources/views/button.js","../sources/views/live_editor.js","../sources/views/separator.js","../sources/views/sheets.js","../sources/views/toggle.js","../sources/views/toolbar_title.js","../sources/views/multicheckbox.js","../sources/views/formlist.js","../sources/operations/undo_group.js","../sources/operations/save.js","../sources/helpers/column_names.js","../sources/toolbar/defaults.js","../sources/operations/styles.js","../sources/operations/formats.js","../sources/toolbar/actions.js","../sources/toolbar/buttons.js","../sources/toolbar/all_elements.js","../sources/toolbar.js","../sources/toolbar/helpers.js","../sources/operations/column_operations.js","../sources/table.js","../sources/hotkeys.js","../sources/math/methods/numbers.js","../sources/math/methods/strings.js","../sources/math/methods/other.js","../sources/math/methods.js","../sources/editor.js","../sources/helpers/array.js","../sources/sheets.js","../sources/dialogs/common.js","../sources/math/writer.js","../sources/dialogs/image.js","../sources/math/cache.js","../sources/math/updater.js","../sources/math/sheet.js","../sources/math/ranges.js","../sources/dialogs/sparkline.js","../sources/dialogs/ranges.js","../sources/dialogs/dropdown.js","../sources/dialogs/format.js","../sources/dialogs/conditional.js","../sources/dialogs/export.js","../sources/dialogs/link.js","../sources/dialogs/print.js","../sources/dialogs/comments.js","../sources/dialogs/sizing.js","../sources/dialogs/index.js","../sources/operations/lock_cell.js","../sources/operations/undo.js","../sources/operations/spans.js","../sources/operations/add_row_col.js","../sources/math/math.js","../sources/math/placeholder.js","../sources/operations/conditional_formats.js","../sources/operations/dropdown.js","../sources/operations/clipboard.js","../sources/operations/data.js","../sources/operations/hide_row_col.js","../sources/operations/resize.js","../sources/operations/selection.js","../sources/helpers/expand_selection.js","../sources/operations/sorting.js","../sources/operations/hide_gridlines.js","../sources/operations/hide_headers.js","../sources/operations/filter.js","../sources/operations/comments.js","../sources/operations/states.js","../sources/operations/import.js","../sources/operations/print.js","../sources/operations/export.js","../sources/operations/load.js","../sources/operations/clear_styles.js","../sources/api/row_col_operations.js","../sources/api/lock_cell.js","../sources/api/freeze.js","../sources/api/hide_gridlines.js","../sources/api/hide_headers.js","../sources/api/hide_rows.js","../sources/api/math.js","../sources/api/operations.js","../sources/api/core.js","../sources/api/save.js","../sources/api/dropdown.js","../sources/api/confirm.js","../sources/api/undo.js","../sources/api/number_formats.js","../sources/menu.js","../sources/helpers/conditional.js","../sources/spreadsheet.js","../sources/context.js","../sources/operations/index.js","../sources/api/index.js"],"sourcesContent":["function isChar(char){\n\tvar code = char.charCodeAt(0);\n\treturn (code>=65 && code<=122) || code === 36;\n}\nfunction isNumber(char){\n\tvar code = char.charCodeAt(0);\n\treturn code>=48 && code<=57;\n}\n\nfunction getWord(formula, i, passive){\n\tvar max = formula.length;\n\tvar sheet = passive;\n\tvar quotes = false;\n\t\n\tfor(var j=i; j<max; j++){\n\t\tvar key =  formula[j];\n\t\tif (key === \"'\"){\n\t\t\tquotes = !quotes;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\tif (key === \"!\"){\n\t\t\t\t//mulit-sheet math\n\t\t\t\tsheet = formula.substr(i, j-i);\n\t\t\t\tif (sheet[0] === \"'\")\n\t\t\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\t\t\ti=j+1;\n\t\t\t} else if (!isChar(key) && !isNumber(key)){\n\t\t\t\treturn [formula.substr(i, j-i), j, i, sheet];\n\t\t\t}\n\t\t}\n\t}\n\n\treturn [formula.substr(i), j, i, sheet];\n}\n\nvar operand = /^[A-Z$]+[0-9]+$/;\nfunction isPosition(text){\n\treturn operand.test(text);\n}\n\nexport function position(word){\n\tvar row = 0, sum = 0, x = 1, mode = 1, flags = 0;  \n\tvar chars = false;\n\n\tfor (var j =word.length-1; j>=0; j--){\n\t\tvar key = word[j].charCodeAt(0);\n\t\tif (key === 36) {\n\t\t\tflags = flags+mode;\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (key < 58){\n\t\t\t//numeric\n\t\t\tsum += (key - 48)*x;\n\t\t\tx *= 10;\n\t\t} else {\n\t\t\tif (!chars){\n\t\t\t\tx = 1; row = sum; sum = 0; chars = true; mode += 1;\n\t\t\t}\n\t\t\t//alpha\n\t\t\tsum += (key - 64)*x;\n\t\t\tx*=26;\n\t\t}\n\t}\n\t\n\t/*\n\t\t$X$Y => flags = 3\n\t\t$XY  => flags = 2\n\t\tX$Y  => flags = 1\n\t\tXY   => flags = 0\n\t*/\n\treturn [row, sum, flags];\t\n}\nfunction operandCode(deps, word, sheet){\n\tlet [r,c] = position(word);\n\n\tif (sheet !== \"\"){\n\t\tdeps.push([r,c,r,c,sheet]);\n\t\treturn `this.vs(\"${sheet}\",${r},${c})`;\n\t} else {\n\t\tdeps.push([r,c,r,c,\"\"]);\n\t\treturn `this.v(${r},${c})`;\n\t}\n}\n\nfunction methodCode(word){\n\treturn `this.m.${word}`;\n}\n\nfunction namedRangeCode(deps, view, word, sheet){\n\tvar code  = view.ranges.getCode(word, sheet);\n\tif(!code) return \"\";\n\n\tvar sheetInd = code.indexOf(\"!\");\n\tif (sheetInd !== -1){\n\t\tsheet = code.substr(0, sheetInd);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\tcode = code.substr(sheetInd+1);\n\t}\n\n\tlet [a,b] = code.split(\":\");\n\treturn rangeCode(deps, a, b, sheet);\n}\n\nfunction templateCode(word){\n\treturn `this.p.${word}`;\n}\n\nfunction rangeCode(deps, a, b, sheet){\n\tlet [r1,c1] = position(a);\n\tlet [r2,c2] = position(b);\n\n\tif (r1>r2) { let t=r1; r1=r2; r2=t; }\n\tif (c1>c2) { let t=c1; c1=c2; c2=t; }\n\t\n\tif (sheet === \"\"){\n\t\tdeps.push([r1,c1,r2,c2,\"\"]);\n\t\treturn `this.r(${r1},${c1},${r2},${c2})`;\n\t} else {\n\t\tdeps.push([r1,c1,r2,c2, sheet]);\n\t\treturn `this.rs(\"${sheet}\",${r1},${c1},${r2},${c2})`;\n\t}\n}\n\nexport function split(formula, crosssheet, ranges){\n\tvar lines = [];\n\tvar index = 0;\n\tvar quotes = false, ph = false;\n\tfor (var i = formula[i] === \"=\" ? 1 : 0; i < formula.length; i++){\n\t\tvar key = formula[i];\n\t\tif (key == \"\\\"\"){\n\t\t\tquotes = !quotes;\n\t\t} else if (!quotes){\n\t\t\tif (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\t\tph = true;\n\t\t\t} else if (key == \"}\" && formula[i+1] == \"}\"){\n\t\t\t\tph = false;\n\t\t\t} else if (!ph){\n\t\t\t\tif (key === \"'\" || isChar(key)){\n\t\t\t\t\tlet [word, end, ,sheet] = getWord(formula, i, \"\");\n\t\t\t\t\tlet next = end - 1;\n\t\t\t\t\tlet value;\n\t\t\t\t\tif (!sheet || (!crosssheet && sheet)){\n\t\t\t\t\t\tif(sheet)\n\t\t\t\t\t\t\ti += sheet.length + 1;\n\t\t\t\t\t\tif (formula[next+1] !== \"(\" && (isPosition(word) || (ranges && ranges[word]))){\n\t\t\t\t\t\t\tvalue = crosssheet ? word : position(word);\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tif(crosssheet){\n\t\t\t\t\t\t\tvalue = [sheet, word];\n\t\t\t\t\t\t\tpushLine(lines, formula, i, index, value);\n\t\t\t\t\t\t\tindex = next+1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ti = next;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif (index!=formula.length)\n\t\tlines.push(formula.substr(index));\n\treturn lines;\n}\n\nfunction pushLine(lines, formula, i, index, value){\n\tif (i!==0)\n\t\tlines.push(formula.substr(index, i-index));\n\tlines.push(value);\n}\n\nexport function parse(formula, view, passive = \"\"){\n\tvar code =\"return \";\n\tvar deps = [];\n\n\tvar quotes = false;\n\tvar pair = \"\", pairsheet = \"\";\n\t\n\tif (formula[0] !== \"=\") return false;\n\n\tfor (var i = 1; i < formula.length; i++){\n\t\tvar key = formula[i];\n\n\t\tif (key == \"\\\"\")\n\t\t\tquotes = !quotes;\n\t\telse if (key == \"{\" && formula[i+1] == \"{\"){\n\t\t\tlet [word, end] = getWord(formula, i+2);\n\t\t\ti = end + 1;\n\t\t\tcode += templateCode(word);\n\t\t\tcontinue;\n\t\t} else if (!quotes && (key === \"'\" || isChar(key))){\n\t\t\tlet [rawword, end, start, sheet] = getWord(formula, i, passive);\n\n\t\t\t//lower case formulas, fix them\n\t\t\tlet word = rawword.toUpperCase();\n\n\t\t\ti = end - 1;\n\n\t\t\tif (formula[i+1] === \"(\"){\n\t\t\t\tcode += methodCode(word);\n\t\t\t} else if (isPosition(word)){\n\t\t\t\tif (formula[i+1] === \":\"){\n\t\t\t\t\tpair = word; pairsheet = sheet;\n\t\t\t\t\ti++;\n\t\t\t\t} else {\n\t\t\t\t\tif (pair !== \"\"){\n\t\t\t\t\t\tcode += rangeCode(deps, pair, word, pairsheet);\n\t\t\t\t\t\tpair = \"\";\n\t\t\t\t\t} else \n\t\t\t\t\t\tcode += operandCode(deps, word, sheet);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet range = namedRangeCode(deps, view, word, sheet);\n\t\t\t\t//we have some error word in a formula\n\t\t\t\t//break from loop to skip formula updating\n\t\t\t\tif (range == \"\")\n\t\t\t\t\tcontinue; \n\t\t\t\tcode += range;\n\t\t\t}\n\n\t\t\t//operator, or range, or parameter\n\t\t\tif (word !== rawword){\n\t\t\t\tformula = formula.substr(0, start)+word+formula.substr(end);\n\t\t\t}\n\n\t\t\tcontinue;\n\t\t}\n\n\t\tif (!quotes){\n\t\t\t//special handling for & operator, string concat\n\t\t\tif (key === \"&\" && formula[i+1] !== \"&\")\n\t\t\t\tcode += \"+\";\n\t\t\t//convert <> to !=\n\t\t\telse if (key === \"<\" && formula[i+1] === \">\"){\n\t\t\t\tcode += \"!=\";\n\t\t\t\ti++;\n\t\t\t//convert = to ==\n\t\t\t} else if (key === \"=\" && formula[i-1] !== \"<\" && formula[i-1] !== \">\")\n\t\t\t\tcode += \"==\";\n\t\t\telse\n\t\t\t\tcode += key;\n\t\t} else\n\t\t\tcode += key;\n\t}\n\n\n\treturn { code: code+\";\", triggers:deps, text: formula };\n}","import en from \"./locales/en\";\nwebix.i18n.spreadsheet = en;","export default {\n\tlabels:{\n\t\t// formats\n\t\t\"common\": \"Common\",\n\t\t\"currency\": \"Currency\",\n\t\t\"number\": \"Number\",\n\t\t\"percent\": \"Percent\",\n\t\t\"custom-format\": \"Custom\",\n\t\t\"decimal-places\":\"Decimal places\",\n\t\t\"separator\":\"Group separator\",\n\t\t\"negative\":\"Negative number\",\n\t\t\"format-docs\":\"How to create a format\",\n\t\t// titles\n\t\t\"undo-redo\": \"Undo/Redo\",\n\t\t\"font\": \"Font\",\n\t\t\"text\": \"Text\",\n\t\t\"cell\": \"Cell\",\n\t\t\"align\": \"Align\",\n\t\t\"format\": \"Number\",\n\t\t\"column\": \"Column\",\n\t\t\"borders\": \"Borders\",\n\t\t\"px\": \"px\",\n\t\t\"apply\": \"Apply\",\n\t\t// popups and dialogs\n\t\t\"cancel\": \"Cancel\",\n\t\t\"save\": \"Save\",\n\t\t// multisheets\n\t\t\"sheet\": \"Sheet\",\n\t\t// conditions\n\t\t\"conditional-format\": \"Conditional Format\",\n\t\t\"condition\": \"Condition\",\n\t\t\"conditional-value\": \"Value\",\n\t\t\"conditional-style\": \"Style\",\n\t\t\"conditional-between\":\"between\",\n\t\t\"conditional-not-equal\":\"not equal\",\n\t\t// ranges\n\t\t\"range\": \"Range\",\n\t\t\"range-title\": \"Named ranges\",\n\t\t\"range-name\": \"Name\",\n\t\t\"range-cells\": \"Range\",\n\t\t// images\n\t\t\"image-or\": \"or\",\n\t\t\"image-title\": \"Add image\",\n\t\t\"image-upload\": \"Select file for upload\",\n\t\t\"image-url\": \"URL (e.g. http://*)\",\n\t\t// sparklines\n\t\t\"sparkline-title\": \"Add sparkline\",\n\t\t\"sparkline-type\": \"Type\",\n\t\t\"sparkline-range\": \"Range\",\n\t\t\"sparkline-color\": \"Color\",\n\t\t\"sparkline-positive\": \"Positive\",\n\t\t\"sparkline-negative\": \"Negative\",\n\t\t// custom format\n\t\t\"format-title\": \"Set format\",\n\t\t\"format-pattern\": \"Format pattern\",\n\t\t//dropdown\n\t\t\"dropdown-empty\": \"Empty cells\",\n\t\t\"dropdown-title\": \"Add dropdown\",\n\t\t\"dropdown-range\": \"Range\",\n\t\t// confirm\n\t\t\"ok\": \"OK\",\n\t\t// import/export\n\t\t\"import-title\": \"Import\",\n\t\t\"import-not-support\": \"Sorry, your browser does not support import\",\n\t\t\"export-title\": \"Export\",\n\t\t\"export-name\": \"Name of xslx file\",\n\t\t\"export-all-sheets\":\"Export all sheets\",\n\t\t// add link\n\t\t\"link-title\": \"Add Link\",\n\t\t\"link-name\": \"Text\",\n\t\t\"link-url\": \"URL\",\n\t\t//images\n\t\t\"image\": \"Image\",\n\t\t\"graph\": \"Graph\",\n\t\t//conditional format labels\n\t\t\"display\" : \"Display\",\n\t\t\"value\" : \"Value\",\n\t\t// confirm messages\n\t\t\"range-remove-confirm\": \"Are you sure you want to remove the range permanently?\",\n\t\t\"sheet-remove-confirm\": \"Are you sure you want to remove the sheet permanently?\",\n\t\t\"merge-cell-confirm\":\"Only the left top value will remain after merging. Continue?\",\n\t\t\"error-range\": \"The range is incorrect!\",\n\t\t//print\n\t\t\"print\":\"Print\",\n\t\t\"print-title\":\"Before you print..\",\n\t\t\"print-settings\":\"General settings\",\n\t\t\"print-paper\":\"Paper size\",\n\t\t\"print-layout\":\"Layout\",\n\t\t\"current-sheet\":\"Current sheet\",\n\t\t\"all-sheets\":\"All sheets\",\n\t\t\"selection\":\"Selected cells\",\n\t\t\"borderless\":\"Hide gridlines\",\n\t\t\"sheet-names\":\"Show sheet names\",\n\t\t\"skip-rows\":\"Skip empty rows\",\n\t\t\"margin\":\"Hide margins\",\n\t\t\"page-letter\":\"Letter\",\n\t\t\"page-a4\":\"A4 (210x297mm)\",\n\t\t\"page-a3\":\"A3 (297x420mm)\",\n\t\t\"page-width\":\"Page width\",\n\t\t\"page-actual\":\"Actual Size\",\n\t\t\"page-portrait\":\"Portrait\",\n\t\t\"page-landscape\":\"Landscape\",\n\t\t//comment\n\t\t\"comment\":\"Comment\",\n\t\t//resize\n\t\t\"width\":\"Width\",\n\t\t\"height\":\"Height\"\n\t},\n\ttooltips: {\n\t\t\"color\": \"Font color\",\n\t\t\"background\": \"Background color\",\n\t\t\"font-family\": \"Font family\",\n\t\t\"font-size\": \"Font size\",\n\t\t\"text-align\": \"Horizontal align\",\n\t\t\"vertical-align\": \"Vertical align\",\n\t\t\"borders\": \"Borders\",\n\t\t\"borders-no\": \"Clear borders\",\n\t\t\"borders-left\": \"Left border\",\n\t\t\"borders-top\": \"Top border\",\n\t\t\"borders-right\": \"Right border\",\n\t\t\"borders-bottom\": \"Bottom border\",\n\t\t\"borders-all\": \"All borders\",\n\t\t\"borders-outer\": \"Outer borders\",\n\t\t\"borders-top-bottom\": \"Top and bottom borders\",\n\t\t\"borders-color\": \"Border color\",\n\t\t\"align-left\": \"Left align\",\n\t\t\"align-center\": \"Center align\",\n\t\t\"align-right\": \"Right align\",\n\t\t\"align-top\": \"Top align\",\n\t\t\"align-middle\": \"Middle align\",\n\t\t\"align-bottom\": \"Bottom align\",\n\t\t\"span\": \"Merge\",\n\t\t\"wrap\": \"Text wrap\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"format\": \"Number format\",\n\t\t\"increase-decimals\":\"Increase decimal places\",\n\t\t\"decrease-decimals\":\"Decrease decimal places\",\n\t\t\"font-weight\": \"Bold\",\n\t\t\"font-style\": \"Italic\",\n\t\t\"text-decoration\": \"Underline\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"freeze-columns\" : \"Freeze/unfreeze columns\",\n\t\t\"add-range\": \"Set name for the selected range\",\n\t\t\"conditional\": \"Conditional formatting\",\n\t\t\"add-sheet\": \"Add Sheet\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"clear\": \"Clear\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"row\": \"Rows\",\n\t\t\"column\": \"Columns\",\n\t\t\"sheet\": \"Sheet\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"add-comment\": \"Comment\"\n\t},\n\tmenus:{\n\t\t\"remove-sheet\": \"Remove sheet\",\n\t\t\"rename-sheet\": \"Rename sheet\",\n\t\t\"file\": \"File\",\n\t\t\"new\": \"New\",\n\t\t\"new-sheet\": \"New sheet\",\n\t\t\"excel-import\": \"Import from Excel\",\n\t\t\"excel-export\": \"Export to Excel\",\n\t\t\"sheet\": \"Sheets\",\n\t\t\"copy-sheet\": \"Copy to new sheet\",\n\t\t\"edit\": \"Edit\",\n\t\t\"undo\": \"Undo\",\n\t\t\"redo\": \"Redo\",\n\t\t\"columns\": \"Columns\",\n\t\t\"insert-column\": \"Insert column\",\n\t\t\"delete-column\": \"Delete column\",\n\t\t\"show-column\": \"Show column\",\n\t\t\"hide-column\": \"Hide column\",\n\t\t\"resize-column\": \"Resize column\",\n\t\t\"rows\": \"Rows\",\n\t\t\"insert-row\": \"Insert row\",\n\t\t\"delete-row\": \"Delete row\",\n\t\t\"show-row\": \"Show row\",\n\t\t\"hide-row\": \"Hide row\",\n\t\t\"resize-row\": \"Resize row\",\n\t\t\"insert\": \"Insert\",\n\t\t\"conditional-format\": \"Conditional format\",\n\t\t\"clear\": \"Clear\",\n\t\t\"clear-value\":\"Values\",\n\t\t\"clear-style\":\"Styles\",\n\t\t\"clear-conditional-formats\":\"Conditional formats\",\n\t\t\"clear-dropdown-editors\":\"Dropdowns and filters\",\n\t\t\"clear-comments\":\"Comments\",\n\t\t\"clear-all\":\"All\",\n\t\t\"add-image\": \"Image\",\n\t\t\"add-sparkline\": \"Graph\",\n\t\t\"data\": \"Data\",\n\t\t\"add-link\": \"Add link\",\n\t\t\"add-range\": \"Named ranges\",\n\t\t\"sort\": \"Sort\",\n\t\t\"sort-asc\": \"Sort A to Z\",\n\t\t\"sort-desc\": \"Sort Z to A\",\n\t\t\"create-filter\": \"Create filter\",\n\t\t\"view\": \"View\",\n\t\t\"freeze-columns\": \"Freeze/unfreeze columns\",\n\t\t\"freeze-rows\": \"Freeze/unfreeze rows\",\n\t\t\"hide-gridlines\": \"Hide/show gridlines\",\n\t\t\"hide-headers\": \"Hide/show headers\",\n\t\t\"add-dropdown\": \"Add dropdown\",\n\t\t\"lock-cell\": \"Lock/unlock cell\",\n\t\t\"print\": \"Print\",\n\t\t\"add-comment\":\"Comment\"\n\t},\n\ttable:{\n\t\t\"math-error\":\"ERROR\"\n\t}\n};","webix.protoUI({\n\tname: \"ssheet-align\",\n\t$cssName:\"richselect\",\n\t$init: function(config){\n\t\tconfig.options =  {\n\t\t\tview:\"datasuggest\",\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-icons\",\n\t\t\t\ttooltip: {\n\t\t\t\t\ttemplate:\"#tooltip#\"\n\t\t\t\t},\n\t\t\t\txCount:3, yCount:1\n\t\t\t},\n\t\t\tdata: config.data\n\t\t};\n\t}\n},webix.ui.richselect);","webix.protoUI({\n\tname: \"ssheet-borders-suggest\",\n\tdefaults:{\n\t\twidth: 300\n\t},\n\t$init: function(config){\n\t\tconfig.body = {\n\t\t\tmargin: 6,\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-icons\", scroll: false, select: true,\n\t\t\t\t\txCount: 4,\n\t\t\t\t\tyCount: 2,\n\t\t\t\t\ttooltip: {\n\t\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\t\treturn webix.i18n.spreadsheet.tooltips[\"borders-\"+obj.id];\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ton:{\n\t\t\t\t\t\tonAfterSelect: function(){\n\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView();\n\t\t\t\t\t\t\tsuggest.updateMasterValue(true);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\tvar css = \"webix_ssheet_button_icon webix_ssheet_icon ssi-borders-\"+obj.value;\n\t\t\t\t\t\treturn \"<span class='\"+css+\"'></span>\";\n\t\t\t\t\t},\n\t\t\t\t\tdata: config.data\n\t\t\t\t},\n\t\t\t\t{ view: \"ssheet-separator\"},\n\t\t\t\t{\n\t\t\t\t\trows:[\n\t\t\t\t\t\t{ view: \"ssheet-color\", css: config.css,  name: config.name, width: 68, value: \"#000000\",\n\t\t\t\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"borders-color\"],\n\t\t\t\t\t\t\ttitle: \"<span class='webix_icon wxi-pencil'></span>\",\n\t\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\t\tonChange: function(){\n\t\t\t\t\t\t\t\t\tvar suggest = this.getParentView().getParentView().getParentView();\n\t\t\t\t\t\t\t\t\tsuggest.updateMasterValue(false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ }\n\t\t\t\t\t]\n\t\t\t\t}\n\n\t\t\t]\n\t\t};\n\t},\n\tupdateMasterValue: function(hide){\n\t\tvar value = this.getValue();\n\t\tvar master = webix.$$(this.config.master);\n\t\tmaster.setValue(value);\n\t\tif(hide)\n\t\t\tthis.hide();\n\t},\n\tsetValue: function(value){\n\t\tif(value[0])\n\t\t\tthis.getList().select(value[0]);\n\t\tif(value[1])\n\t\t\tthis.getColorView().setValue(value[1]);\n\t},\n\tgetValue: function(){\n\t\treturn [this.getList().getSelectedId(), this.getColorView().getValue()||\"\"];\n\t},\n\tgetList: function(){\n\t\treturn this.getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getBody().getChildViews()[2].getChildViews()[0];\n\t},\n\tgetItemText:function(){\n\t\treturn \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-borders-all'>\";\n\t}\n},webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-borders\",\n\t$cssName: \"richselect\",\n\t$init: function(config){\n\t\tconfig.options = {\n\t\t\tview: \"ssheet-borders-suggest\",\n\t\t\tfitMaster: false,\n\t\t\tdata: config.data\n\t\t};\n\n\t\tthis.$ready.push(webix.bind(function(){\n\t\t\tthis.getPopup().config.master = this.config.id;\n\t\t},this));\n\n\t},\n\tsetValue: function(value){\n\t\tif(webix.isArray(value)){\n\t\t\tif(!this.config.value || value[0] !=  this.config.value[0] || value[1] !=  this.config.value[1]){\n\t\t\t\tthis.getPopup().setValue(value);\n\t\t\t}\n\t\t\tthis.config.value = value;\n\t\t\tif (value[0])\n\t\t\t\tthis.callEvent(\"onChange\");\n\t\t}\n\t\treturn value;\n\t},\n\tgetValue: function(){\n\t\treturn  this.getPopup().getValue().join(\",\");\n\t},\n\tgetList: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[0];\n\t},\n\tgetColorView: function(){\n\t\treturn this.getPopup().getBody().getChildViews()[1].getChildViews()[0];\n\t}\n},webix.ui.richselect);","// toolbar: color selector\nwebix.protoUI({\n\t$cssName: \"colorboard\",\n\tname: \"ssheet-colorboard\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_colorboard\",\n\t\tpalette: [\n\t\t\t[\"#000000\", \"#434343\", \"#666666\", \"#999999\", \"#b7b7b7\", \"#cccccc\", \"#d9d9d9\", \"#efefef\", \"#f3f3f3\", \"#ffffff\"],\n\t\t\t[\"#980000\", \"#ff0000\", \"#ff9900\", \"#ffff00\", \"#00ff00\", \"#00ffff\", \"#4a86e8\", \"#0000ff\", \"#9900ff\", \"#ff00ff\"],\n\t\t\t[\"#e6b8af\", \"#f4cccc\", \"#fce5cd\", \"#fff2cc\", \"#d9ead3\", \"#d0e0e3\", \"#c9daf8\", \"#cfe2f3\", \"#d9d2e9\", \"#ead1dc\"],\n\t\t\t[\"#dd7e6b\", \"#ea9999\", \"#f9cb9c\", \"#ffe599\", \"#b6d7a8\", \"#a2c4c9\", \"#a4c2f4\", \"#9fc5e8\", \"#b4a7d6\", \"#d5a6bd\"],\n\t\t\t[\"#cc4125\", \"#e06666\", \"#f6b26b\", \"#ffd966\", \"#93c47d\", \"#76a5af\", \"#6d9eeb\", \"#6fa8dc\", \"#8e7cc3\", \"#c27ba0\"],\n\t\t\t[\"#a61c00\", \"#cc0000\", \"#e69138\", \"#f1c232\", \"#6aa84f\", \"#45818e\", \"#3c78d8\", \"#3d85c6\", \"#674ea7\", \"#a64d79\"],\n\t\t\t[\"#85200c\", \"#990000\", \"#b45f06\", \"#bf9000\", \"#38761d\", \"#134f5c\", \"#1155cc\", \"#0b5394\", \"#351c75\", \"#741b47\"],\n\t\t\t[\"#5b0f00\", \"#660000\", \"#783f04\", \"#7f6000\", \"#274e13\", \"#0c343d\", \"#1c4587\", \"#073763\", \"#20124d\", \"#4c1130\"]\n\t\t]\n\t}\n},webix.ui.colorboard);\n\nwebix.protoUI({\n\t$cssName: \"richselect\",\n\tname: \"ssheet-color\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_color\",\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_color\";\n\t},\n\t$renderInput: function(config, divStart, id){\n\t\tvar color  = this.renderColor.call(this);\n\t\tdivStart = divStart.replace(/([^>]>)(.*)(<\\/div)/, function(match, p1, p2, p3){\n\t\t\treturn p1+config.title +color+p3;\n\t\t});\n\n\t\treturn webix.ui.colorpicker.prototype.$renderInput.call(this,config, divStart, id);\n\t},\n\t$setValue: function(value){\n\t\tvar popup =  webix.$$(this.config.popup.toString());\n\t\tvar colorboard = popup.getBody();\n\t\tif(value){\n\t\t\tcolorboard.setValue(value);\n\t\t\tthis.config.value = value;\n\t\t\tthis.getColorNode().style.backgroundColor = value;\n\t\t}\n\n\t},\n\trenderColor: function(){\n\t\treturn \"<div class='webix_ssheet_cp_color' style='background-color:\"+this.config.value+\";'> </div>\";\n\t},\n\tgetColorNode: function(){\n\t\treturn this.$view.firstChild.firstChild.childNodes[1];\n\t},\n\t$renderIcon:function(){\n\t\treturn webix.ui.text.prototype.$renderIcon.apply(this,arguments);\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\t$cssName: \"window\",\n\tname: \"ssheet-dialog\",\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_dialog\";\n\t\tthis.config.buttons = config.buttons;\n\t},\n\tgetHeaderConfig: function(label){\n\t\treturn {\n\t\t\tpaddingX: 10,\n\t\t\tpaddingY: 5,\n\t\t\theight: 60,\n\t\t\tcols: [\n\t\t\t\t{ view: \"label\", label: label},\n\t\t\t\t{ view: \"icon\", css:\"webix_ssheet_hide_icon\", icon:\"webix_ssheet_icon ssi-close\", width: 50, click: function(){\n\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\tparentView.callEvent(\"onHideClick\",[]);\n\t\t\t\t}}\n\t\t\t]\n\t\t};\n\t},\n\tgetBodyConfig: function(content){\n\t\tcontent.borderless = true;\n\t\tvar elements = this.getFormElements(content);\n\t\tvar config = {\n\t\t\tview: \"form\",\n\t\t\tcss: \"webix_ssheet_form\",\n\t\t\tpaddingY: 0,\n\t\t\telements: elements\n\t\t};\n\t\treturn config;\n\t},\n\tgetFormElements: function(content){\n\t\tvar elements;\n\t\tif(webix.isArray(content))\n\t\t\telements= content;\n\t\telse{\n\t\t\telements = [];\n\t\t\telements.push(content);\n\t\t}\n\t\tif(this.config.buttons){\n\t\t\telements.push({height:1});\n\t\t\telements.push( {\n\t\t\t\tmargin: 10,\n\t\t\t\tcols:[\n\t\t\t\t\t{},\n\t\t\t\t\t{view: \"button\", css: \"ssheet_cancel_button\", label: webix.i18n.spreadsheet.labels.cancel, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onCancelClick\",[]);\n\t\t\t\t\t}},\n\t\t\t\t\t{view: \"button\", label: webix.i18n.spreadsheet.labels.save, autowidth:true, click: function(){\n\t\t\t\t\t\tvar parentView = this.getTopParentView();\n\t\t\t\t\t\tparentView.callEvent(\"onSaveClick\",[]);\n\t\t\t\t\t}}\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\telements.push({height:10, borderless: true});\n\t\treturn elements;\n\t},\n\tbody_setter: function(value){\n\t\tif(typeof value == \"object\"){\n\t\t\tvalue.paddingY = value.paddingY||0;\n\t\t\tif(value.view == \"form\" && value.elements){\n\t\t\t\tvalue.elements = this.getFormElements(value.elements);\n\t\t\t\tif(!value.css)\n\t\t\t\t\tvalue.css = \"webix_ssheet_form\";\n\t\t\t}\n\t\t\telse\n\t\t\t\tvalue = this.getBodyConfig(value);\n\t\t}\n\n\t\treturn webix.ui.window.prototype.body_setter.call(this,value);\n\t},\n\thead_setter:function(value){\n\t\tif(value){\n\t\t\tvalue = this.getHeaderConfig(value);\n\t\t}\n\t\treturn webix.ui.window.prototype.head_setter.call(this,value);\n\t},\n\tdefaults:{\n\t\tpadding:0,\n\t\tmove:true,\n\t\thead: true,\n\t\tbuttons: true,\n\t\t//we need to retain focus in table area, so disabling the autofocusing feature\n\t\tautofocus:false,\n\t\twidth: 350\n\t}\n}, webix.ui.window, webix.IdSpace);\n\n\n\nwebix.protoUI({\n\t$cssName: \"datatable\",\n\tname: \"ssheet-dialog-table\",\n\t$init: function(config){\n\t\tif(!config.headerRowHeight)\n\t\t\tconfig.headerRowHeight = 34;\n\t\tthis.$view.className += \" webix_ssheet_table webix_ssheet_dialog_table\";\n\t}\n},webix.ui.datatable);","webix.protoUI({\n\tname: \"ssheet-form-popup\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_form\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\tname: \"ssheet-form-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_suggest\";\n\t}\n}, webix.ui.suggest);\n\nwebix.protoUI({\n\t$cssName: \"colorpicker\",\n\tname: \"ssheet-colorpicker\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_colorpicker\";\n\t},\n\tdefaults:{\n\t\ticon: \"wxi-menu-down\",\n\t\tsuggest:{\n\t\t\tborderless: true,\n\t\t\tbody:{\n\t\t\t\tview: \"ssheet-colorboard\",\n\t\t\t\theight: 202,\n\t\t\t\ton:{\n\t\t\t\t\tonSelect: function(value){\n\t\t\t\t\t\tthis.getParentView().setMasterValue({ value:value });\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n},webix.ui.colorpicker);","webix.protoUI({\n\tname:\"formlate\",\n\tsetValue:function(a){ return this.setHTML(a); },\n\tgetValue:function(){ return \"\"; }\n}, webix.ui.template);","webix.protoUI({\n\tname:\"ssheet-icons\",\n\t$cssName: \"dataview\",\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_dataview\";\n\t},\n\tdefaults:{\n\t\tborderless: true,\n\t\ttemplate: \"<span class='webix_ssheet_button_icon #css#' ></span>\",\n\t\ttype:{\n\t\t\twidth: 36,\n\t\t\theight: 36\n\t\t}\n\t}\n},webix.ui.dataview);","webix.protoUI({\n\tname: \"ssheet-suggest\",\n\tdefaults:{\n\t\tpadding:0,\n\t\tcss: \"webix_ssheet_suggest\"\n\t}\n},webix.ui.contextmenu);","webix.protoUI({\n\tname: \"suggest-formula\",\n\tdefaults: {\n\t\tfitMaster: false,\n\t\twidth: 200,\n\t\tfilter(item, value) {\n\t\t\tconst editor = webix.$$(this.config.editor);\n\t\t\tconst cursor = editor.getCursor();\n\t\t\tconst val = editor.getValue();\n\n\t\t\tif(val.charAt(0) !== \"=\") return;\n\n\t\t\tlet str1 = val.substring(0, cursor).match(/([a-zA-Z]+)$/);\n\t\t\tlet str2 = val.charAt(cursor).search(/[^A-Za-z0-9]/);\n\n\t\t\tif(str1 && (cursor === val.length || str2 === 0))\n\t\t\t\tvalue = str1[0];\n\n\t\t\treturn item.value.toString().toLowerCase().indexOf(value.toLowerCase()) === 0;\n\t\t}\n\t},\n\t$init() {\n\t\tthis.attachEvent(\"onBeforeShow\", (node) => {\n\t\t\tif(node.tagName){\n\t\t\t\tconst editor = webix.$$(this.config.editor);\n\t\t\t\tconst text = editor.getValue();\n\n\t\t\t\t//only for formulas\n\t\t\t\tif(!text || text.charAt(0) !== \"=\") return false;\n\n\t\t\t\tconst sizes = webix.html.offset(node);\n\n\t\t\t\tconst textWidth = webix.html.getTextSize(text, \"webix_ssheet_formula_input\").width;\n\t\t\t\tconst selectionStart = editor.getCursor();\n\n\t\t\t\tconst y = sizes.y + sizes.height;\n\t\t\t\tconst x = sizes.x + (selectionStart * textWidth/text.length);\n\n\t\t\t\twebix.ui.popup.prototype.show.apply(this, [{x, y}]);\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t},\n\tsetMasterValue(data, refresh) {\n\t\tconst text = data.id ? this.getItemText(data.id) : (data.text||data.value);\n\t\twebix.$$(this.config.editor).setValueHere(text);\n\n\t\tif (!refresh)\n\t\t\tthis.hide(true);\n\n\t\tthis.callEvent(\"onValueSuggest\", [data, text]);\n\t},\n\t$enterKey: function() {\n\t\tif (this.isVisible())\n\t\t\treturn webix.ui.suggest.prototype.$enterKey.apply(this, arguments);\n\t}\n}, webix.ui.suggest);","webix.protoUI({\n\tname: \"ssheet-button\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 40\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" webix_ssheet_button\"+(config.arrow?\" webix_ssheet_button_menu\":\"\");\n\t\tif(config.label || config.icon){\n\t\t\tlet icon = (config.icon||config.name),\n\t\t\t\ttext = config.label||\"\";\n\t\t\tif(config.arrow)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+icon+\"'></span> \"+text;\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nwebix.protoUI({\n\tname: \"ssheet-button-icon-top\",\n\t$cssName: \"button\",\n\tdefaults:{\n\t\ttype:\"htmlbutton\",\n\t\twidth: 70,\n\t\theight: 70\n\t},\n\t$init: function(config){\n\t\tthis.$view.className += \" ssheet_button_icon_top\";\n\t\tif(config.label) {\n\t\t\tlet icon = (config.icon || config.name||\"\"),\n\t\t\t\ttext = config.label;\n\t\t\tconfig.label = \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + icon + \"'></span><br/>\";\n\t\t\tconfig.label += \"<span class='ssheet_button_icon_top_text'>\"+text+\"</span>\";\n\t\t\tif (config.arrow)\n\t\t\t\tconfig.label += \"<br/><span class='ssheet_button_icon_top_arrow webix_icon wxi-menu-down'></span>\";\n\t\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\t}\n\t\tif(config.options && !config.popup)\n\t\t\tconfig.popup = getPopupConfig(config.options);\n\t}\n},webix.ui.button);\n\n\nfunction getPopupConfig(options){\n\treturn {\n\t\tview: \"ssheet-suggest\",\n\t\tcss: \"webix_ssheet_suggest\",\n\t\tautowidth:true,\n\t\ttemplate: function(obj){\n\t\t\tvar text = \"\";\n\t\t\tif(obj.icon)\n\t\t\t\ttext += \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\" + obj.icon + \"'></span> \";\n\t\t\ttext += obj.value || webix.i18n.spreadsheet.menus[obj.id] || obj.id;\n\t\t\treturn text;\n\t\t},\n\t\tdata: options,\n\t\ton:{\n\t\t\tonItemClick: function(id){\n\t\t\t\tvar button = this.config.master;\n\t\t\t\tif(button){\n\t\t\t\t\tlet view = webix.$$(button).getTopParentView();\n\t\t\t\t\tvar params = [this.getItem(id)];\n\t\t\t\t\tif(webix.$$(button).config.area){\n\t\t\t\t\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\t\t\t\t\tif(area)\n\t\t\t\t\t\t\tparams = params.concat([area.start,area.end]);\n\t\t\t\t\t}\n\t\t\t\t\tview.callEvent(\"onCommand\",params);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n}","import \"./suggest_formula\";\nimport {split, position} from \"../math/parser\";\n\nwebix.protoUI({\n\tname: \"live-editor\",\n\tdefaults:{\n\t\ttemplate: \"<div class='webix_ssheet_formula_input' contenteditable='true'></div>\"\n\t},\n\t$init(config){\n\t\tthis._highlightedCells = [];\n\t\tthis.$view.className += \" webix_ssheet_formula\";\n\n\t\tthis.attachEvent(\"onKeyPress\", (code, e) => {\n\t\t\tdelete this._update_range;\n\t\t\tif(code === 13) {\n\t\t\t\t//ignore Enter key if it was pressed to select some value from suggest\n\t\t\t\tif ((new Date() - (this._last_value_set || 0)) > 300){\n\t\t\t\t\tthis.showActiveSheet();\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t\t//we have 'enter' hot key to activate editor\n\t\t\t\t\twebix.delay(()=>{\n\t\t\t\t\t\tthis.getTopParentView()._table.moveSelection(\"down\");\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t});\n\n\t\tthis.attachEvent(\"onAfterRender\", function(){\n\t\t\tvar node = this.getInputNode();\n\t\t\tvar ev =  webix.env.isIE8?\"propertychange\":\"input\";\n\n\t\t\twebix.eventRemove(this.inputEv);\n\t\t\twebix.eventRemove(this.keydownEv);\n\n\t\t\tthis.inputEv = webix.event(node, ev, () => {\n\t\t\t\tthis._cursor = this.getCursor();\n\t\t\t\t//we can start typing on colored span, so we should update input highlight\n\t\t\t\tthis.highlightCells(this.getValue());\n\t\t\t\tthis.setCursor(this._cursor);\n\t\t\t});\n\t\t\tthis.keydownEv = webix.event(node, \"keydown\", e => {\n\t\t\t\tthis.endEdit(e);\n\t\t\t});\n\n\t\t\twebix.ui({\n\t\t\t\tview: \"suggest-formula\",\n\t\t\t\tinput: this.getInputNode(),\n\t\t\t\teditor:this,\n\t\t\t\tdata: config.suggestData\n\t\t\t});\n\t\t});\n\t},\n\tshowActiveSheet(){\n\t\tconst master = this.getTopParentView();\n\t\tdelete master.$handleSelection;\n\n\t\tif(this._activeMath){\n\t\t\tif(this._activeMath != master.getActiveSheet()){\n\t\t\t\tconst val = this.getValue();\n\n\t\t\t\tconst cell = this.config.activeCell;\n\t\t\t\tthis.define({activeCell:null});\n\n\t\t\t\tmaster.showSheet(this._activeMath);\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tmaster._table.select(cell.row, cell.column);\n\t\t\t\t\tthis.setValue(val);\n\t\t\t\t\tthis.updateCellValue();\n\t\t\t\t});\n\t\t\t}\n\t\t\tdelete this._activeMath;\n\t\t}\n\t},\n\tgetInputNode(){\n\t\treturn this.$view.firstChild.firstChild;\n\t},\n\tgetValue(){\n\t\treturn this.getInputNode().innerText;\n\t},\n\tsetValue(value){\n\t\tthis.highlightCells(value);\n\t},\n\thighlightCells(value){\n\t\tlet html = \"\";\n\t\tconst master = this.getTopParentView();\n\n\t\tthis._highlightedCells.forEach((cell)=>{\n\t\t\tmaster.$$(\"cells\").removeCellCss(cell[0], cell[1], cell[2],  true);\n\t\t});\n\t\tthis._highlightedCells = [];\n\n\t\t//value can be null\n\t\tif(value && value[0]==\"=\"){\n\t\t\tconst ranges = master.ranges._ranges;\n\t\t\tconst parts = split(value, true, ranges);\n\t\t\tconst sheet = master.getActiveSheet();\n\n\t\t\tlet colorIndex = 1;\n\n\t\t\tfor(let i = 0; i < parts.length; i++){\n\t\t\t\tif((i+1)%2 != 0)\n\t\t\t\t\thtml += parts[i];\n\t\t\t\telse{\n\t\t\t\t\tconst crossheet = webix.isArray(parts[i]);\n\t\t\t\t\tconst activeMath = this._activeMath;\n\n\t\t\t\t\tconst activeSheet = !crossheet && (!activeMath || activeMath == sheet);\n\t\t\t\t\tlet cell = position(crossheet ? parts[i][1] : parts[i]);\n\t\t\t\t\tconst cellText = crossheet ? parts[i].join(\"!\") : parts[i];\n\n\t\t\t\t\tconst rangeName = /^[A-Za-z]+$/.test(parts[i]);\n\t\t\t\t\tif(activeSheet || (crossheet && parts[i][0] == sheet)){\n\t\t\t\t\t\t//range\n\t\t\t\t\t\tif((parts[i+1] == \":\" && parts[i+2]) || rangeName){\n\t\t\t\t\t\t\tlet nextCell, nextCellText;\n\n\t\t\t\t\t\t\tif(rangeName){\n\t\t\t\t\t\t\t\tconst cells = ranges[parts[i]].split(\":\");\n\t\t\t\t\t\t\t\tcell = position(cells[0]);\n\t\t\t\t\t\t\t\tnextCell = position(cells[1]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\tnextCell = position(crossheet ? parts[i+2][1] : parts[i+2]);\n\t\t\t\t\t\t\t\tnextCellText = crossheet ? parts[i+2].join(\"!\") : parts[i+2];\n\t\t\t\t\t\t\t\ti+=2;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${colorIndex}\">${rangeName ? parts[i] : cellText+\":\"+nextCellText}</span>`;\n\n\t\t\t\t\t\t\tfor (let row = Math.min(cell[0], nextCell[0]); row <= Math.max(cell[0], nextCell[0]); row++)\n\t\t\t\t\t\t\t\tfor (let col = Math.min(cell[1], nextCell[1]); col <=  Math.max(cell[1], nextCell[1]); col++)\n\t\t\t\t\t\t\t\t\tthis.addCellCss(row, col, colorIndex);\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//cell\n\t\t\t\t\t\telse{\n\t\t\t\t\t\t\thtml += `<span class=\"webix_ssheet_highlight_color_${colorIndex}\">${cellText}</span>`;\n\t\t\t\t\t\t\tthis.addCellCss(cell[0], cell[1], colorIndex);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst colors = 7;\n\t\t\t\t\t\tcolorIndex += colorIndex == colors ? -1*(colors-1) : 1;\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t\thtml +=  webix.isArray(parts[i]) ? parts[i].join(\"!\") : parts[i];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\thtml = value;\n\n\t\tthis.getInputNode().innerHTML = html;\n\t\tmaster.$$(\"cells\").refresh();\n\n\t\tconst cursor = this.getDocumentCursor();\n\n\t\tif(webix.isUndefined(cursor))\n\t\t\treturn;\n\n\t\tconst cursorNode = cursor.startContainer;\n\t\tif(this.getInputNode().contains(cursorNode))\n\t\t\tthis.paintValue();\n\t},\n\taddCellCss(row, col, index){\n\t\tconst css = `webix_ssheet_highlight_background_${index}`;\n\t\tthis.getTopParentView().$$(\"cells\").addCellCss(row, col, css, true);\n\t\tthis._highlightedCells.push([row, col, css]);\n\t},\n\tgetDocumentCursor(){\n\t\tconst sel = document.getSelection();\n\t\tif(sel.rangeCount)\n\t\t\treturn sel.getRangeAt(0);\n\t},\n\tfocus(){\n\t\tconst cursor = this.getDocumentCursor();\n\n\t\tif(!webix.isUndefined(cursor) && this.getInputNode().contains(cursor.startContainer)){\n\t\t\tconst pos = this.getCursor();\n\t\t\tthis.setCursor(pos);\n\t\t}\n\t\telse{\n\t\t\tconst length = this.getValue().length;\n\t\t\tif(length)\n\t\t\t\tthis.setCursor(length);\n\t\t\telse\n\t\t\t\tthis.getInputNode().focus();\n\t\t}\n\t},\n\tendEdit(e){\n\t\twebix.UIManager.setFocus(this);\n\t\tlet code = e.which || e.keyCode;\n\n\t\t//if it is a formula - force user to finish it by click outside or 'enter'\n\t\tif(code == 9 || (code>36 && code<41 && this.getValue().charAt(0)!==\"=\")){\n\t\t\tlet dir = (code == 40)?\"down\":(code === 39?\"right\":(code ==37?\"left\":\"up\"));\n\t\t\tif (code === 9)\n\t\t\t\tdir = \"right\";\n\n\t\t\tthis.updateCellValue();\n\t\t\tthis.getTopParentView()._table.moveSelection(dir);\n\t\t}\n\t},\n\tpaintValue(){\n\t\tlet master = this.getTopParentView();\n\t\tif(!this._activeMath || this._activeMath == master.getActiveSheet()){\n\t\t\tlet cell = this.config.activeCell;\n\t\t\tlet node = master._table.getItemNode(cell);\n\t\t\tif(cell && node) \n\t\t\t\tnode.innerHTML = this.getValue();\n\t\t}\n\t},\n\tupdateCellValue() {\n\t\tlet newv = this.getValue();\n\t\tlet master = this.getTopParentView();\n\t\tlet cell = this.config.activeCell;\n\n\t\tif (!cell)\n\t\t\tthis.setValue(\"\");\n\t\telse if (newv != master.getCellValue(cell.row, cell.column)){\n\t\t\tthis.config.value = newv;\n\t\t\tmaster.setCellValue(cell.row, cell.column, newv);\n\t\t\tmaster.refresh();\n\t\t}\n\t},\n\t$setValueHere(value){\n\t\tthis.setValueHere(value);\n\t},\n\tsetValueHere(value) {\n\t\tthis._last_value_set = new Date();\n\n\t\tconst formula = this.getValue();\n\t\tif(formula && formula.charAt(0)===\"=\"){\n\t\t\tconst cursor = this._cursor;\n\t\t\tlet str1 = formula.substring(0, cursor);\n\t\t\tlet str2 = formula.substring(cursor);\n\t\t\tconst updatedStr = str1.replace(/([a-zA-Z(]+)$/, value);\n\n\t\t\t//suggest called via up/down key\n\t\t\tstr1 = updatedStr == str1 ? str1 + value : updatedStr;\n\n\t\t\tthis.setValue(str1 + \"(\" + str2);\n\t\t\tthis.setCursor(str1.length + 1);\n\t\t}\n\t},\n\texpectRange(){\n\t\tlet text = this.getValue().trim();\n\t\tlet last = text.substr(text.length-1,1);\n\t\treturn last.match(/[(,]/);\n\t},\n\texpectOperator(){\n\t\tlet text = this.getValue();\n\t\treturn text[0] == \"=\" && text[this._cursor-1] && text[this._cursor-1].match(/[+&\\-/*%=(:,]/);\n\t},\n\tsetRange(range, replace){\n\t\tconst cursor = this._cursor;\n\t\tconst formula = this.getValue();\n\n\t\tlet str1, str2;\n\n\t\t//check if range was added by click\n\t\tif(replace)\n\t\t\treplace = this._update_range && cursor == this._update_range.pos + this._update_range.len;\n\n\t\tconst lastPos = replace ? this._update_range.pos : cursor;\n\n\t\tstr1 = formula.substring(0, lastPos) + range;\n\t\tstr2 = formula.substring(cursor);\n\n\t\tthis._update_range = {pos: lastPos, len: range.length};\n\n\t\tthis.setValue(str1 + str2);\n\t\tthis.setCursor(str1.length);\n\t},\n\tsetCursor(pos){\n\t\tthis._cursor = pos;\n\t\tlet symbolsBefore = 0;\n\t\tconst childs = this.getInputNode().childNodes;\n\n\t\tfor(let i = 0; i < childs.length; i++){\n\t\t\tconst textLength = childs[i].length||childs[i].innerText.length;\n\n\t\t\tif(pos - symbolsBefore <= textLength){\n\t\t\t\tconst range = document.createRange();\n\t\t\t\tconst sel = document.getSelection();\n\t\t\t\trange.setStart(childs[i].innerText ? childs[i].firstChild : childs[i], pos - symbolsBefore);\n\t\t\t\trange.collapse(true);\n\t\t\t\tsel.removeAllRanges();\n\t\t\t\tsel.addRange(range);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\telse\n\t\t\t\tsymbolsBefore += textLength;\n\t\t}\n\t},\n\tgetCursor(){\n\t\tconst cursor = this.getDocumentCursor();\n\t\tif(cursor){\n\t\t\tconst pos = cursor.startOffset;\n\t\t\tlet symbolsBefore = 0;\n\n\t\t\tconst childs = this.getInputNode().childNodes;\n\t\t\tfor(let i = 0; i < childs.length; i++){\n\t\t\t\tconst parent = cursor.startContainer.parentNode;\n\n\t\t\t\tif(childs[i] == (parent.tagName == \"SPAN\" ? parent : cursor.startContainer))\n\t\t\t\t\treturn symbolsBefore + pos;\n\t\t\t\tsymbolsBefore += childs[i].innerText ? childs[i].innerText.length : childs[i].length;\n\t\t\t}\n\t\t}\n\t\treturn this.getValue().length || 0;\n\t}\n}, webix.ui.template);","webix.protoUI({\n\tname: \"ssheet-separator\",\n\tdefaults:{\n\t\tcss: \"webix_ssheet_toolbar_spacer\",\n\t\ttemplate: \" \",\n\t\twidth: 1,\n\t\tborderless: true\n\t}\n},webix.ui.view);","webix.protoUI({\n\tname: \"sheets\",\n\tdefaults:{\n\t\tlayout: \"x\",\n\t\tborderless: true,\n\t\tcss:\"ssheet_list_sheets\",\n\t\tselect: true,\n\t\tdrag: \"order\",\n\t\tdragscroll:\"x\",\n\t\tscroll:false\n\t}\n},webix.EditAbility,webix.ui.list);","// toolbar: toogle button\nwebix.protoUI({\n\t$cssName: \"toggle\",\n\tname:\"ssheet-toggle\",\n\ttoggle:function(){\n\t\tvar value = this.getValue() == this.config.onValue?true:false;\n\t\tthis.setValue(!value);\n\t},\n\t$setValue:function(value){\n\t\tif(value == this.config.offValue)\n\t\t\tvalue = false;\n\t\telse if(value == this.config.onValue)\n\t\t\tvalue = true;\n\t\twebix.ui.toggle.prototype.$setValue.call(this,value);\n\t},\n\tgetValue:function(){\n\t\tvar config = this.config;\n\t\tvar value = config.value;\n\t\treturn  !value || value==config.offValue?(config.offValue||false):(config.onValue||true);\n\t},\n\tdefaults:{\n\t\ttemplate:function(obj, common){\n\t\t\tvar css = (obj.value === true ||obj.value == obj.onValue) ? \" webix_pressed\" : \"\";\n\t\t\tvar inp = common.$renderInput(obj, common);\n\t\t\treturn \"<div class='webix_el_box\"+css+\"' style='width:\"+obj.awidth+\"px; height:\"+obj.aheight+\"px'>\"+inp+\"</div>\";\n\t\t}\n\t}\n}, webix.ui.toggle);","webix.protoUI({\n\tname: \"ssheet-bar-title\",\n\tdefaults:{\n\t\tborderless: true\n\t},\n\t$init: function(){\n\t\tthis.$view.className += \" webix_ssheet_subbar_title\";\n\t}\n},webix.ui.template);","webix.protoUI({\n\tname:\"multicheckbox\",\n\tdefaults:{\n\t\tpadding:0,\n\t\ttype:\"clean\",\n\t\tborderless:true,\n\t\telementsConfig:{\n\t\t\tlabelWidth:10\n\t\t}\n\t},\n\t$init:function(config){\n\t\tconfig.rows = [{height:0.000001}];\n\t\tthis.$ready.push(function(){\n\t\t\tthis._initOnChange();\n\t\t\tthis.setValue(config.value);\n\t\t});\n\t},\n\t_initOnChange(){\n\t\tthis.attachEvent(\"onChange\", function(newv){\n\t\t\tthis.blockEvent();\n\t\t\tif(this.$eventSource.config.name ===\"$all\"){\n\t\t\t\tfor(var i in this.elements)\n\t\t\t\t\tthis.elements[i].setValue(newv);\n\t\t\t\tthis.getChildViews()[0].getBody().getChildViews()[0].setValue(1);\n\t\t\t}\n\t\t\telse{\n\t\t\t\tvar count = this.getValue().length;\n\t\t\t\tif(count === this._count)\n\t\t\t\t\tthis.elements.$all.setValue(1);\n\t\t\t\tif(count < this._count)\n\t\t\t\t\tthis.elements.$all.setValue(0);\n\t\t\t\tif(count ===0)\n\t\t\t\t\tthis.elements[this._findNext(this.$eventSource.config.name)].setValue(1);\n\t\t\t}\t\n\t\t\tthis.unblockEvent();\n\t\t});\n\t},\n\t_findNext:function(name){\n\t\tfor(var i in this.elements)\n\t\t\tif(i !==name && i !==\"$all\")\n\t\t\t\treturn i;\n\t},\n\tsetValue:function(value){\n\t\tvar keys = [];\n\t\tfor(let i in value) keys.push(i);\n\n\t\tvalue = value || {};\n\t\tthis.elements = {};\n\t\tthis._count = keys.length;\n\n\t\tif(typeof value !==\"object\" || !keys.length){\n\t\t\tif(this.getChildViews().length >1)\n\t\t\t\twebix.ui([{height:0.000001}], this);\n\t\t}\n\t\telse{\n\t\t\tvar elements = [], base = [], maxHeight = 400;\n\t\t\tfor(let i in value) \n\t\t\t\tbase.push({ view:\"checkbox\", labelRight:i, name:i});\n\t\t\tvar baseHeight = base.length*webix.skin.$active.inputHeight;\n\n\t\t\telements.push({\n\t\t\t\tview:\"scrollview\", body:{rows:base},\n\t\t\t\tscroll:baseHeight>maxHeight,\n\t\t\t\theight:(baseHeight>maxHeight?maxHeight:baseHeight)\n\t\t\t});\n\n\t\t\telements.push({ template:\"<div class='ss_sep_line'></div>\", height:10});\n\t\t\telements.push({ view:\"checkbox\", labelRight:webix.i18n.spreadsheet.labels[\"export-all-sheets\"], name:\"$all\"});\n\n\t\t\twebix.ui(elements, this);\n\t\t\tfor(let i in value)\n\t\t\t\tif(value[i]) this.elements[i].setValue(value[i]);\n\t\t}\n\t},\n\tgetValue:function(){\n\t\tvar value = this.getValues(), output = [];\n\t\tfor(var i in value)\n\t\t\tif(value[i] && i !==\"$all\") output.push(i);\n\t\treturn output;\n\t}\n}, webix.ui.form);","webix.protoUI({\n\tname:\"formlist\",\n\tdefaults:{\n\t\tpaddingY: 5,\n\t\theight: 120,\n\t},\n\t$init:function(config){\n\n\t\tconfig.cols = [\n\t\t\t{\n\t\t\t\tcss:\"webix_inp_label\",\n\t\t\t\ttemplate:config.label,\n\t\t\t\twidth:config.labelWidth,\n\t\t\t\tborderless:true\n\t\t\t},\n\t\t\t{\n\t\t\t\tview:\"list\",\n\t\t\t\tdata:config.data,\n\t\t\t\tcss:config.css,\n\t\t\t\ttemplate:config.template,\n\t\t\t\tselect: true,\n\t\t\t\tscroll:false,\n\t\t\t\tborderless:true,\n\t\t\t\ton:{\n\t\t\t\t\tonSelectChange:()=>{\n\t\t\t\t\t\tthis.getParentView().callEvent(\"onChange\", []);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t];\n\t},\n\tsetValue:function(value){this.getChildViews()[1].select(value);},\n\tgetValue:function(){return this.getChildViews()[1].getSelectedId();},\n\trefresh: function(){this.getChildViews()[1].refresh();},\n\tfocus:function(){}\n}, webix.ui.layout);","const group = {\n\tvalue: null,\n\tset: function(method, master){\n\t\tif(!this.value){\n\t\t\tthis.start();\n\t\t\tmethod.call(master);\n\t\t\tthis.end();\n\t\t}\n\t\telse\n\t\t\tmethod.call(master);\n\t},\n\tstart(){\n\t\tthis.value = webix.uid();\n\t},\n\tend(){\n\t\tthis.value = null;\n\t}\n};\n\nexport default group;","export function init(view){\n\tconst events = [\n\t\t{name:\"onSheetAdd\", type:\"insert\"},\n\t\t{name:\"onSheetRemove\", type:\"remove\"},\n\t\t{name:\"onSheetRename\", type:\"rename\"},\n\t\t{name:\"onCellChange\"},\n\t\t{name:\"onStyleChange\"},\n\t\t{name:\"onAction\"},\n\t\t{name:\"onRowOperation\"},\n\t\t{name:\"onColumnOperation\"},\n\t\t{name:\"onAfterConditionSet\"},\n\t\t{name:\"onAfterRangeSet\"},\n\t\t{name:\"onAfterSpan\"},\n\t\t{name:\"onAfterSplit\"},\n\t\t{name:\"onRowResize\", view: \"cells\"},\n\t\t{name:\"onColumnResize\", view: \"cells\"}\n\t];\n\n\tlet thread;\n\tfor (let i = 0; i < events.length; i++){\n\t\tconst handler = events[i];\n\t\t(handler.view ? view.$$(handler.view) : view).attachEvent(handler.name, function(name, newName){\n\t\t\tif (view._loading_data) return;\n\n\t\t\tlet params;\n\t\t\tif(handler.type)\n\t\t\t\tparams = handler.type == \"rename\" ? [handler.type, newName, name] : [handler.type, name];\n\t\t\telse\n\t\t\t\tparams = [\"update\", view.getActiveSheet()];\n\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(() => view.callEvent(\"onChange\", params));\n\t\t});\n\t}\n\n\tview.attachEvent(\"onChange\", function(){\n\t\tsave(view, \"all\");\n\t});\n}\n\nexport function save(view, name, data){\n\tvar save = view.config.save;\n\tvar url;\n\tif (!save) return;\n\n\tif(name == \"all\"){\n\t\tif(!save.all)\n\t\t\treturn;\n\t\tdata = { data: view.serialize({ sheets: true }) };\n\t\turl = save.all;\n\t}\n\telse{\n\t\turl = typeof save === \"string\" ? save + \"/\" + name : save[name];\n\t}\n\n\turl = webix.proxy.$parse(url);\n\n\tif(url){\n\t\tif (typeof url === \"function\")\n\t\t\treturn url(name, data);\n\n\t\tif (url.$proxy && url.save)\n\t\t\treturn url.save(view, data, null, null);\n\n\t\tvar ajax = webix.ajax();\n\t\tif (name === \"all\")\n\t\t\tajax.headers({ \"Content-type\" : \"application/json\" });\n\t\tajax.post(url, data);\n\t}\n}","export const decode = {};\nexport const encode = {};\n\nconst alpha = \"ABCDEFGHIJKLMNOPQRSTUVWXYZ\";\nfor (var i=1; i<1000; i++){\n\tvar prefixIndex = parseInt((i-1)/alpha.length);\n\tvar str = (prefixIndex?alpha[prefixIndex-1]:\"\")+alpha[(i-1)%(alpha.length)];\n\n\tdecode[str] = i;\n\tencode[i] = str;\n}\n\nencode[0]=encode[1];\n\n\nexport function adress(text){\n\tvar size = (text.charCodeAt(1) < 59) ? 1 : 2;\n\tvar col = text.substr(0, size);\n\tvar row = text.substr(size);\n\n\treturn [row*1, decode[col]];\n}\n\nexport function range(text, view){\n\tvar nind = text.indexOf(\"!\");\n\tvar sheet = \"\";\n\n\t//parse sheet names\n\tif (nind !== -1){\n\t\tsheet = text.substr(0, nind);\n\t\tif (sheet[0] === \"'\")\n\t\t\tsheet = sheet.substr(1, sheet.length-2);\n\t\ttext = text.substr(nind+1);\n\t}\n\n\tvar parts = text.split(\":\");\n\tif (parts.length != 2 && view){\n\t\ttext = view.ranges.getCode(text, sheet);\n\t\tif (!text) return null;\n\t\tparts = text.split(\":\");\n\t} \n\n\tvar d1 = adress(parts[0]);\n\tvar d2 = adress(parts[1]);\n\treturn [d1[0], d1[1], d2[0], d2[1], sheet];\n}\n\n\nvar notAlphaNum = /[^A-Za-z0-9]/;\nfunction escapeSheet(text){\n\tif (notAlphaNum.test(text))\n\t\treturn `'${text}'`;\n\treturn text;\n}\n\nexport function toRange(x,y,x2,y2,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+encode[y]+x+\":\"+encode[y2]+x2;\n}\nexport function toSheetRange(x,y,sheet){\n\treturn (sheet?(escapeSheet(sheet)+\"!\"):\"\")+x+\":\"+y;\n}\n\nexport function rangeObj(text, view){\n\tif (typeof text === \"object\") return text;\n\tlet a = range(text, view);\n\treturn { start:{ row:a[0], column:a[1]}, end:{ row:a[2], column:a[3] }, sheet: a[4] };\n}\n\nexport function eachRange(text, view, callback, data){\n\tvar range = rangeObj(text);\n\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\tfor (let column = range.start.column; column <=  range.end.column; column++) {\n\t\t\tcallback(view, {row: row, column: column}, data);\n\t\t}\n\t}\n}\n\nvar rangeTest = /(([A-Za-z0-9]+|'[^']+')!|)[A-Z]+[0-9]+:[A-Z]+[0-9]+/;\nexport function isRange(text){\n\treturn rangeTest.test(text);\n}\n\nexport function changeRange(text,name,inc,start){\n\tlet updated = false;\n\n\tif(isRange(text)){\n\t\tlet [r1,c1,r2,c2,sheet] = range(text);\n\t\tif (name === \"row\" && start.row <= r2){\n\t\t\tif(start.row <= r1)\n\t\t\t\tr1 += inc;\n\t\t\tr2 += inc;\n\t\t\tupdated = true;\n\t\t}\n\t\telse if (name === \"column\" && start.column <= c2){\n\t\t\tif(start.column <= c1)\n\t\t\t\tc1 += inc;\n\t\t\tc2 += inc;\n\t\t\tupdated = true;\n\t\t}\n\t\tif(updated)\n\t\t\ttext = toRange(r1,c1,r2,c2,sheet);\n\t}\n\n\treturn text;\n}","export const toolbarSizes = {\n\twidth:38,\n\tmargin: 7,\n\tpaddingY: 1,\n\tsectorPadding: 5,\n\tsectorMargin: 0\n};\n\n// default styles for toolbar elements\nexport const defaultStyles = {\n\t\"color\"         : \"#666666\",\n\t\"background\"    : \"#ffffff\",\n\t\"font-family\"   : \"'PT Sans', Tahoma\",\n\t\"font-size\" : \"15px\",\n\t\"text-align\": \"left\",\n\t\"vertical-align\": \"top\",\n\t\"white-space\": \"nowrap\",\n\t\"format\": \"common\"\n};\n\nexport function setSkinDefaults(){\n\tconst material = webix.skin.$name == \"material\" || webix.skin.$name == \"mini\";\n\ttoolbarSizes.width = webix.skin.$active.inputHeight+2;\n\ttoolbarSizes.titleHeight = webix.skin.$name == \"mini\" ? 18 : 20;\n\n\tdefaultStyles[\"font-family\"] = material ? \"'Roboto', sans-serif\" : \"'PT Sans', Tahoma\";\n}","import group from \"./undo_group\";\nimport {save} from \"./save\";\nimport {eachRange} from \"../helpers/column_names\";\nimport {defaultStyles} from \"../toolbar/defaults\";\n\n//do not change order, it will break server side compatibility\n//add new options to the end of this list\nexport const style_names = [\n\t\"color\",\"background\",\"text-align\",\n\t\"font-family\",\"font-size\",\n\t\"font-style\",\"text-decoration\",\"font-weight\",\n\t\"vertical-align\", \"wrap\", \"borders\", \"format\",\n\t\"border-right\", \"border-bottom\",\"border-left\", \"border-top\"\n];\n\nconst _style_map = {\n\t\"vertical-align\": {\n\t\t\"top\": function(){\n\t\t\treturn \"display: block;\";\n\t\t},\n\t\t\"middle\": function(obj){\n\t\t\tvar align = \"flex-start\";\n\t\t\tif(obj[\"text-align\"] == \"center\")\n\t\t\t\talign = \"center\";\n\t\t\telse if(obj[\"text-align\"] == \"right\")\n\t\t\t\talign = \"flex-end\";\n\t\t\tvar result = \"display: flex; align-items: center;justify-content:\"+align+\";\";\n\t\t\treturn result;\n\t\t},\n\t\t\"bottom\": function(obj){\n\t\t\tvar align = \"flex-start\";\n\t\t\tif(obj[\"text-align\"] == \"center\")\n\t\t\t\talign = \"center\";\n\t\t\telse if(obj[\"text-align\"] == \"right\")\n\t\t\t\talign = \"flex-end\";\n\t\t\tvar result = \"display: flex; align-items:flex-end;justify-content:\"+align+\";\";\n\t\t\treturn result;\n\t\t}\n\t},\n\t\"wrap\": {\n\t\t\"wrap\": function(){\n\t\t\tvar padding = 7 - (34-webix.skin.$active.rowHeight);\n\t\t\treturn \"white-space: normal !important; line-height:normal !important; padding-top:\"+padding+\"px;padding-bottom:\"+padding+\"px;\";\n\t\t},\n\t\t\"nowrap\": function(){\n\t\t\treturn \"\";\n\t\t}\n\t},\n\t\"format\":\"\",\n\t\"borders\": \"\",\n\t\"border-left\":function(obj){\n\t\tif(obj[\"border-left\"])\n\t\t\treturn \"border-left: 1px solid \"+obj[\"border-left\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-top\":function(obj){\n\t\tif(obj[\"border-top\"])\n\t\t\treturn \"border-top: 1px solid \"+obj[\"border-top\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-right\":function(obj){\n\t\tif(obj[\"border-right\"])\n\t\t\treturn \"border-right: 1px solid \"+obj[\"border-right\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"border-bottom\": function(obj){\n\t\tif(obj[\"border-bottom\"])\n\t\t\treturn \"border-bottom: 1px solid \"+obj[\"border-bottom\"]+ \" !important;\";\n\t\treturn \"\";\n\t},\n\t\"font-weight\": function(obj){\n\t\t//Roboto bold - font-weight:500 (looks better, than 700). Roboto is default font for material skins.\n\t\tif(obj[\"font-weight\"] == \"bold\"){\n\t\t\tconst family = obj[\"font-family\"] || defaultStyles[\"font-family\"];\n\t\t\treturn \"font-weight:\" + (family == \"'Roboto', sans-serif\" ? 500 : 700) + \";\";\n\t\t}\n\t}\n};\n\n\nconst border_checks = {\n\t\"border-left\":\t\tfunction(cell, area, mode){ return cell.column == area.start.column || mode ==\"no\"; },\n\t\"border-right\":\t\tfunction(cell, area, mode){ return cell.column == area.end.column || mode == \"all\" || mode ==\"no\"; },\n\t\"border-top\":\t\tfunction(cell, area , mode){ return cell.row == area.start.row || mode ==\"no\"; },\n\t\"border-bottom\":\tfunction(cell, area, mode){ return cell.row == area.end.row || mode == \"all\"|| mode ==\"no\"; }\n};\n\nconst _style_handlers = {\n\t\"borders\": function(view, style, value, cell){\n\t\tvar area = view.$$(\"cells\").getSelectArea();\n\t\tvalue = value.split(\",\");\n\t\tvar type = value[0];\n\t\tvar color = value[1];\n\n\t\tvar modes = [\"border-left\", \"border-right\", \"border-bottom\", \"border-top\"];\n\n\t\tif(type == \"no\")\n\t\t\tcolor = \"\";\n\t\telse if(type == \"top-bottom\"){\n\t\t\tmodes = [\"border-top\",\"border-bottom\"];\n\t\t}\n\t\telse if (type != \"all\" && type != \"outer\")\n\t\t\tmodes = [\"border-\"+type];\n\t\t\n\t\tfor (var i = 0; i < modes.length; i++){\n\t\t\tvar mode = modes[i];\n\t\t\tlet result = view.callEvent(\"onAction\", [\"check-borders\", {row:cell.row, column:cell.column, area, type, mode}]);\n\t\t\tif (result === true || border_checks[mode](cell, area, type))\n\t\t\t\tstyle = _updateStyle(view, style, mode, color, cell);\n\t\t}\n\t\treturn style;\n\t}\n};\n\nvar sizeEl;\nexport function init(view){\n\tview.attachEvent(\"onStyleSet\", (name, value) => _applyStyles(view, name, value));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, style) => {\n\t\tif(type == \"style\")\n\t\t\t_undoStyle(view, row, column, style);\n\t});\n\n\treset(view);\n\n\tif (!sizeEl)\n\t\tsizeEl = webix.html.create(\"DIV\", { style:\"visibility:hidden; position:absolute; top:0px; left:0px; overflow:hidden;\"}, \"\");\n}\n\nfunction reset(view){\n\tview._styles = {};\n\tview._styles_cache = {};\n\tview._styles_max = 1;\n\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.removeStyle(prefix);\n}\n\nexport function getStyle(view, cell){\n\tvar styles = view.getRow(cell.row).$cellCss;\n\tif (styles){\n\t\tvar styleid = styles[cell.column];\n\t\tif (styleid)\n\t\t\treturn view._styles[styleid];\n\t}\n\treturn null;\n}\n\n// undo\nfunction _undoStyle(view, row, column, style){\n\tvar cell = {row: row, column: column};\n\tsetStyle(view, cell, style);\n}\n\nfunction _serialize(view, obj){\n\tvar styles = [];\n\n\tfor (var key in view._styles_cache)\n\t\tstyles.push([view._styles_cache[key].id, key]);\n\n\tobj.styles = styles;\n}\n\nexport function addStyle(view, props, origin){\n\tvar style = {\n\t\tprops:_styleFromText(\";;;;;;;;;;;;;;;\")\n\t};\n\n\tif (origin)\n\t\tfor (var key in origin.props)\n\t\t\tstyle.props[key] = origin.props[key];\n\n\tfor (let  key in props)\n\t\tstyle.props[key] = props[key];\n\t\t\n\n\tstyle.text = _styleToText(style);\n\tvar cache = view._styles_cache[style.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view, style);\n\n\treturn style;\n}\n\nfunction _parse(view, obj){\n\tif (obj.styles)\n\t\tfor (let i=0; i < obj.styles.length; i++){\n\t\t\tvar styleObj = obj.styles[i];\n\t\t\tvar style = {\n\t\t\t\tid: styleObj[0],\n\t\t\t\ttext:styleObj[1],\n\t\t\t\tprops: _styleFromText(styleObj[1])\n\t\t\t};\n\n\t\t\t_addStyle(view, style, true);\n\t\t}\n\n\tfor (let i = 0; i < obj.data.length; i++){\n\t\tvar [row, column, , css] = obj.data[i];\n\n\t\tif (css)\n\t\t\tupdate_style_data(view.getRow(row), column, view._styles[css]);\n\t}\n}\n\nfunction _applyStyles(view, name, value){\n\t//this - spreadsheet\n\tgroup.set(function(){\n\t\tview.eachSelectedCell(function(cell){\n\t\t\t_applyCellStyles(view, cell, name, value);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _applyCellStyles(view, cell, name, value){\n\tvar ostyle = getStyle(view, cell);\n\tvar nstyle = _updateStyle(view, ostyle, name, value, cell);\n\n\tif (nstyle && nstyle != ostyle)\n\t\t_setStyle(view, cell, nstyle, ostyle);\n}\n\nfunction _updateStyle(view, style, name, value, cell){\n\n\tif(_style_handlers[name]){\n\t\treturn _style_handlers[name](view, style, value, cell);\n\t}\n\n\tif (style && style.props[name] == value) return style;\n\n\tvar nstyle = { text:\"\", id:0, props: (style?webix.copy(style.props):{}) };\n\tnstyle.props[name] = value;\n\tnstyle.text = _styleToText(nstyle);\n\n\tvar cache = view._styles_cache[nstyle.text];\n\tif (cache)\n\t\treturn cache;\n\n\t_addStyle(view,nstyle);\n\n\treturn nstyle;\n}\n\nfunction update_style_data(item, column, style){\n\titem.$cellCss = item.$cellCss || {};\n\titem.$cellFormat = item.$cellFormat || {};\n\n\tif(style){\n\t\titem.$cellCss[column] = style.id;\n\t\titem.$cellFormat[column] = style.props.format || null;\n\t} else {\n\t\tdelete item.$cellCss[column];\n\t\tdelete item.$cellFormat[column];\n\t}\n}\n\nexport function setStyle(view, cell, style){\n\tvar old = getStyle(view, cell);\n\treturn _setStyle(view, cell, style, old);\n}\n\nexport function setRangeStyle(view, range, style) {\n\teachRange(range, view, _setStyle, style);\n}\n\nexport function getTextSize(view, text, css, x, y){\n\tlet width = 0;\n\tlet height = 0;\n\n\tsizeEl.innerHTML = text;\n\tsizeEl.style.width = (x||1)+\"px\";\n\tsizeEl.style.height = (y||1)+\"px\";\n\tsizeEl.className = \"webix_table_cell webix_cell \"+css;\n\tview._table.$view.appendChild(sizeEl);\n\n\twidth = Math.max(width, sizeEl.scrollWidth);\n\theight = Math.max(height, sizeEl.scrollHeight);\n\t\n\tview._table.$view.removeChild(sizeEl);\n\tsizeEl.innerHTML = \"\";\n\n\treturn { width: width, height: height };\n}\n\nfunction _setStyle(view, cell, style, old){\n\tif(view.callEvent(\"onBeforeStyleChange\", [cell.row, cell.column, style, old])){\n\t\tupdate_style_data(view.getRow(cell.row), cell.column, style);\n\t\tview.saveCell(cell.row,cell.column);\n\t\tview.callEvent(\"onStyleChange\", [cell.row, cell.column, style, old]);\n\t}\n}\n\nfunction _buildCssString(style) {\n\tlet css = \"\";\n\n\tfor (var key in style){\n\t\tif (style[key]){\n\t\t\tif( _style_map[key]){\n\t\t\t\tif(_style_map[key][style[key]])\n\t\t\t\t\tcss += _style_map[key][style[key]](style);\n\t\t\t\telse if(typeof  _style_map[key] == \"function\")\n\t\t\t\t\tcss += _style_map[key](style);\n\t\t\t}\n\t\t\telse\n\t\t\t\tcss+= key+\":\"+style[key]+\";\";\n\t\t}\n\t}\n\n\treturn css;\n}\n\nfunction _addStyle(view, style, silent){\n\tview._styles_cache[style.text] = style;\n\n\twhile (!style.id || view._styles[style.id])\n\t\tstyle.id = \"wss\"+(view._styles_max++);\n\tview._styles[style.id] = style;\n\n\tconst css = _buildCssString(style.props);\n\tlet prefix = \".wss_\"+view.$index;\n\twebix.html.addStyle(prefix+\" .\"+style.id+\"{\"+css+\"}\", prefix);\n\n\tif (!silent)\n\t\tsave(view, \"styles\", { name:style.id, text: style.text } );\n}\n\nfunction _styleToText(style){\n\tvar id = [];\n\tfor (var i=0; i<style_names.length; i++)\n\t\tid.push(style.props[style_names[i]]);\n\treturn id.join(\";\");\n}\n\nfunction _styleFromText(text){\n\tvar parts = text.split(\";\");\n\tvar props = {};\n\tfor (var i=0; i<style_names.length; i++)\n\t\tprops[style_names[i]] = parts[i];\n\treturn props;\n}\n\n\n\nexport function clearRangeStyle(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tlet style = getStyle(view,cell);\n\t\t\tif (style)\n\t\t\t\tsetStyle(view, cell, null);\n\t\t});\n\t});\n}\n\nexport function compactStyles(view){\n\tlet params  = view.serialize();\n\n\tlet data = params.data;\n\tlet styles = params.styles;\n\n\tlet used = {};\n\tfor (let i=0; i<data.length; i++){\n\t\tlet name = data[i][3];\n\t\tif (name)\n\t\t\tused[name] = 1;\n\t}\n\n\tlet newStyles = [];\n\tfor(let i = 0; i<styles.length; i++){\n\t\tlet name = styles[i][0];\n\t\tif (used[name])\n\t\t\tnewStyles.push(styles[i]);\n\t}\n\n\tparams.styles = newStyles;\n\treset(view);\n\t_parse(view, params);\n}","import {addStyle} from \"./styles\";\nimport group from \"./undo_group\";\n\nexport let formatHelpers = {};\n\nlet formats;\nlet formatsCount;\nlet formatSources;\nlet formatCache;\n\nexport function setDefaultFormats(){\n\tformats = {};\n\tformatsCount = 0;\n\tformatSources = {};\n\tformatCache = {};\n\tformatHelpers = {\n\t\tprice : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_price\";\n\t\t\t\treturn webix.i18n.priceFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.priceSettings.decimalSize, \n\t\t\t\tsymbol: webix.i18n.priceFormat(\"\"),\n\t\t\t\tseparator: 1, negative:1, type: \"price\"\n\t\t\t}, getDelimiters(\"price\"))\n\t\t},\n\t\t\"int\" : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_int\";\n\t\t\t\treturn webix.i18n.numberFormat(value);\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: webix.i18n.decimalSize,\n\t\t\t\tseparator: 1, negative:1, type: \"int\",\n\t\t\t}, getDelimiters(\"int\"))\n\t\t},\n\t\tpercent : {\n\t\t\tgetFormat : function(value, extra){\n\t\t\t\textra.css = \"webix_ssheet_format_percent\";\n\t\t\t\treturn Math.round(value*100)+\"%\";\n\t\t\t},\n\t\t\tvalues:webix.extend({\n\t\t\t\tzeros: 0, separator: 0, negative:1, type: \"percent\",\n\t\t\t}, getDelimiters(\"percent\"))\n\t\t}\n\t};\n\n\tfor(let i in formatHelpers){\n\t\tformatSources[i] = serializeFormat(formToValues(i, formatHelpers[i].values));\n\t\tformatCache[formatSources[i]] = i;\n\t}\n}\n\nexport function getDelimiters(type){\n\tif(type == \"price\")\n\t\treturn { groupSign:webix.i18n.priceSettings.groupDelimiter, decimalSign:webix.i18n.priceSettings.decimalDelimiter };\n\telse \n\t\treturn { groupSign:webix.i18n.groupDelimiter, decimalSign:webix.i18n.decimalDelimiter };\n\t\n}\n\nexport function serialize(view, data){\n\tvar formats = [];\n\n\tfor(let i in formatSources){\n\t\tif(i!=\"percent\" && i!=\"int\" && i!=\"price\") //exclude default formats\n\t\t\tformats.push([i,formatSources[i]]);\n\t}\n\tdata.formats = formats;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tformats = data.formats;\n\n\tif(formats)\n\t\tfor(i = 0; i < formats.length; i++)\n\t\t\tgetFormatName(formats[i][1],formats[i][0]);\n}\n\nexport function getFormat(name){\n\treturn formatHelpers[name] ? formatHelpers[name].getFormat : formatHelpers[name];\n}\n\nexport function getFormatSource(name, toexcel){\n\tif(toexcel){\n\t\tlet parced = parceFormat({values: formatHelpers[name].values, format: formatSources[name]});\n\t\treturn serializeFormat(parced, true);\n\t}\n\telse\n\t\treturn formatSources[name];\n}\n\nfunction getFormatName(str, values){\n\tif (formatCache[str]) return formatCache[str];\n\n\tlet name = typeof(values) == \"object\" ? \"fmt\"+(formatsCount) : values;\n\tformatsCount++;\n\n\tformats[name] = str;\n\n\tvalues = webix.extend(\n\t\ttypeof(values) == \"object\" ? values : { format:str, type:\"custom\" }, \n\t\tgetDelimiters(\"custom\")\n\t);\n\n\tformatHelpers[name] = {\n\t\tgetFormat:format2code(str, {decimalSign: values.decimalSign, groupSign: values.groupSign}),\n\t\tvalues: values\n\t};\n\n\tformatSources[name] = str;\n\tformatCache[str] = name;\n\n\treturn name;\n}\n\nexport function addFormat(view, row, column, format, type){\n\tif(!type)\n\t\ttype = {format:format, type: \"custom\"};\n\tvar old = view.getStyle(row, column);\n\tvar fmtstring = getFormatName(format, type);\n\tvar nev = addStyle(view, { format: fmtstring }, old);\n\tview.setStyle(row, column, nev);\n}\n\n\nfunction splitFormat(str){\n\tvar conditional = str.match(/.*\\[[><=].*/g);\n\tvar parts = str.split(\";\");\n\tif (!conditional){\n\t\tif (parts.length > 1){\n\t\t\tparts[0] = (parts.length > 2 ? \"[>0]\" : \"[>=0]\")+parts[0];\n\t\t\tparts[1] = \"[<0]\"+parts[1];\n\t\t\tif (parts[2])\n\t\t\t\tparts[2] = \"[=0]\"+parts[2];\n\t\t}\n\t}\n\treturn parts;\n}\n\nexport function format2code(str, delimiters){\n\tlet parts = splitFormat(str);\n\tlet code = [\"var spaces = \\\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;\\\";\"];\n\tfor (var i=0; i<parts.length; i++){\n\t\tvar separated = separateFmt(parts[i]);\n\t\tcode.push(genCode(separated.condition, separated.color.toLowerCase(), separated.fmt, i, parts.length > 0, delimiters));\n\t}\n\n\treturn new Function(\"val\",\"extra\", code.join(\"\\n\")+\" return val;\");\n}\n\nfunction genCode(check, color, line, ind, isAbs, delimiters){\n\tvar str = \"\";\n\tif (check){\n\t\tif (!ind) str+=\"if\"; else str+=\"else if\";\n\t\tif (check[0] === \"=\") check = \"=\"+check;\n\t\tstr+=\"(val\"+check+\"){\";\n\t\tif (isAbs) str+=\"val = Math.abs(val);\";\n\t}\n\tif (color)\n\t\tstr+=\"extra.css = \\\"webix_ssheet_format_\"+color+\"\\\";\";\n\tif (line.indexOf(\"%\") !== -1)\n\t\tstr += \"val = val*100;\";\n\tstr += genFormatCode(line, delimiters);\n\treturn str+(check?\"}\":\"\");\n}\n\nfunction genFormatCode(line, delimiters){\n\tif (!line) return \"return val;\";\n\tvar isQuote = 0;\n\tvar str = \"return \\\"\\\"\";\n\tvar fmt = \"\";\n\tvar comma = false;\n\tvar inserted = false;\n\n\tfor (var i=0; i<line.length; i++){\n\t\tvar betweenPlaceholders = placeholder(line[i-1])&&placeholder(line[i+1]);\n\t\tif (line[i] == \"\\\"\"){\n\t\t\tif (isQuote){\n\t\t\t\tstr += `+\"${line.substr(isQuote, i-isQuote)}\"`;\n\t\t\t\tisQuote = false;\n\t\t\t\tcontinue;\n\t\t\t} else \n\t\t\t\tisQuote = i;\n\t\t}\n\t\tif (isQuote) continue;\n\t\telse if (line[i] === delimiters.decimalSign && betweenPlaceholders){\n\t\t\tfmt+= delimiters.decimalSign;\n\t\t} else if (placeholder(line[i])){\n\t\t\tif (!inserted) { str+=\"+fmt\"; inserted=true; }\n\t\t\tfmt+=line[i];\n\t\t} else if (line[i] === delimiters.groupSign && betweenPlaceholders)\n\t\t\tcomma = true;\n\t\telse\n\t\t\tstr += `+\"${line[i]}\"`;\n\t}\n\n\tif (fmt)\n\t\treturn numberFormat(fmt, comma, delimiters)+\";\"+str + \";\";\n\telse\n\t\treturn str+\";\";\n}\n\nfunction numberFormat(fmt, comma, delimiters){\n\tvar str = \"if (isNaN(val)) var fmt = val; else {\";\n\tvar decimal = delimiters.decimalSign;\n\tvar [left, right] = getParts(fmt, decimal);\n\tright = (right || \"\").split(\"\").reverse().join(\"\");\n\n\t//calculate indexes in mask\n\tvar lzeros = left.indexOf(\"0\"); if (lzeros>=0) lzeros = left.length - lzeros;\n\tvar lfills = left.indexOf(\"?\"); if (lfills>=0) lfills = left.length - lfills;\n\tvar rzeros = right.indexOf(\"0\"); if (rzeros>=0) rzeros = right.length - rzeros;\n\tvar rfills = right.indexOf(\"?\"); if (rfills>=0) rfills = right.length - rfills;\n\tvar rmax = right.length;\n\n\tstr += `\n\tvar parts = val.toFixed(${rmax}).split(\".\");\n\tvar left = parts[0];\n\tvar lsize = left.length; \n\tvar right = parts[1] || \"\";\n\tif (left.length < ${lzeros}) left = \"0000000000\".substr(0, ${lzeros} - left.length)+left;\n\tif (left.length < ${lfills}) left = spaces.substr(0, 6*(${lfills} - left.length))+left;\n\tif (${comma}) {\n\t\tvar buf = [];\n\t\tvar start = 3;\n\t\twhile (lsize > start) { buf.push(left.substr(left.length-start,3)); start+=3; }\n\t\tvar last = left.substr(0,left.length-start+3);\n\t\tif (last !== \"-\")\n\t\t\tbuf.push(last);\n\t\telse\n\t\t\tbuf.push(\"-\"+buf.pop());\n\n\t\tleft = buf.reverse().join(\"${delimiters.groupSign}\");\n\t}\n\tif (right){\n\t\tvar zpoint = right.length-1;\n\t\twhile (zpoint >= ${rzeros}){\n\t\t\tif (right[zpoint] !== \"0\"){\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tzpoint--;\n\t\t}\n\t\t\n\t\tif (zpoint <= right.length)\n\t\t\tright = right.substr(0, zpoint+1);\n\n\t\tif (right.length < ${rfills}){\n\t\t\tright += spaces.substr(0, 6*(${rfills} - right.length));\n\t\t}\n\t}\n\tvar fmt = left+(right?\"${decimal}\":\"\")+right;\n\t`;\n\n\treturn str+\"}\\n\";\n}\n\nfunction updateDecimals(fmt, inc, val){\n\tlet parced = parceFormat(fmt);\n\tfor(let i = 0; i < parced.length; i++){\n\t\tif(parced[i].decimals){\n\t\t\tif(inc>0)\n\t\t\t\tparced[i].right.placeholders += Array(inc+1).join(\"0\");\n\t\t\telse\n\t\t\t\tparced[i].right.placeholders = parced[i].right.placeholders.slice(0, inc);\n\t\t}\n\t\telse{\n\t\t\tconst withoutText = !parced[i].left.text && !parced[i].right.text;\n\t\t\tconst withoutPlaceholders = !parced[i].left.placeholders && !parced[i].right.placeholders;\n\t\t\t//check if cell value have decimals (not cell format)\n\t\t\tif(inc < 0 && withoutText && withoutPlaceholders && webix.rules.isNumber(val) && val.indexOf(\".\") > -1){\n\t\t\t\tparced[i].left.placeholders = \"0\";\n\t\t\t\tparced[i].right.placeholders = Array(val.split(\".\")[1].length).join(Array(inc+1).join(\"0\"));\n\t\t\t}\n\t\t\t//ignore text\n\t\t\telse if(inc > 0 && (parced[i].left.placeholders || withoutText)){\n\t\t\t\tparced[i].left.placeholders = parced[i].left.placeholders || \"0\";\n\t\t\t\tparced[i].right.placeholders = Array(inc+1).join(\"0\");\n\t\t\t\tparced[i].decimals = true;\n\t\t\t}\n\t\t}\n\t\tparced[i].decimals = parced[i].right.placeholders.length > 0;\n\t}\n\n\treturn serializeFormat(parced);\n}\n\nexport function changeAreaDecimals(view, inc, row, column){\n\tlet cells = getCells(view, row, column);\n\tif(cells.length == 0)\n\t\treturn;\n\n\tconst item = view.$$(\"cells\").getItem(cells[0].row)[cells[0].column];\n\tconst firstValue = item ? item.toString() : item;\n\tconst firstStyle = view.getStyle(cells[0].row, cells[0].column);\n\n\tif(webix.rules.isNumber(firstValue) || (firstStyle && firstStyle.props.format)){\n\t\tgroup.set(function(){\n\t\t\tfor(let i = 0; i < cells.length; i++)\n\t\t\t\tchangeCellDecimals(view, inc, cells[i]);\n\t\t});\n\t\tview.refresh();\n\n\t\tconst name = view.getStyle(cells[0].row, cells[0].column).props.format;\n\t\tview.$$(\"bar\").setValues({format:name.indexOf(\"fmt\") < 0 ? name : \"custom\"}, true);\n\t}\n}\n\nexport function changeCellDecimals(view, inc, cell){\n\tlet format;\n\tconst style = view.getStyle(cell.row, cell.column);\n\tlet value = view.$$(\"cells\").getItem(cell.row)[cell.column];\n\tvalue = value ? value.toString() : \"\";\n\n\tif(style && style.props.format){\n\t\tconst name = style.props.format;\n\t\tformat = webix.copy({values:formatHelpers[name].values, format:getFormatSource(name)});\n\t\tformat.format = updateDecimals(format, inc, value);\n\n\t\tif(format.values && format.values.hasOwnProperty(\"zeros\"))\n\t\t\tformat.values.zeros = Math.max(format.values.zeros+inc, 0);\n\t}\n\t//add format for cell without format\n\telse{\n\t\tconst zeros = webix.rules.isNumber(value) && value.split(\".\")[1] ? Math.max(value.split(\".\")[1].length+inc, 0) : Math.max(inc, 0);\n\n\t\tformat = {values:{negative:1, zeros:zeros, separator:0, type:\"int\"}};\n\t\tformat.format = serializeFormat(formToValues(format.values.type, format.values));\n\t}\n\taddFormat(view, cell.row, cell.column, format.format, format.values);\n}\n\nexport function isCustom(name){\n\treturn name != \"common\" && (name.indexOf(\"fmt\") != -1 || formatHelpers[name].values.type == \"custom\");\n}\n\nexport function formToValues(type, formValues){\n\tlet values = [{condition:\">=0\", left:{text:\"\"},right:{text:\"\"}}, {condition:\"<0\", left:{text:\"\"}, right:{text:\"\"}}];\n\twebix.extend(values, getDelimiters(type));\n\tvalues[0].right.placeholders = values[1].right.placeholders = formValues.zeros ? Array(formValues.zeros + 1).join(\"0\") : \"\";\n\tvalues[0].separator = values[1].separator = formValues.separator && type != \"percent\";\n\tvalues[0].left.placeholders = values[1].left.placeholders = values[0].separator ? \"#\"+values.groupSign +\"0\" : \"0\";\n\tvalues[0].decimals = values[1].decimals = formValues.zeros ? true : false;\n\tvalues[1].color = formValues.negative != 1 ? \"red\" : \"\";\n\tvalues[1].left.text += formValues.negative < 3 ? \"-\" : \"\";\n\n\tif(type === \"percent\")\n\t\tvalues[0].right.text = values[1].right.text  = \"%\";\n\telse if(type === \"price\"){\n\t\tconst symbol = formatHelpers.price.values.symbol;\n\t\tconst right = symbol.indexOf(\" \") == 0;\n\n\t\tvalues[1][right?\"right\":\"left\"].text += symbol;\n\t\tvalues[0][right?\"right\":\"left\"].text += symbol;\n\t}\n\n\treturn values;\n}\n\nexport function serializeFormat(values, toExcel){\n\tlet fmt = \"\";\n\tfor(let i = 0; i < values.length; i++){\n\t\tif(values[i].condition)\n\t\t\tfmt += \"[\"+values[i].condition+\"]\";\n\t\tif(values[i].color)\n\t\t\tfmt += \"[\"+values[i].color+\"]\";\n\t\tif(values[i].left.text){\n\t\t\tconst leftText = values[i].left.text;\n\t\t\tfmt += toExcel ? \"\\\"\"+leftText+\"\\\"\" : leftText;\n\t\t}\n\t\tif(values[i].left.placeholders){\n\t\t\tlet leftPlaceholders = values[i].left.placeholders;\n\t\t\tfmt += toExcel ? leftPlaceholders.replace(values.groupSign, \",\") : leftPlaceholders;\n\t\t}\n\t\tif(values[i].decimals)\n\t\t\tfmt += toExcel ? \".\" : values.decimalSign;\n\t\tif(values[i].right.placeholders)\n\t\t\tfmt += values[i].right.placeholders;\n\t\tif(values[i].right.text){\n\t\t\tlet rightText = values[i].right.text;\n\n\t\t\tif(toExcel)\n\t\t\t\trightText = (\"\\\"\"+rightText+\"\\\"\").replace(/%/g, \"\\\"%\\\"\").replace(/\"\"/g, \"\");\n\n\t\t\tfmt += rightText;\n\t\t}\n\t\tif(i != values.length - 1)\n\t\t\tfmt += \";\";\n\t}\n\treturn fmt;\n}\n\nfunction parceFormat(fmt){\n\tconst fmtParts = fmt.format.split(\";\");\n\tlet values = [];\n\n\tfor(let i = 0; i < fmtParts.length; i++){\n\t\tlet separated = separateFmt(fmtParts[i]);\n\t\tvalues[i] = {color:separated.color, condition:separated.condition, left:{}, right:{}};\n\n\t\tconst format = separated.fmt;\n\n\t\tvalues.groupSign = fmt.values.groupSign;\n\t\tvalues.decimalSign = fmt.values.decimalSign;\n\n\t\tif(format.indexOf(values.groupSign) > -1)\n\t\t\tvalues[i].separator = true;\n\n\t\tconst sepFmtParts = getParts(format, values.decimalSign);\n\n\t\tlet left = sepFmtParts[0];\n\t\tlet right = sepFmtParts[1] || \"\";\n\n\t\tif(sepFmtParts[1])\n\t\t\tvalues[i].decimals = true;\n\n\t\tleft = getFmtPartValues(left, \"left\", values.groupSign);\n\t\tright = getFmtPartValues(right, \"right\", values.groupSign);\n\n\t\tvalues[i].left = {\n\t\t\ttext: left.leftText,\n\t\t\tplaceholders: left.placeholders\n\t\t};\n\n\t\tvalues[i].right = {\n\t\t\ttext: left.rightText + right.rightText,\n\t\t\tplaceholders: right.placeholders\n\t\t};\n\t}\n\treturn values;\n}\n\nfunction getFmtPartValues(fmtPart, type, groupSign){\n\tlet firstPlaceholder;\n\tif(type == \"left\"){\n\t\tfirstPlaceholder = fmtPart.match(/[#?0]/);\n\t\tfirstPlaceholder = firstPlaceholder ? firstPlaceholder.index : Infinity;\n\t}\n\n\tlet leftText = \"\";\n\tlet rightText = \"\";\n\tlet placeholders = \"\";\n\tfor(let k = 0; k < fmtPart.length; k++){\n\t\tif(!placeholder(fmtPart[k])){\n\t\t\tif(fmtPart[k] == groupSign && placeholder(fmtPart[k+1]) && placeholder(fmtPart[k-1])){\n\t\t\t\tplaceholders += fmtPart[k];\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(type == \"left\")\n\t\t\t\tif(k < firstPlaceholder){\n\t\t\t\t\tleftText += fmtPart[k];\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\trightText += fmtPart[k];\n\t\t}\n\t\telse\n\t\t\tplaceholders += fmtPart[k];\n\t}\n\treturn {leftText: leftText, rightText: rightText, placeholders: placeholders};\n}\n\nfunction separateFmt(line){\n\tlet color = \"\";\n\tlet check = \"\";\n\tlet start = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tif (line[1].match(/[><=]/)){\n\t\t\tlet end = line.indexOf(\"]\");\n\t\t\tcheck = line.substr(start+1, end-start-1);\n\t\t\tline = line.substr(end+1);\n\t\t}\n\t}\n\n\tstart = line.indexOf(\"[\");\n\tif (start !== -1){\n\t\tlet end = line.indexOf(\"]\");\n\t\tcolor = line.substr(start+1, end-start-1);\n\t\tline = line.substr(end+1);\n\t}\n\treturn {condition:check, color:color, fmt:line};\n}\n\nfunction getCells(view, row, column){\n\tif(row && column){\n\t\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\t\tlet cells = [];\n\t\t\tfor (let r = row.row; r<=column.row; r++)\n\t\t\t\tfor (let c = row.column; c<=column.column; c++)\n\t\t\t\t\tcells.push({row: r, column: c});\n\t\t\treturn cells;\n\t\t}\n\t\telse\n\t\t\treturn [{row: row, column: column}];\n\t}\n\telse\n\t\treturn view.getSelectedId(true);\n}\n\nfunction placeholder(val){\n\treturn val === \"0\" || val === \"#\" || val === \"?\";\n}\n\nfunction getParts(str, decimal){\n\t// it is nessesary to use \"/\" before decimal to escape regex special characters\n\tconst match = str.match(\"[#?0][/\"+decimal+\"][#?0]\");\n\tif(match)\n\t\treturn [str.substring(0, match.index+1), str.substring(match.index+2)];\n\telse\n\t\treturn [str];\n}","import {changeAreaDecimals} from \"../operations/formats\";\n\nexport const actions = {\n\tspan: function(view){\n\t\tvar range = view.$$(\"cells\").getSelectArea();\n\t\tif(range){\n\t\t\tif(isMerged(view,range)){\n\t\t\t\tview.splitCell();\n\t\t\t}\n\t\t\telse{\n\t\t\t\tlet values = [];\n\t\t\t\tfor(let r = range.start.row; r<=range.end.row; r++){\n\t\t\t\t\tfor(let c = range.start.column; c<=range.end.column; c++){\n\t\t\t\t\t\tlet value = view.getCellValue(r,c);\n\t\t\t\t\t\tif(value) values.push(value);\n\t\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t\t}\n\t\t\t\t\tif(values.length >1) break;\n\t\t\t\t}\n\t\t\t\tif(values.length>1){\n\t\t\t\t\tview.confirm({\n\t\t\t\t\t\ttext:webix.i18n.spreadsheet.labels[\"merge-cell-confirm\"],\n\t\t\t\t\t\tcallback:function(res){\n\t\t\t\t\t\t\tif(res) view.combineCells();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tview.combineCells();\n\t\t\t}\n\t\t}\n\t},\n\tundo: function(view){\n\t\tview.undo();\n\t},\n\tredo: function(view){\n\t\tview.redo();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t},\n\t\"freeze-columns\": function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeColumns(select && select.column!=\"rowId\"?select.column : 0);\n\t},\n\t\"freeze-rows\":function(view){\n\t\tvar table = view.$$(\"cells\");\n\t\tvar select = table.getSelectedId();\n\t\tview.freezeRows(select ? select.row : 0);\n\t},\n\t\"increase-decimals\": function(view){\n\t\tchangeAreaDecimals(view, 1);\n\t},\n\t\"decrease-decimals\": function(view){\n\t\tchangeAreaDecimals(view, -1);\n\t},\n};\n\nfunction isMerged(view,range){\n\tvar i, j,\n\t\tc0 = range.start,\n\t\tc1 = range.end;\n\n\tfor( i = c0.row*1; i <= c1.row*1; i++ ){\n\t\tfor( j = c0.column*1; j <= c1.column*1; j++ ){\n\t\t\tif(view.$$(\"cells\").getSpan(i, j))\n\t\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}\n","import {toolbarSizes, defaultStyles} from \"./defaults\";\nimport {formatHelpers} from \"../operations/formats\";\n\n// options for 'font-family' select\nexport const fontFamily = [\n\t{id: \"Arial\", value: \"Arial\"},\n\t{id: \"'Roboto', sans-serif\", value: \"Roboto\"},\n\t{id: \"'PT Sans', Tahoma\", value: \"PT Sans\"},\n\t{id: \"Tahoma\", value: \"Tahoma\"},\n\t{id: \"Verdana\", value: \"Verdana\"},\n\t{id: \"Calibri, Tahoma\", value:\"Calibri\"}\n];\n\n// options for 'format' select\nfunction getCellFormats(){\n\tconst locale = webix.i18n.spreadsheet.labels;\n\treturn [\n\t\t{id: \"common\", value: locale.common },\n\t\t{id: \"price\", value: locale.currency, example: \"98.20\"},\n\t\t{id: \"int\", value: locale.number, example: \"2120.02\"},\n\t\t{id: \"percent\", value: locale.percent, example:\"0.5\"},\n\t\t{id: \"custom\", value: locale[\"custom-format\"]},\n\t];\n}\n\nexport function getColumnOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet colOperations = [\n\t\t{ id:\"add\",    group:\"column\", value:locale[\"insert-column\"]},\n\t\t{ id:\"del\",    group:\"column\", value:locale[\"delete-column\"]},\n\t\t{ id:\"show\",   group:\"column\", value:locale[\"show-column\"]},\n\t\t{ id:\"hide\",   group:\"column\", value:locale[\"hide-column\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\tcolOperations.push({ id:\"resize\", group:\"column\", value:locale[\"resize-column\"]});\n\treturn colOperations;\n}\n\nexport function getRowOperation(view){\n\tconst locale = webix.i18n.spreadsheet.menus;\n\tlet rowOperations = [\n\t\t{ id:\"add\",    group:\"row\", value:locale[\"insert-row\"]},\n\t\t{ id:\"del\",    group:\"row\", value:locale[\"delete-row\"]},\n\t\t{ id:\"show\",   group:\"row\", value:locale[\"show-row\"]},\n\t\t{ id:\"hide\",   group:\"row\", value:locale[\"hide-row\"]}\n\t];\n\tif(view.config.resizeCell != false)\n\t\trowOperations.push({ id:\"resize\", group:\"row\", value:locale[\"resize-row\"]});\n\treturn rowOperations;\n}\n\n// options for 'clear' select\nexport function getClearOperation(){\n\treturn [\n\t\t{id: \"clear-value\",               value: getLocaleClear(\"value\")},\n\t\t{id: \"clear-style\",               value: getLocaleClear(\"style\")},\n\t\t{id: \"clear-conditional-formats\", value: getLocaleClear(\"conditional-formats\")},\n\t\t{id: \"clear-dropdown-editors\",    value: getLocaleClear(\"dropdown-editors\")},\n\t\t{id: \"clear-comments\",            value: getLocaleClear(\"comments\")},\n\t\t{ $template: \"Separator\" },\n\t\t{id: \"clear-all\",                 value: getLocaleClear(\"all\")}\n\t];\n}\n\n// options for 'borders' select\nconst borders = [\n\t{id: \"no\", value: \"no\"},\n\t{id: \"left\", value: \"left\"},\n\t{id: \"top\", value: \"top\"},\n\t{id: \"right\", value: \"right\"},\n\t{id: \"bottom\", value: \"bottom\"},\n\t{id: \"all\", value: \"all\"},\n\t{id: \"outer\", value: \"outer\"},\n\t{id: \"top-bottom\", value: \"top-bottom\"}\n];\n\nfunction getLocaleClear(value){\n\tvar locale = webix.i18n.spreadsheet.menus;\n\treturn locale[\"clear\"] + \" \" + locale[\"clear-\"+value].toLowerCase();\n}\n\n// options for 'font-size' select\nfunction getFontSize(){\n\tvar numbers = [\n\t\t\"8\",\"9\",\"10\",\"11\",\"12\",\"14\",\"15\",\n\t\t\"16\",\"18\",\"20\",\"22\",\"24\",\"28\",\"36\"\n\t];\n\tvar  fontSize = [];\n\n\tfor(var i =0; i < numbers.length; i++){\n\t\tfontSize.push({id: numbers[i]+webix.i18n.spreadsheet.labels.px, value: numbers[i]});\n\t}\n\treturn fontSize;\n}\n\nexport const styleFormats = {\n\t\"font-weight\": \"bold\",\n\t\"font-style\": \"italic\",\n\t\"text-decoration\": \"underline\"\n};\n\nexport const ui = {\n\tbutton: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-toggle\", width: config.width||toolbarSizes.width, id: config.name, name: config.name,  label: config.label,\n\t\t\tcss: config.css||\"\", onValue: styleFormats[config.name], offValue: \"normal\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\tcolorButton: function(config){\n\t\treturn   {\n\t\t\tview: \"ssheet-color\",  css: config.css,  name: config.name, width: config.width||toolbarSizes.width+24,\n\t\t\ttitle: \"<span class='webix_ssheet_button_icon webix_ssheet_color_button_icon webix_ssheet_icon ssi-\"+config.name+\"' ></span>\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||\"\"\n\t\t};\n\t},\n\ticonButton: function(config){\n\t\tvar btn = webix.copy(config);\n\t\twebix.extend(btn, {view: \"button\", type:\"htmlbutton\", width: toolbarSizes.width, id: config.name,\n\t\t\tlabel: \"<span class='webix_ssheet_button_icon webix_ssheet_icon ssi-\"+config.name+\"'></span>\",\n\t\t\tcss: \"\",\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name]||webix.i18n.spreadsheet.menus[config.name]||\"\"\n\t\t});\n\t\tif(config.onValue){\n\t\t\twebix.extend(btn,{view: \"ssheet-toggle\", onValue: config.onValue, offValue: config.offValue},true);\n\t\t}\n\n\t\treturn btn;\n\t},\n\tsegmented: function(config){\n\t\treturn  {\n\t\t\tview: \"segmented\", name: config.name, css:config.css||\"\", width: config.width||toolbarSizes.width+76,  options:config.options\n\t\t};\n\t},\n\tselect: function(config){\n\t\twebix.extend(config,{\n\t\t\tview: \"richselect\",\n\t\t\tid: config.name,\n\t\t\tvalue: defaultStyles[config.name],\n\t\t\tsuggest: {\n\t\t\t\tcss: \"webix_ssheet_suggest\",\n\t\t\t\t//fitMaster: false,\n\t\t\t\tpadding: 0,\n\t\t\t\tdata: config.options\n\t\t\t}\n\t\t});\n\n\t\tconfig.tooltip = webix.i18n.spreadsheet.tooltips[config.name]||\"\";\n\t\tif(config.popupWidth){\n\t\t\tconfig.suggest.fitMaster = false;\n\t\t\tconfig.suggest.width = config.popupWidth;\n\t\t}\n\t\tif(config.popupTemplate)\n\t\t\tconfig.suggest.body = {\n\t\t\t\ttemplate: config.popupTemplate\n\t\t\t};\n\t\tif(config.popupEvents){\n\t\t\tconfig.suggest.body = config.suggest.body || {};\n\t\t\tconfig.suggest.body.on = config.popupEvents;\n\t\t}\n\t\treturn config;\n\t},\n\tseparator: function(){\n\t\treturn {\n\t\t\tview: \"ssheet-separator\"\n\t\t};\n\t},\n\ttitle: function(config){\n\t\tvar title = config.title;\n\t\tif(title.indexOf(\"$\") === 0)\n\t\t\ttitle = \"\";\n\t\ttitle = webix.i18n.spreadsheet.labels[config.title]||title;\n\n\t\treturn {\n\t\t\ttemplate: title, view: \"ssheet-bar-title\", height: toolbarSizes.titleHeight\n\t\t};\n\t},\n\tborders: function(config){\n\t\treturn {view: \"ssheet-borders\", width:config.width||toolbarSizes.width+24, data: borders, id: config.name, name: config.name,\n\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\talign: function(config){\n\t\treturn {view: \"ssheet-align\", value: defaultStyles[config.name], width:config.width||toolbarSizes.width+24, data: config.options,\n\t\t\tname: config.name, tooltip: webix.i18n.spreadsheet.tooltips[config.name] };\n\t},\n\tcondFormat: function(config){\n\t\treturn {\n\t\t\tview: \"ssheet-cond-format\",\n\t\t\twidth: 40,\n\t\t\tid: config.name,\n\t\t\tname: config.name\n\t\t};\n\t}\n};\n\nexport const buttonsMap = {\n\t\"font-family\": function(){\n\t\treturn  ui.select({name: \"font-family\", options:fontFamily, width: 100});\n\t},\n\t\"font-size\": function(){\n\t\treturn  ui.select({name: \"font-size\", options:getFontSize(), width: 64});\n\t},\n\t\"font-weight\": function(){\n\t\treturn ui.button({name:\"font-weight\",label: \"B\", css: \"webix_ssheet_bold\"});\n\t},\n\t\"font-style\": function(){\n\t\treturn ui.button({name: \"font-style\",label: \"I\",css:\"webix_ssheet_italic\"});\n\t},\n\t\"text-decoration\": function(){\n\t\treturn ui.button({name: \"text-decoration\",label: \"U\",css: \"webix_ssheet_underline\"});\n\t},\n\t\"color\": function(){\n\t\treturn ui.colorButton({name: \"color\",icon:\"font\",css:\"webix_ssheet_color\"});\n\t},\n\t\"background\": function(){\n\t\treturn  ui.colorButton({name: \"background\",icon:\"paint-brush\",css:\"webix_ssheet_background\", width: 64});\n\t},\n\t\"borders\": function(){\n\t\treturn ui.borders({ name: \"borders\" });\n\t},\n\t\"text-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn ui.align({name: \"text-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"left\", css: \"webix_ssheet_icon ssi-left\", tooltip: locale[\"align-left\"]},\n\t\t\t{id: \"center\", css: \"webix_ssheet_icon ssi-center\", tooltip: locale[\"align-center\"]},\n\t\t\t{id: \"right\", css: \"webix_ssheet_icon ssi-right\", tooltip: locale[\"align-right\"]}\n\t\t]});\n\t},\n\t\"vertical-align\": function(){\n\t\tvar locale = webix.i18n.spreadsheet.tooltips;\n\t\treturn  ui.align({name: \"vertical-align\", css: \"webix_ssheet_align\", options:[\n\t\t\t{id: \"top\", css: \"webix_ssheet_icon ssi-top\", tooltip: locale[\"align-top\"]},\n\t\t\t{id: \"middle\", css: \"webix_ssheet_icon ssi-middle\", tooltip: locale[\"align-middle\"]},\n\t\t\t{id: \"bottom\", css: \"webix_ssheet_icon ssi-bottom\", tooltip: locale[\"align-bottom\"]}\n\t\t]});\n\t},\n\t\"wrap\": function(){\n\t\treturn ui.iconButton({name: \"wrap\", onValue: \"wrap\",offValue:\"nowrap\"});\n\t},\n\t\"format\": function(){\n\t\treturn ui.select({\n\t\t\tname: \"format\", width: 106, options:getCellFormats(), popupWidth: 180,\n\t\t\tpopupTemplate: function(obj){\n\t\t\t\t//make it look like an actual cell\n\t\t\t\tvar format =  formatHelpers[obj.id] ? formatHelpers[obj.id].getFormat : \"\";\n\t\t\t\tvar cell = {css:\"\"};\n\t\t\t\tvar example = format && obj.example?format(obj.example, cell):\"\";\n\t\t\t\treturn obj.value + (format?\"<span class='webix_ssheet_right\"+(cell.css?\" \"+cell.css:\"\")+\"'>\"+example+\"</span>\":\"\");\n\t\t\t},\n\t\t\tpopupEvents:{\n\t\t\t\tonItemClick: function(id){\n\t\t\t\t\tif(id == \"custom\")\n\t\t\t\t\t\tthis.getTopParentView().callEvent(\"onCommand\", [{id:id}]);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t},\n\t\"column\": function(view){\n\t\treturn {\n\t\t\tname: \"column\",\n\t\t\tview: \"ssheet-button\", icon: \"column\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getColumnOperation(view)\n\t\t};\n\t},\n\t\"row\": function(view){\n\t\treturn {\n\t\t\tname: \"row\", view: \"ssheet-button\", icon: \"row\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getRowOperation(view)\n\t\t};\n\t},\n\t\"clear\": function(){\n\t\treturn {\n\t\t\tname: \"clear\", view: \"ssheet-button\", icon: \"clear-styles\",\n\t\t\tarrow: true, area: true, width: 58,\n\t\t\toptions:getClearOperation()\n\t\t};\n\t},\n\t\"comment\": function(){\n\t\treturn {\n\t\t\tname: \"comment\",\n\t\t\tview: \"ssheet-button\", icon: \"comments\",\n\t\t\tarrow: true, area: true, width: 55\n\t\t};\n\t}\n};","import {toolbarSizes} from \"./defaults\";\n\nfunction getText(text){\n\tvar locale = webix.i18n.spreadsheet;\n\treturn locale.menus[text] || locale.labels[text] || locale.tooltips[text] || text;\n}\nfunction calcButtons(){\n\tvar i, name, width,\n\t\tgroups = {\n\t\t\t\"undo\":[\"undo\",\"redo\"],\n\t\t\t\"insert\":[\"add-sparkline\",\"add-image\",\"add-comment\"]\n\t\t},\n\t\tresult = {};\n\n\tfor( name in groups){\n\t\tresult[name] = 0;\n\t\tfor(i=0; i < groups[name].length; i++){\n\t\t\twidth = webix.html.getTextSize(getText(groups[name][i]), \"webix_ssheet_button_measure\").width + 7;\n\t\t\tresult[name] = Math.max(width,result[name]);\n\t\t}\n\t}\n\treturn result;\n}\nexport function getAllElements(){\n\tvar sizes = calcButtons();\n\tvar titleHeight = toolbarSizes.titleHeight;\n\n\treturn [\n\t\t{\n\t\t\tpadding: 3,\n\t\t\tmargin: 0,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tname: \"sheet\", view: \"ssheet-button-icon-top\", label: getText(\"sheet\"), arrow: true,\n\t\t\t\t\t\t\toptions:[\n\t\t\t\t\t\t\t\t{id: \"new-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"copy-sheet\"},\n\t\t\t\t\t\t\t\t{id: \"remove-sheet\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"excel-import\"},\n\t\t\t\t\t\t\t\t{$button: \"excel-export\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button: \"print\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{},\n\t\t\t\t{template: getText(\"file\"), view: \"ssheet-bar-title\", height: titleHeight, width: 85}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"undo\", view: \"ssheet-button\", label: getText(\"undo\"), width: sizes.undo },\n\t\t\t\t{$button: \"redo\", view: \"ssheet-button\", label: getText(\"redo\"), width: sizes.undo},\n\t\t\t\t{template: getText(\"undo-redo\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-family\", width: (webix.skin.$active.inputHeight+2)*3+4},\n\t\t\t\t\t\t\t\t{$button: \"font-size\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{$button: \"borders\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tmargin: 2,\n\t\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t\t{$button: \"font-weight\"},\n\t\t\t\t\t\t\t\t{$button: \"font-style\"},\n\t\t\t\t\t\t\t\t{$button: \"text-decoration\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\t{$button: \"background\"},\n\t\t\t\t\t\t{$button: \"color\"}\n\t\t\t\t\t]\n\n\t\t\t\t},\n\t\t\t\t{template: getText(\"font\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"text-align\"},\n\t\t\t\t\t\t{$button: \"span\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"vertical-align\"},\n\n\t\t\t\t\t\t{$button: \"wrap\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"align\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{$button: \"format\"},\n\t\t\t\t{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"increase-decimals\"},\n\t\t\t\t\t\t{$button: \"decrease-decimals\"}\n\t\t\t\t\t]\n\t\t\t\t},\n\n\t\t\t\t{template: getText(\"number\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-asc\"},\n\t\t\t\t\t{ $button: \"create-filter\"},\n\t\t\t\t\t{ $button: \"conditional-format\"},\n\t\t\t\t\t{ $button: \"add-link\"},\n\t\t\t\t\t{ $button: \"clear\"}\n\t\t\t\t]},\n\t\t\t\t{cols:[\n\t\t\t\t\t{ $button: \"sort-desc\"},\n\t\t\t\t\t{ $button: \"add-range\"},\n\t\t\t\t\t{ $button: \"lock-cell\"},\n\t\t\t\t\t{ $button: \"add-dropdown\"}\n\t\t\t\t]},\n\t\t\t\t{template: getText(\"edit\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{$button: \"add-image\", view: \"ssheet-button\", label: getText(\"image\"), width:sizes.insert},\n\t\t\t\t\t\t{$button: \"add-comment\", view: \"ssheet-button\", label: getText(\"comment\"), width:sizes.insert},\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{$button: \"add-sparkline\", view: \"ssheet-button\", label: getText(\"graph\"), width:sizes.insert},\n\t\t\t\t{template: getText(\"insert\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\n\t\t{view: \"ssheet-separator\"},\n\t\t{\n\t\t\tpadding: 3,\n\t\t\trows:[\n\t\t\t\t{\n\t\t\t\t\tcols:[\n\t\t\t\t\t\t{rows:[\n\t\t\t\t\t\t\t{$button:\"row\"},\n\t\t\t\t\t\t\t{$button:\"column\"}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"hide-gridlines\"},\n\t\t\t\t\t\t\t\t{$button:\"hide-headers\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\trows:[\n\t\t\t\t\t\t\t\t{$button:\"freeze-rows\"},\n\t\t\t\t\t\t\t\t{$button:\"freeze-columns\"}\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}\n\t\t\t\t\t]\n\t\t\t\t},\n\t\t\t\t{template: getText(\"view\"), view: \"ssheet-bar-title\", height: titleHeight}\n\t\t\t]\n\t\t},\n\t\t{view: \"ssheet-separator\"},\n\t\t{}\n\t];\n}","import {actions} from \"./toolbar/actions\";\nimport {defaultStyles} from \"./toolbar/defaults\";\nimport {toolbarButtons, getButtons} from \"./toolbar/helpers\";\nimport * as elm from \"./toolbar/all_elements\";\nimport {isCustom} from \"./operations/formats\";\n\nconst buttons = {\n\t\"undo-redo\": [\"undo\",\"redo\"],\n\t\"font\": [\"font-family\",\"font-size\",\"font-weight\",\"font-style\",\"text-decoration\",\"color\",\"background\",\"borders\"],\n\t\"align\": [\"text-align\",\"vertical-align\",\"wrap\",\"span\"],\n\t\"format\": [\"format\"]\n};\n\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\tvar elements = [];\n\n\tif(view.config.toolbar){\n\t\tlet allElements =  view.config.toolbar;\n\t\tif(allElements == \"full\"){\n\t\t\tallElements = elm.getAllElements();\n\t\t\tif(webix.isUndefined(view.config.bottombar))\n\t\t\t\tview.config.bottombar = true;\n\t\t}\n\t\telements =   toolbarButtons(view, allElements);\n\t}\n\telse\n\t\telements =   getButtons(view, view.config.buttons || buttons);\n\n\tvar bar = {\n\t\tview:\"toolbar\",\n\t\tcss: \"webix_ssheet_toolbar webix_layout_toolbar\",\n\t\tid:\"bar\",\n\t\tpadding:0,\n\t\telements: elements,\n\t\ton: {\n\t\t\tonChange: function (){\n\t\t\t\tvar source = this.$eventSource;\n\t\t\t\tvar value = source.getValue();\n\t\t\t\tvar name = source.config.name;\n\t\t\t\tif(name == \"format\" && value == \"common\")\n\t\t\t\t\tvalue = \"\";\n\t\t\t\tif(!(name == \"format\" && value == \"custom\"))\n\t\t\t\t\tview.callEvent(\"onStyleSet\", [name, value]);\n\t\t\t},\n\t\t\tonItemClick: function (id){\n\t\t\t\tvar viewId = view.innerId(id);\n\t\t\t\tif (actions[viewId])\n\t\t\t\t\tactions[viewId].call(this, view);\n\t\t\t\telse\n\t\t\t\t\tview.callEvent(\"onCommand\", [{ id: viewId }]);\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"toolbar\", bar]);\n\treturn bar;\n\n}\n\nfunction ready(view){\n\tview.attachEvent(\"onAfterSelect\", (selected) => setValues(view, selected));\n}\n\nfunction setValues(view, selected) {\n\tvar styles = {};\n\tvar cell = selected[0];\n\tif(cell){\n\t\tvar obj = view.getStyle(cell.row, cell.column);\n\t\tif (obj)\n\t\t\tstyles = obj.props;\n\t}\n\n\tvar barStyles = webix.copy(styles);\n\n\tfor(var i in defaultStyles){\n\t\tif(!barStyles[i])\n\t\t\tbarStyles[i] = defaultStyles[i];\n\t}\n\n\tbarStyles.format = isCustom(barStyles.format) ? \"custom\" : barStyles.format;\n\n\tview.$$(\"bar\").setValues(barStyles);\n}","import {ui, buttonsMap} from \"./buttons\";\n\nexport function toolbarButtons(view,structure){\n\tvar checkButtons = function(cells){\n\t\tfor(var i =0; i < cells.length; i++){\n\t\t\tvar name = cells[i].$button;\n\t\t\tif (name){\n\t\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\t\twebix.extend(cells[i], base);\n\t\t\t}\n\t\t\t\n\t\t\tif(cells[i].rows)\n\t\t\t\tcheckButtons(cells[i].rows);\n\t\t\tif(cells[i].cols)\n\t\t\t\tcheckButtons(cells[i].cols);\n\t\t}\n\t};\n\tcheckButtons(structure);\n\treturn structure;\n}\n\nexport function getButtons(view,structure){\n\tvar config = [];\n\tfor(var block in structure){\n\t\tconfig.push(elementsBlock(view, block, structure[block]));\n\t\tconfig.push(ui.separator());\n\t}\n\treturn config;\n}\n\nfunction blockColumns(view, buttons){\n\tvar cols = [];\n\tfor(var i =0; i < buttons.length; i++){\n\t\tlet name = buttons[i];\n\t\tif(typeof name == \"object\"){\n\t\t\tcols.push(name);\n\t\t}\n\t\telse {\n\t\t\tvar base = buttonsMap[name] ? buttonsMap[name](view) : ui.iconButton({name:name});\n\t\t\tcols.push(base);\n\t\t}\n\t}\n\treturn cols;\n}\n\n\nfunction elementsBlock(view, name, columns){\n\tvar block = {\n\t\trows:[\n\t\t\t{\n\t\t\t\tpadding:2,\n\t\t\t\tcols:[{\n\t\t\t\t\tmargin: 2,\n\t\t\t\t\tcols: blockColumns(view, columns)\n\t\t\t\t}]\n\t\t\t},\n\t\t\tui.title({title:name})\n\t\t]\n\t};\n\treturn block;\n}","import {getTextSize} from \"./styles\";\n\nexport function selectRow(row, view, endRow){\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow:row,\n\t\tcolumn:columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: (endRow || row),\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectAll(view){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar columns = view.$$(\"cells\").config.columns;\n\tvar firstColumn = columns[0].id == \"rowId\" ? 1 : 0;\n\n\tvar start = {\n\t\trow: order[0],\n\t\tcolumn: columns[firstColumn].id\n\t};\n\tvar last = {\n\t\trow: order[order.length-1],\n\t\tcolumn: columns[columns.length-1].id\n\t};\n\n\tif(start.column && last.column)\n\t\t_selectRange(start, last, view);\n}\n\nexport function selectColumn(column, view, endColumn){\n\tvar order = view.$$(\"cells\").data.order;\n\tvar startRow = order[0];\n\tvar lastRow = order[order.length-1];\n\n\tvar start = {row: startRow, column: column};\n\tvar last = {row: lastRow, column: (endColumn || column) };\n\n\t_selectRange(start, last, view);\n}\n\nexport function isColSelected(column, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (column >= selectedArea.start.column && column <= selectedArea.end.column)\n\t\t\treturn true;\n\t}\n\treturn false;\n}\n\nexport function isCellSelected(row, column, view){\n\treturn isRowSelected(row, view) && isColSelected(column, view);\n}\n\nexport function isRowSelected(row, view){\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\tif (selectedArea){\n\t\tif (row >= selectedArea.start.row && row <= selectedArea.end.row)\n\t\t\treturn true;\n\t}\n\treturn false;\t\n}\n\nexport function selectColumns(column, view) {\n\tconst selectedArea = view.$$(\"cells\").getSelectArea();\n\t\n\tif (!selectedArea)\n\t\tselectColumn(column, view);\n\telse {\n\t\tlet col1 = Math.min(selectedArea.start.column, selectedArea.end.column, column);\n\t\tlet col2 = Math.max(selectedArea.start.column, selectedArea.end.column, column);\n\t\tselectColumn(col1, view, col2);\n\t}\n}\n\nfunction _selectRange(a, b, view){\n\tview.$$(\"cells\").addSelectArea(a, b);\n}\n\n\nexport function adjustColumn(column, view) {\n\tlet width = 25;\n\n\tview._table.eachRow(function(row) {\n\t\tconst rowobj = this.getItem(row);\n\t\tconst text = this.getText(row, column);\n\t\tlet style = view.getStyle(row, column);\n\t\tlet css = style ? style.id : \"\";\n\n\t\tif (text) {\n\t\t\tlet size = getTextSize(view, text, css, 0, rowobj.$height);\n\t\t\tif (size.width > width) width = size.width;\n\t\t}\n\t});\n\tview._table.setColumnWidth(column, width);\n}\n\nexport function adjustRow(row, view) {\n\tlet height = 25;\n\t\n\tview._table.eachColumn(function(column) {\n\t\tconst text = this.getText(row, column);\n\t\tlet style = view.getStyle(row, column);\n\t\tlet css = style ? style.id : \"\";\n\n\t\tif (text) {\n\t\t\tlet size = getTextSize(view, text, css, this.getColumnConfig(column).width, 0);\n\t\t\tif (size.height > height) height = size.height;\n\t\t}\n\t});\n\tview._table.setRowHeight(row, height);\n}\n\nexport function highlightColRow(start,end, view){\n\tif(!view._table.config.header) return;\n\t\n\tvar sr = start.row, er = end.row, sc = start.column, ec = end.column;\n\tif(er<sr) [sr, er] = [er, sr];\n\tif(ec<sc) [sc, ec] = [ec, sc];\n\n\tview._table.eachRow(function(row){\n\t\tif(row >=sr && row<=er)\n\t\t\tview._table.addCellCss(row, \"rowId\", \"webix_highlight\");\n\t\telse \n\t\t\tview._table.removeCellCss(row, \"rowId\", \"webix_highlight\");\n\t});\n\n\tview._table.eachColumn(function(col){\n\t\tvar node = view._table.getHeaderNode(col);\n\t\tif(!node) return;\n\n\t\tif(col >=sc && col<=ec)\n\t\t\twebix.html.addCss(node, \"webix_highlight\");\n\t\telse\n\t\t\twebix.html.removeCss(node, \"webix_highlight\");\n\t});\n}\n\n\n\n\n\n\n","import * as cop from \"./operations/column_operations\";\nimport * as nms from \"./helpers/column_names\";\nimport * as fmt from \"./operations/formats\";\n\nexport function init(view, extra){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar datatable = {\n\t\tview:\"datatable\", id:\"cells\", css:\"webix_ssheet_table webix_data_border wss_\"+view.$index,\n\t\theaderRowHeight: webix.skin.$name == \"contrast\" || webix.skin.$name == \"flat\" ? 24 : 20,\n\t\tspans: true,\n\t\tleftSplit: 1,\n\t\tareaselect:true,\n\t\teditable:true,\n\t\teditaction:(extra.liveEditor ? \"custom\" : \"dblclick\"),\n\t\tminColumnWidth:1,\n\t\tminRowHeight:1,\n\t\tnavigation:true\n\t};\n\n\t//enable clipboard by default\n\tif (extra.clipboard !== false){\n\t\textra.clipboard = \"custom\";\n\t\tif(extra.clipboardDecimalDelimiter)\n\t\t\textra.templateCopy = function(item) {\n\t\t\t\tif(webix.rules.isNumber(item))\n\t\t\t\t\titem = item.toString().replace(\".\", extra.clipboardDecimalDelimiter);\n\t\t\t\treturn item;\n\t\t\t};\n\t}\n\tif (extra)\n\t\tdatatable = webix.extend(datatable, extra, true);\n\n\treturn datatable;\n}\n\nfunction ready(view){\n\tvar grid = view._table;\n\n\tvar showHandler = webix.event(document.body, \"mousemove\", function(){\n\t\tvar thread;\n\t\treturn function(e) {\n\t\t\tclearTimeout(thread);\n\t\t\tthread = webix.delay(function(e){\n\t\t\t\tif(view.comments._activeComment.editStatus)\n\t\t\t\t\treturn;\n\n\t\t\t\tvar cell = grid.locate(e);\n\t\t\t\tvar visible = view.comments.commentsView && view.comments.commentsView.isVisible();\n\n\t\t\t\tif(cell && view.comments.get(cell.row, cell.column)){\n\t\t\t\t\tvar activeCell = view.comments._activeComment.cell;\n\t\t\t\t\tif((activeCell && (activeCell.row != cell.row || activeCell.column != cell.column)) || !visible)\n\t\t\t\t\t\tview.callEvent(\"onCommand\",[{id: \"add-comment\", cell, viewonly: true }]);\n\t\t\t\t}\n\t\t\t\telse if(visible && !view.comments.commentsView.$view.contains(e.target))\n\t\t\t\t\tview.callEvent(\"onCommentHide\", []);\n\t\t\t}, true, [e], 250);\n\t\t};\n\t}());\n\n\tview.attachEvent(\"onDestruct\", () => webix.eventRemove(showHandler));\n\n\t//in grid math\n\tif (view.config.math){\n\t\tgrid.config.editMath = true;\n\t}\n\n\t//saving value after edit\n\tgrid.attachEvent(\"onBeforeEditStop\", (st, ed) => {\n\t\t//ignore empty cells\n\t\tif (st.old === webix.undefined && st.value === \"\") return;\n\n\t\tif (st.value != st.old){\n\t\t\tview.setCellValue(ed.row, ed.column, st.value);\n\t\t\tgrid.refresh();\n\t\t}\n\t\tst.value = st.old;\n\t});\n\t\n\t//column drag event checking\n\tlet dragStartColumn;\n\tgrid.$view.firstChild.addEventListener(\"mousedown\", (e)=>{\n\t\t//column ids are starting from 0, thats why we adding 1\n\t\tdragStartColumn = e.target.parentNode.cellIndex + 1;\n\t});\n\tgrid.$view.firstChild.addEventListener(\"mouseup\", (e)=>{\n\t\tconst dragEndColumn = e.target.parentNode.cellIndex + 1;\n\t\tif (dragStartColumn && dragStartColumn !== dragEndColumn) {\n\t\t\tcop.selectColumn(dragStartColumn, view, dragEndColumn);\n\t\t\tdragStartColumn = undefined;\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onEnter\", function(ev){\n\t\tif (grid.getEditor()){\n\t\t\twebix.delay(function(){\n\t\t\t\tgrid.moveSelection(\"down\");\n\t\t\t});\n\t\t}\n\t\tev.preventDefault();\n\t});\n\n\t//prevent editing of locked cells\n\tview.attachEvent(\"onBeforeEditStart\", (row, column) => !view.isCellLocked(row, column));\n\tgrid.attachEvent(\"onBeforeEditStart\", (editor) => \n\t\tview.callEvent(\"onBeforeEditStart\", [editor.row, editor.column]) );\n\n\t//column and row selection\n\tgrid.attachEvent(\"onBeforeSelect\", (id) => id.column != \"rowId\" );\n\tgrid.attachEvent(\"onBeforeBlockSelect\", (start, end, finalStep) => {\n\t\tif (finalStep &&\n\t\t(start.column !== \"rowId\" || end.column !== \"rowId\")) {\n\t\t\tif (start.column === \"rowId\") start.column = 1;\n\t\t\tif (end.column === \"rowId\") end.column = 1;\n\t\t}\n\t\tif(start.column !== \"rowId\" || end.column !== \"rowId\"){\n\t\t\tcop.highlightColRow(start,end, view);\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t});\n\tgrid.attachEvent(\"onSelectChange\", () => {\n\t\tlet ids = grid.getSelectedId(true);\n\t\tif(ids.length){\n\t\t\tlet start = ids[0];\n\t\t\tlet end = ids[ids.length-1]?ids[ids.length-1]:ids[0];\n\t\t\tcop.highlightColRow(start, end, view);\n\t\t} else {\n\t\t\tlet data = {row:0, column:0};\n\t\t\tcop.highlightColRow(data, data, view);\n\t\t}\n\t});\n\n\tgrid.attachEvent(\"onItemDblClick\", (id) => {\n\t\tif (id.column === \"rowId\")\n\t\t\tcop.adjustRow(id.row, view);\n\t});\n\n\tlet lastHeaderClick = 0;\n\tgrid.attachEvent(\"onHeaderClick\", (id, e) => {\n\t\tif(id.column == \"rowId\"){\n\t\t\tcop.selectAll(view);\n\t\t\treturn;\n\t\t}\n\t\tlet headerClick = new Date();\n\t\tlet dblClick = (headerClick - lastHeaderClick <= 300);\n\n\t\tif (dblClick) {\n\t\t\tcop.adjustColumn(id.column, view);\n\t\t} else {\n\t\t\tlastHeaderClick = headerClick;\n\t\t\tif (e.shiftKey) {\n\t\t\t\tcop.selectColumns(id.column, view);\n\t\t\t} else {\n\t\t\t\tcop.selectColumn(id.column, view);\n\t\t\t}\n\t\t}\n\t});\n\n\t//select rows by shift click\n\tvar lastClickedRow = null;\n\tgrid.attachEvent(\"onItemClick\", (cell, e) => {\n\t\tif (cell.column === \"rowId\") {\n\t\t\tif (!e.shiftKey)\n\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\telse {\n\t\t\t\tif (!lastClickedRow)\n\t\t\t\t\tcop.selectRow(cell.row, view);\n\t\t\t\telse\n\t\t\t\t\tcop.selectRow(lastClickedRow, view, cell.row);\n\t\t\t}\n\t\t\tlastClickedRow = cell.row;\n\t\t}\n\t});\n\n\t//reset API\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\tview.attachEvent(\"onBeforeSheetShow\", () => grid.editStop());\n\n\tgrid.attachEvent(\"onBlur\", function(){\n\t\t//after focus moved out, check and if it is somewhere\n\t\t//on the spreadsheet controls them move focus back to datatable\n\t\twebix.delay(function(){\n\t\t\tvar target = document.activeElement;\n\n\t\t\tif (target && target.isContentEditable) return;\n\n\t\t\tvar focus = webix.UIManager.getFocus();\n\t\t\tvar need_focus = focus &&\n\t\t\t\tfocus != grid &&\n\t\t\t\tfocus.getTopParentView &&\n\t\t\t\tfocus.getTopParentView() === view;\n\t\t\t\t\n\t\t\tif (need_focus)\n\t\t\t\twebix.UIManager.setFocus(grid);\n\n\t\t}, this, [], 100);\n\t});\n\n\tsetDefaultCss(view);\n}\n\nfunction cell_template(view, obj, common, value, column){\n\tvar format = obj.$cellFormat ? obj.$cellFormat[column.id] : null;\n\n\tvar commented = view.comments.get(obj.id, column.id) ? \"<div class='ssheet_commented_sign'></div>\" : \"\";\n\n\tif (format){\n\t\tvar cell = { css:\"\" };\n\t\tvar helper = fmt.getFormat(format);\n\t\tif (helper){\n\t\t\tlet parsed = parseFloat(value);\n\t\t\tif (!isNaN(parsed)){\n\t\t\t\tvar newvalue = helper(parsed, cell);\n\t\t\t\tif (cell.css)\n\t\t\t\t\treturn \"<div class='\"+cell.css+\"'>\"+newvalue+\"</div>\"+commented; \n\t\t\t\treturn newvalue+commented;\n\t\t\t}\n\t\t}\n\t}\n\tif(webix.isUndefined(value) || value === null)\n\t\tvalue = \"\";\n\treturn value+commented;\n}\n\nexport function reset(view){\n\tvar grid = view.$$(\"cells\");\n\tgrid.clearAll();\n\n\tvar columns = view.config.columnCount;\n\tvar rows = view.config.rowCount;\n\n\tvar cols = [{\n\t\tid:\"rowId\", header:\"\", width:40,\n\t\tcss:\"sheet_column_0\",\n\t\ttemplate(el) {\n\t\t\treturn el.id;\n\t\t}\n\t}];\n\n\tfor (let i=1; i <= columns; i++) {\n\t\tcols.push({\n\t\t\tid:i,\n\t\t\teditor:\"text\",\n\t\t\theader: {\n\t\t\t\ttext: nms.encode[i],\n\t\t\t\tcss: view._hideColumn && view._hideColumn.indexOf(i+1) >= 0 ? \"webix_ssheet_hide_column\" : \"\"\n\t\t\t},\n\t\t\ttemplate:function(obj, common, value, column){\n\t\t\t\treturn cell_template(view, obj, common, value, column);\n\t\t\t}\n\t\t});\n\t\tview.callEvent(\"onColumnInit\",[cols[i]]);\n\t}\n\n\tgrid.refreshColumns(cols);\n\n\tif(view._hideColumn && view._hideColumn.length)\n\t\tview._hideColumn.map(id => grid.hideColumn(id));\n\n\n\tvar data = [];\n\tfor (let i=1; i<=rows; i++)\n\t\tdata.push({ id:i });\n\n\tgrid.parse(data);\n\n\tif(view._hideRow && view._hideRow.length) {\n\t\tgrid.filter(function(obj){\n\t\t\tif(view._hideRow.indexOf(obj.id) === -1) {\n\t\t\t\treturn true;\n\t\t\t}else {\n\t\t\t\tif(obj.id - 1 === 0){\n\t\t\t\t\tlet cell = view.$$(\"cells\").getColumnConfig(\"rowId\").header[0];\n\t\t\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\t\t\tview.$$(\"cells\").refreshColumns();\n\t\t\t\t}else {\n\t\t\t\t\tview.$$(\"cells\").addCellCss(obj.id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t}\n}\n\n// nowrap by default\nfunction setDefaultCss(view){\n\twebix.html.addStyle(\"#\"+view._table.$view.id+\".webix_dtable .webix_cell { white-space:nowrap;}\");\n}","import group from \"./operations/undo_group\";\nimport {selectAll} from \"./operations/column_operations\";\nimport {styleFormats} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tvar grid = view.$$(\"cells\");\n\n\tvar key = webix.env.isMac ? \"command\" : \"ctrl\";\n\twebix.UIManager.addHotKey(key+\"-a\", () => { if(!grid.getEditor()) selectAll(view); }, grid);\n\n\tif(!view.config.readonly){\n\t\twebix.UIManager.addHotKey(\"any\", (view, ev) => {\n\t\t\t//ignore shift key\n\t\t\tif ((ev.which || ev.keyCode)  == 16) return;\n\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tgrid.$anyKey = true;\n\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"enter\", (view) => {\n\t\t\tvar sel = view.getSelectedId(true);\n\t\t\tif (sel.length){\n\t\t\t\tif(view.config.liveEditor)\n\t\t\t\t\tgrid.callEvent(\"onBeforeLiveEditor\", [sel[0]]);\n\t\t\t\telse\n\t\t\t\t\tgrid.edit(sel[0]);\n\t\t\t}\n\t\t}, grid);\n\n\t\twebix.UIManager.addHotKey(\"backspace\", () => del(view), grid);\n\t\twebix.UIManager.addHotKey(\"delete\", () => del(view), grid);\n\n\t\tvar redo = webix.env.isMac ? \"command-shift-z\" : \"ctrl-y\";\n\t\twebix.UIManager.addHotKey(redo, () => view.redo(), grid);\n\t\twebix.UIManager.addHotKey(key+\"-z\", () => view.undo(), grid);\n\n\t\twebix.UIManager.addHotKey(key+\"-b\", () => styleHotKey(view, \"font-weight\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-i\", () => styleHotKey(view, \"font-style\"), grid);\n\t\twebix.UIManager.addHotKey(key+\"-u\", (v, e) => ctrlU(view, e), grid);\n\t\twebix.UIManager.addHotKey(key+\"-p\", (v, e) => ctrlP(view, e), grid);\n\t}\n}\n\nfunction del(view) {\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => view.setCellValue(cell.row,cell.column, \"\"));\n\t\tview.refresh();\n\t});\n}\n\nfunction ctrlU(view, e) {\n\tstyleHotKey(view, \"text-decoration\");\n\treturn webix.html.preventEvent(e);\n}\nfunction ctrlP(view, e) {\n\tview.callEvent(\"onCommand\",[{id: \"print\"}]);\n\treturn webix.html.preventEvent(e);\n}\n\nfunction styleHotKey(view, attr) { \n\tvar cell = view.getSelectedId();\n\tif(cell){\n\t\tvar style = view.getStyle(cell.row, cell.column);\n\n\t\tvar elementOn = styleFormats[attr];\n\t\tvar elementOff = \"normal\";\n\n\t\tvar state = (style && style.props[attr] === elementOn)? elementOff : elementOn;\n\t\tview.callEvent(\"onStyleSet\", [attr, state]);\n\t}\n}","function _to_number(v){\n\tif(v || v === 0){\n\t\tv = v*1;\n\t\tif(!isNaN(v)) return v;\n\t}\n\treturn false;\n}\n\nfunction _combine(data){\n\tvar arr = [];\n\tfor (var i = 0; i < data.length; i++){\n\t\tarr = arr.concat(data[i]);\n\t}\n\treturn arr;\n}\n\n\n/*Empty cells, logical values like TRUE, or text are ignored.*/\nexport function SUM(){\n\tvar sum = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false) sum+=v;\n\t}\n\treturn sum;\n}\n\n/*If a range or cell reference argument contains text, logical values, or empty cells, those values are ignored; \nhowever, cells with the value zero are included.*/\nexport function AVERAGE(){\n\tvar sum = 0, count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false){\n\t\t\tsum+=v; count++;\n\t\t}\n\t}\n\treturn sum/count;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are not counted. */\nexport function COUNT(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false)\n\t\t\tcount++;\n\t}\n\treturn count;\n}\n\n/*counts the number of cells that are not empty in a range, zero is excluded.*/\nexport function COUNTA(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(set[i] && set[i]*1 !==0 ) count++;\n\treturn count;\n}\n\n/*Counts empty cells in a specified range of cells. Cells with zero values are not counted.*/\nexport function COUNTBLANK(){\n\tvar count = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++)\n\t\tif(!set[i]*1) count++;\n\treturn count;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored.\nIf the arguments contain no numbers, MAX returns 0 (zero).*/\nexport function MAX(){\n\tvar max = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v>max || max ===\"\"))\n\t\t\tmax = v;\n\t}\n\treturn max || 0;\n}\n\n/*Empty cells, logical values, or text in the array or reference are ignored. \nIf the arguments contain no numbers, MIN returns 0.*/\nexport function MIN(){\n\tvar min = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif (v !== false && (v<min || min ===\"\"))\n\t\t\tmin = v;\n\t}\n\treturn min || 0;\n}\n\n/* Only numbers in the array or reference are multiplied. \nEmpty cells, logical values, and text in the array or reference are ignored.*/\nexport function PRODUCT(){\n\tvar product = \"\", set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tproduct = product===\"\"?v:product*v;\n\t}\n\treturn product;\n}\n\n/* For valid products only numbers are multiplied. Empty cells, logical values, and text are ignored.\nTreats array entries that are not numeric as if they were zeros.*/\nexport function SUMPRODUCT(sets){\n\tvar length = sets[0].length;\n\tfor(let i in sets)\n\t\tif(sets[i].length !== length)\n\t\t\treturn;\n\n\tvar sp = 0;\n\tfor (let i = 0; i < sets[0].length; i++){\n\t\tvar product = \"\";\n\t\tfor(var s in sets){\n\t\t\tvar v = _to_number(sets[s][i]);\n\t\t\tif(v !== false) product = product===\"\" ? v: product*v;\n\t\t\telse{ product = 0; break; }\n\t\t}\n\t\tif(!webix.isUndefined(product)) sp+=product;\n\t}\n\treturn sp;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function SUMSQ(){\n\tvar sq = 0, set = _combine(arguments);\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(typeof v ===\"number\")\n\t\t\tsq += Math.pow(v, 2);\n\t}\n\treturn sq;\n}\n\n/*Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function VARP(){\n\tvar set = _combine(arguments);\n\tvar count = this.COUNT(set);\n\tvar avg = this.AVERAGE(set);\n\t\n\tvar sum = 0;\n\tfor (var i = 0; i < set.length; i++){\n\t\tvar v = _to_number(set[i]);\n\t\tif(v !== false)\n\t\t\tsum += Math.pow(v - avg, 2);\n\t}\n\treturn sum/count;\n}\n\n/* Empty cells, logical values, text, or error values in the array or reference are ignored. */\nexport function STDEVP(){\n\tvar set = _combine(arguments);\n\treturn Math.sqrt(this.VARP(set));\n}\n\n/*real numbers*/\nexport function POWER(num, pow){\n\tvar n = _to_number(num), p = _to_number(pow);\n\tif(typeof n == \"number\" && typeof p ==\"number\")\n\t\treturn Math.pow(n, p);\n\t\n}\n\n/*real numbers*/\nexport function QUOTIENT(num, div){\n\tvar n = _to_number(num), d = _to_number(div);\n\tif(typeof n == \"number\" && typeof d ==\"number\")\n\t\treturn n/d;\n}\n\n/*Returns a positive square root.*/\nexport function SQRT(num){\n\tvar v = _to_number(num);\n\tif(v !== false && v>=0)\n\t\treturn Math.sqrt(v);\n}\n\nexport function ABS(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.abs(v);\n}\n\nexport function RAND(){\n\treturn Math.random();\n}\n\nexport function PI(){\n\treturn Math.PI;\n}\n\n/*Rounds a number down to the nearest integer*/\nexport function INT(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn Math.round(v);\n}\n\n/*rounds a number to a specified number of digits*/\nexport function ROUND(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn parseFloat(v.toFixed(d));\n}\n\n/*rounds a number down to a specified number of digits*/\nexport function ROUNDDOWN(num, digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn  Math.floor(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*rounds a number up to a specified number of digits*/\nexport function ROUNDUP(num,digits){\n\tvar v = _to_number(num);\n\tvar d = _to_number(digits) || 0;\n\tif(v !== false)\n\t\treturn Math.ceil(v*Math.pow(10, d))/Math.pow(10,d);\n}\n\n/*Truncates a number to an integer by removing the fractional part of the number.*/\nexport function TRUNC(num){\n\tvar v = _to_number(num);\n\tif(v !== false)\n\t\treturn parseInt(v);\n}\n\n/*Returns number rounded up to the nearest even integer*/\nexport function EVEN(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r+1:r;\n\t}\n}\n\n/*Returns number rounded up to the nearest odd integer*/\nexport function ODD(num){\n\tvar v = _to_number(num);\n\tif(v !== false){\n\t\tvar r = Math.round(v);\n\t\treturn r%2?r:r+1;\n\t}\n}","export function CONCATENATE(){\n\tvar data = Array.prototype.slice.call(arguments);\n\tdata = data.map(function(obj){\n\t\tif (typeof obj === \"object\")\n\t\t\treturn obj.join(\"\");\n\t\treturn obj;\n\t});\n\treturn data.join(\"\");\n}\n \nexport function LEFT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(0, count);\n}\n\nexport function MID(text, start, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(start, start + count);\n}\n\nexport function RIGHT(text, count) {\n\tif (!text) { return \"\"; }\n\treturn text.substring(text.length - count);\n}\n\nexport function LOWER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toLowerCase();\n}\n\nexport function UPPER(text) {\n\tif (!text) { return \"\"; }\n\treturn text.toUpperCase();\n}\n\nexport function PROPER(text) {\n\tif (!text) { return \"\"; }\n\tvar temp = text.toLowerCase().split(\" \");\n\ttext = \"\";\n\tfor (var idx in temp) {\n\t\ttext += (text ? \" \" : \"\") + temp[idx].substring(0, 1).toUpperCase() + temp[idx].substring(1);\n\t}\n\treturn text;\n}\n\nexport function TRIM(text) {\n\tif (!text) { return \"\"; }\n\treturn text.trim();\n}\n\nexport function LEN(text) {\n\tif (!text && text !== 0) { return 0; }\n\treturn text.toString().length;\n}","export function IMAGE(url){\n\treturn `<img class=\"webix_ssheet_cimage\" src=\"${webix.template.escape(url)}\">`;\n}\n\nexport function SPARKLINE(arr, type, color1, color2){\n\tvar i, config = { type: type, color: color1, negativeColor:color2  },\n\t\twidth =  type == \"pie\"? 60: 150;\n\tfor(i =0 ; i < arr.length; i++)\n\t\tarr[i] = arr[i]||0;\n\treturn webix.Sparklines.getTemplate(config)(arr, { width:width, height: 35 });\n}\n\nexport function LINK(url, text){\n\ttext = text || url;\n\treturn `<a target=\"blank\" href=\"${webix.template.escape(url)}\">${webix.template.escape(text)}</a>`;\n}\n\nexport function IF(check, pos, neg){\n\tif (check)\n\t\treturn pos;\n\telse\n\t\treturn neg;\t\n}","import * as numbers from \"./methods/numbers\";\nimport * as strings from \"./methods/strings\";\nimport * as other from \"./methods/other\";\n\nexport const methods = {};\n\nwebix.extend(methods, numbers);\nwebix.extend(methods, strings);\nwebix.extend(methods, other);\n\nexport function addMethod(name, handler){\n\tmethods[name] = handler;\n}","import * as methods from \"./math/methods\";\n\nlet methodsName = [];\nfor(let i in methods.methods)\n\tif( i!=\"__esModule\") methodsName.push(i);\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\treturn {\n\t\tview:\"toolbar\",\n\t\tcss:\"webix_ssheet_toolbar\",\n\t\telements:[\n\t\t\t{ view:\"label\", label:\"Edit: \", width:60},\n\t\t\t{\n\t\t\t\tview:\"live-editor\",\n\t\t\t\tdisabled:true,\n\t\t\t\tid:\"liveEditor\", \n\t\t\t\tsuggestData: methodsName\n\t\t\t}\n\t\t]\n\t};\n}\n\nfunction ready(view){\n\tvar editor = view.$$(\"liveEditor\");\n\n\t//block native editor, and move focus to the custom input\n\t//edit by key press\n\tview._table.attachEvent(\"onBeforeEditStart\", function(cell){\n\t\tlet mode = view._table.$anyKey;\n\t\tview._table.$anyKey = false;\n\n\t\treturn startEdit(this, cell, mode);\n\t});\n\t//edit by enter key\n\tview._table.attachEvent(\"onBeforeLiveEditor\", function(cell){\n\t\tstartEdit(this, cell, false);\n\t});\n\t//edit by dbl-click\n\tview._table.attachEvent(\"onItemDblClick\", function(){\n\t\twebix.delay(()=>{\n\t\t\teditor.focus();\n\t\t});\n\t});\n\n\tview.attachEvent(\"onCellChange\", (r,c,v) => {\n\t\tvar cell = editor.config.activeCell;\n\t\tif (cell && cell.row == r && cell.column == c)\n\t\t\teditor.setValue(v);\n\t});\n\n\tview.attachEvent(\"onAfterSelect\", (data) => {\n\t\tif (!view.$handleSelection){\n\t\t\tlet cell = data[0];\n\t\t\tfillEditor(view._table, cell);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onBeforeSheetShow\", (name)=> {\n\t\tconst cell = editor.config.activeCell;\n\t\tif(cell){\n\t\t\tconst val = editor.getValue();\n\t\t\tif(view.getCellValue(cell.row, cell.column) != val){\n\t\t\t\tif(!editor._activeMath)\n\t\t\t\t\teditor._activeMath = view.getActiveSheet();\n\n\t\t\t\twebix.delay(()=>{\n\t\t\t\t\tif(name == editor._activeMath){\n\t\t\t\t\t\tview.$handleSelection = null;\n\t\t\t\t\t\tconst cell = editor.config.activeCell;\n\t\t\t\t\t\tview._table.select(cell.row, cell.column);\n\t\t\t\t\t}\n\n\t\t\t\t\teditor.setValue(val);\n\t\t\t\t\teditor.setCursor(editor._cursor);\n\t\t\t\t\teditor.paintValue();\n\n\t\t\t\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(view, st, en, a); };\n\t\t\t\t});\n\t\t\t}\n\t\t\telse{\n\t\t\t\teditor.define({activeCell:null});\n\t\t\t\teditor.setValue(\"\");\n\t\t\t\teditor.disable();\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onReset\", () => view.$handleSelection = null);\n\n\tview.attachEvent(\"onAction\", function(name, options){\n\t\tif(name == \"lock\" || name == \"filter\" || name == \"dropdown\")\n\t\t\tdisableEditor(options.row,  options.column);\n\t});\n\n\tfunction startEdit(table, cell, clear){\n\t\tvar cellEditor = table.getColumnConfig(cell.column).editor;\n\t\t//do not interfere with custom editors\n\t\tif (cellEditor == \"text\"){\n\t\t\tfillEditor(table, cell, clear);\n\t\t\teditor.focus();\n\t\t\twebix.delay(()=>{\n\t\t\t\teditor._cursor = editor.getCursor();\n\t\t\t});\n\t\t\treturn false;\n\t\t}\n\t\treturn true;\n\t}\n\n\tfunction disableEditor(row,column){\n\t\tif (view.getCellEditor(row, column) || view.isCellLocked(row,column)){\n\t\t\teditor.setValue(\"\");\n\t\t\teditor.disable();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tfunction fillEditor(table, cell, clear){\n\t\tif(disableEditor(cell.row, cell.column))\n\t\t\treturn;\n\t\teditor.enable();\n\t\teditor.config.activeCell = cell;\n\t\teditor.setValue( clear ? \"\" : view.getCellValue(cell.row, cell.column) );\n\n\t\tview.$handleSelection = function(a,b,st,en){ return pasteRange(table, st, en, a); };\n\t}\n\n\tfunction pasteRange(view, st, en, cell){\n\t\tlet sheet = \"\";\n\t\tif(editor._activeMath){\n\t\t\tconst activeSheet = view.getActiveSheet();\n\t\t\tif(editor._activeMath != activeSheet)\n\t\t\t\tsheet = activeSheet+\"!\";\n\t\t}\n\n\t\tconst range = st == en ? sheet+st : `${sheet+st}:${sheet+en}`;\n\t\tconst updateRange = editor._update_range;\n\n\t\tif(updateRange && updateRange.pos == editor._cursor - updateRange.len)\n\t\t\teditor.setRange(range, true);\n\t\telse if(editor.expectOperator())\n\t\t\teditor.setRange(range);\n\t\telse\n\t\t\treturn endEdit(cell);\n\n\t\twebix.delay(() => editor.focus());\n\n\t\treturn false;\n\t}\n\n\tfunction endEdit(st){\n\t\tif (editor.isEnabled()){\n\t\t\teditor.showActiveSheet();\n\t\t\teditor.updateCellValue();\n\t\t\teditor.setValue(st ? view.getCellValue(st.row, st.column) : \"\");\n\t\t}\n\t\treturn true;\n\t}\n\n}","export function find(arr, func){\n\tvar result = findIndex(arr, func);\n\treturn arr[result];\n}\n\nexport function findIndex(arr, func){\n\tvar result = -1;\n\tfor(var i =0; result<0 && i < arr.length; i++){\n\t\tif(func(arr[i]))\n\t\t\tresult = i;\n\t}\n\treturn result;\n}\n\nexport function getDimension(data, rows, cols){\n\t//var [ row, column, value, style] = obj.data[i];\n\tfor (var i=0; i<data.length; i++){\n\t\tlet line = data[i];\n\t\tif (line[0]>rows) rows=line[0];\n\t\tif (line[1]>cols) cols=line[1];\n\t}\n\treturn [rows*1, cols*1];\n}","import * as arr from \"./helpers/array\";\n\nconst options = [\n\t\"rename-sheet\",\n\t\"remove-sheet\"\n];\n\nconst actionMap = {\n\t\"remove-sheet\": function(view){\n\t\tview.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"sheet-remove-confirm\"],\n\t\t\tcallback:(res) => {\n\t\t\t\tif (res)\n\t\t\t\t\tremove(view, view._activeSheet);\n\t\t\t}\n\t\t});\n\t},\n\t\"rename-sheet\": function(view){\n\t\tedit(view, view._activeSheet);\n\t},\n\t\"new-sheet\": function(view){\n\t\tadd(view);\n\t},\n\t\"copy-sheet\": function(view){\n\t\tcopy(view);\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n}\n\nexport function defaultBottom(view){\n\tvar readonly = view.config.readonly;\n\tvar tabWidth = view.config.sheetTabWidth;\n\tvar toolbar =  {\n\t\tview: \"toolbar\",\n\t\tid: \"bottom-toolbar\",\n\t\tcss: \"webix_ssheet_bottom_toolbar webix_layout_toolbar\",\n\t\tpaddingY: 0,\n\t\theight: 34,\n\t\telements:[\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"add-sheet\",\n\t\t\t\tlabel: \"<span class='webix_ssheet_icon_add_sheet'></span>\",\n\t\t\t\ttooltip: webix.i18n.spreadsheet.tooltips[\"add-sheet\"]||\"\", hidden:readonly\n\t\t\t},\n\t\t\t{\n\t\t\t\tid:\"sheets\",\n\t\t\t\tview:\"sheets\",\n\t\t\t\twidth: 5 * tabWidth,\n\t\t\t\teditable:!readonly,\n\t\t\t\teditaction: \"dblclick\",\n\t\t\t\teditor:\"text\",\n\t\t\t\teditValue:\"value\",\n\t\t\t\ttype:{\n\t\t\t\t\twidth: tabWidth,\n\t\t\t\t\theight: 32,\n\t\t\t\t\ttemplate: function(obj){\n\t\t\t\t\t\treturn \"<div>\"+obj.value+\"</div>\"+\n\t\t\t\t\t\t\t(!readonly?\"<div class='webix_input_icon wxi-menu-down webix_ssheet_sheet_arrow'></div>\":\"\");\n\t\t\t\t\t},\n\t\t\t\t\t//remove skin selection css on dnd\n\t\t\t\t\tcss:\"ssheet_order_sheets\"\n\t\t\t\t},\n\t\t\t\tonClick:{\n\t\t\t\t\twebix_ssheet_sheet_arrow: function(e, id){\n\t\t\t\t\t\tinitSheetMenu(view, e, id);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ton:{\n\t\t\t\t\tonItemClick: function(id){\n\t\t\t\t\t\tif(id != view._activeSheet)\n\t\t\t\t\t\t\tview.showSheet(id);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"prev-sheet\", disabled:true, hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-left'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, -1);}\n\t\t\t},\n\t\t\t{\n\t\t\t\tview: \"button\", type:\"htmlbutton\", width: 34, id: \"next-sheet\", hidden:true,\n\t\t\t\tlabel: \"<span class='webix_icon wxi-menu-right'></span>\", batch:\"pager\",\n\t\t\t\tclick:function(){scrollSheets(view, 1);}\n\t\t\t}\n\t\t]\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"bottom-toolbar\", toolbar]);\n\n\treturn toolbar;\n}\n\nfunction scrollSheets(view, direction){\n\tvar sheets = view.$$(\"sheets\");\n\tsheets.scrollTo(sheets.getScrollState().x+(direction*view.config.sheetTabWidth), 0);\n}\n\nfunction menuInit(view){\n\tvar data = [];\n\tfor(var i=0; i < options.length;i++)\n\t\tdata.push({id: options[i], value:webix.i18n.spreadsheet.menus[options[i]]||options[i]});\n\n\tvar menu =  {\n\t\tview: \"ssheet-suggest\",\n\t\tdata: data\n\t};\n\tview.callEvent(\"onViewInit\", [\"sheet-menu\", menu]);\n\treturn menu;\n}\n\nexport function reset(view, obj){\n\tlet tabs = view.$$(\"sheets\");\n\tif (tabs){\n\t\ttabs.clearAll();\n\t\tlet set = [];\n\t\tobj.sheets.forEach(function(sheet){\n\t\t\tset.push({id:sheet.name, value: sheet.name});\n\t\t});\n\t\ttabs.parse(set);\n\t}\n}\n\nfunction ready(view){\n\tprepare(view);\n\n\tif(view.$$(\"add-sheet\"))\n\t\tview.$$(\"add-sheet\").attachEvent(\"onItemClick\", function(){\n\t\t\tadd(view);\n\t\t});\n\n\tview.attachEvent(\"onAfterSheetShow\", (name) => selectSheet(view,name));\n\n\tview.attachEvent(\"onCommand\", function(command){\n\t\tif(actionMap[command.id])\n\t\t\tactionMap[command.id](this);\n\t});\n\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").data.attachEvent(\"onStoreUpdated\", () => changePagerVisability(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterScroll\", () => changePagerStatus(view));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterDrop\", (context) => dataOrder(view,context.start,context.index));\n\t\tview.$$(\"sheets\").attachEvent(\"onAfterEditStop\", (state) => rename(view,state.old,state.value));\n\t}\n}\n\nfunction initSheetMenu(view, e, id){\n\tif(!view.$sheetMenu){\n\t\tview.$sheetMenu = webix.ui(menuInit(view));\n\t\tview.$sheetMenu.attachEvent(\"onItemClick\", (id)=> callAction(view,id));\n\t}\n\n\tif(view.$sheetMenu.getItem(\"remove-sheet\"))\n\t\tif(view.$$(\"sheets\").count() == 1)\n\t\t\tview.$sheetMenu.disableItem(\"remove-sheet\");\n\t\telse\n\t\t\tview.$sheetMenu.enableItem(\"remove-sheet\");\n\tif(view.callEvent(\"onBeforeSheetMenu\", [id])){\n\t\tview.$sheetMenu.show(e);\n\t}\n}\n\nfunction changePagerStatus(view){\n\tconst sheets = view.$$(\"sheets\");\n\tconst scrollPos = sheets.getScrollState().x;\n\n\tif(scrollPos == 0){\n\t\tview.$$(\"prev-sheet\").disable();\n\t}\n\telse{\n\t\tview.$$(\"prev-sheet\").enable();\n\t\tvar tabWidth = view.config.sheetTabWidth;\n\t\tif(scrollPos == (sheets.count()-(sheets.config.width/tabWidth))*tabWidth){\n\t\t\tview.$$(\"next-sheet\").disable();\n\t\t\treturn;\n\t\t}\n\t}\n\tview.$$(\"next-sheet\").enable();\n}\n\nfunction changePagerVisability(view){\n\tvar toolbar = view.$$(\"bottom-toolbar\");\n\tvar sheets = view.$$(\"sheets\");\n\n\tif(sheets.count() <= (sheets.config.width/view.config.sheetTabWidth))\n\t\ttoolbar.showBatch(\"pager\", false);\n\telse\n\t\ttoolbar.showBatch(\"pager\");\n}\n\nfunction dataOrder(view, name, num){\n\tfor (let id in view._sheets) {\n\t\tif (view._sheets[id].name == name) {\n\t\t\tconst item = view._sheets.splice(id, 1);\n\t\t\tview._sheets.splice(num, 0, item[0]);\n\t\t\tbreak;\n\t\t}\n\t}\n}\n\nexport function add(view, content){\n\tvar index, name, newIndex;\n\n\tindex = arr.findIndex(view._sheets, x => x.name == view._activeSheet);\n\tnewIndex = index>-1?index+1:view._sheets.length;\n\tname = getNewTitle(view);\n\tcontent = content || {data:[]};\n\tview._sheets.splice(newIndex, 0, {\n\t\tname: name,\n\t\tcontent: content\n\t});\n\tview.$$(\"sheets\").add({id: name, value: name},newIndex);\n\tview.showSheet(name);\n\tview.callEvent(\"onSheetAdd\", [name]);\n\treturn name;\n}\n\nfunction getNewTitle(view){\n\tvar index = view._sheets.length+1;\n\twhile(getSheet(view, (webix.i18n.spreadsheet.labels.sheet+index)))\n\t\tindex++;\n\tvar name = webix.i18n.spreadsheet.labels.sheet+index;\n\treturn name;\n}\n\nfunction selectSheet(view,name){\n\tif(view.$$(\"sheets\")){\n\t\tview.$$(\"sheets\").select(name);\n\t\tview.$$(\"sheets\").showItem(name);\n\t}\n}\n\nexport function edit(view,name){\n\tview.$$(\"sheets\").edit(name);\n}\n\nexport function remove(view,name){\n\tvar index, newSheet;\n\tif(view._sheets.length >1){\n\t\tindex = arr.findIndex(view._sheets,x => x.name == name);\n\t\tview._sheets.splice(index,1);\n\t\tif(!view._sheets[index])\n\t\t\tindex = 0;\n\t\tnewSheet = \tview._sheets[index];\n\t\tview._activeSheet = null;\n\t\tif(view.$$(\"sheets\")){\n\t\t\tview.$$(\"sheets\").remove(name);\n\t\t\tview.$$(\"sheets\").refresh();\n\t\t}\n\t\tview.showSheet(newSheet.name);\n\t\tview.callEvent(\"onSheetRemove\", [name]);\n\t}\n}\n\nexport function rename(view,name,newName){\n\tif (name == newName) return;\n\n\t//correct sheet name\n\tvar i = 1;\n\twhile (!newName || getSheet(view, newName)){\n\t\tnewName = webix.i18n.spreadsheet.labels.sheet + i;\n\t\ti++;\n\t}\n\tnewName = newName.replace(/[*?:[\\]\\\\/]/g,\"\").substring(0, 31);\n\n\tvar sheet = getSheet(view, name);\n\tvar sheets = view.$$(\"sheets\");\n\n\tsheet.name = newName;\n\tif(view._activeSheet == name)\n\t\tview._activeSheet = newName;\n\n\tif(sheets){\n\t\tlet item = sheets.getItem(name);\n\t\titem.value = newName;\n\t\tsheets.data.changeId(name,newName);\n\t\tsheets.refresh(newName);\n\t}\n\n\tview.callEvent(\"onSheetRename\", [name, newName]);\n}\n\nexport function serialize(view, obj){\n\tgetSheet(view, view._activeSheet).content = obj;\n\treturn view._sheets;\n}\n\nexport function load(view, obj){\n\tobj = webix.isArray(obj)?{sheets:obj}:obj;\n\t\n\tif((obj.excel || !obj.sheets) && view._activeSheet){\n\t\t//loading into active sheet\n\t\tvar name = view._activeSheet;\n\t\tgetSheet(view, name).content = obj;\n\t\trefresh(view, obj);\n\t} else {\n\t\t//creating new set of sheets\n\t\tprepare(view, obj);\n\t}\n}\n\nexport function prepare(view, obj){\n\tif(!obj) obj = {data:[]}; \n\tif(!obj.sheets)\n\t\tobj = newSheet(obj);\n\t\n\tvar name = obj.sheets[0].name;\n\tview._activeSheet = \"\";\n\tview._sheets = obj.sheets;\n\treset(view, obj);\n\tshow(view, name);\n}\n\nexport function newSheet(obj){\n\treturn {\n\t\tsheets:[{\n\t\t\tname: webix.i18n.spreadsheet.labels.sheet + 1,\n\t\t\tcontent: obj\n\t\t}]\n\t};\n}\n\nexport function show(view,name){\n\tif (name == view._activeSheet) return;\n\n\tif(view.callEvent(\"onBeforeSheetShow\", [name])){\n\t\tif (view._activeSheet)\n\t\t\tgetSheet(view, view._activeSheet).content = view.serialize();\n\n\t\tview._activeSheet = name;\n\t\tvar obj = getSheet(view, name).content;\n\t\trefresh(view, obj);\n\n\t\tview.callEvent(\"onAfterSheetShow\", [name]);\n\t}\n}\n\nexport function getSheet(view, name){\n\treturn arr.find(view._sheets, x => x.name == name);\n}\n\nexport function eachSheet(view, callback){\n\tfor (var i=0; i<view._sheets.length; i++)\n\t\tcallback(view._sheets[i].name);\n}\n\nexport function getActive(view){\n\treturn view._activeSheet;\n}\n\nfunction refresh(view, obj){\n\tlet [rows, cols] = arr.getDimension(obj.data, view.config.rowCount, view.config.columnCount);\n\tview.callEvent(\"onReset\", []);\n\tif (rows != view.config.rowCount || cols != view.config.columnCount){\n\t\tview.config.rowCount = rows;\n\t\tview.config.columnCount = cols;\n\t\tview._resetTable();\n\t}\n\n\tview._loading_data = true;\n\tview.callEvent(\"onDataParse\", [obj]);\n\tview._loading_data = false;\n\tview._table.refresh();\n\tif(view.config.bottombar)\n\t\tview.$$(\"sheets\").refresh();\n}\n\nfunction copy(view){\n\tadd(view, view.serialize());\n}\n\nfunction callAction(view, id){\n\tif(!view.$sheetMenu.data.getMark(id, \"webix_disabled\"))\n\t\tactionMap[id](view);\n}\n\n","import \"../views/formlate\";\n\nexport class Dialog{\n\tconstructor(view){\n\t\tthis.view = view;\n\t}\n\t$init(){}\n\t$show(){}\n\t$hide(){}\n\topen(){\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t}\n\t\t\t\n\t\tvar form = this.$dialog.getBody();\n\t\tthis.$dialog.show();\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\tclose(){\n\t\twebix.UIManager.setFocus(this.view);\n\t\tthis.$dialog.hide();\n\t}\n}","export function image(url){\n\treturn `=IMAGE(\"${url}\")`;\n}\n\nexport function chart(config){\n\tlet result = `=SPARKLINE(${config.range},\"${config.type}\"`;\n\tif (config.type === \"bar\")\n\t\tresult += `,\"${config.color}\",\"${config.negativeColor}\"`;\n\telse if(config.color)\n\t\tresult += `,\"${config.color}\"`;\n\treturn result+\")\";\n\n}\n\nexport function parseImage(value){\n\tif (value && value.indexOf(\"=IMAGE(\") === 0)\n\t\treturn {\n\t\t\turl: unescape(value.substr(7, value.length-8))\n\t\t};\n}\n\nexport function parseChart(value){\n\tif (value && value.indexOf(\"=SPARKLINE(\") === 0){\n\t\tlet text = value.substr(11, value.length-12).split(\",\");\n\t\treturn {\n\t\t\trange: text[0],\n\t\t\ttype: unescape(text[1]),\n\t\t\tcolor: unescape(text[2]),\n\t\t\tnegativeColor: unescape(text[3])\n\t\t};\n\t}\n}\n\nfunction unescape(text){\n\tif (!text) return \"\";\n\n\ttext = text.trim();\n\tif (text[0] === \"\\\"\") \n\t\ttext = text.substr(1);\n\tif (text[text.length-1] === \"\\\"\")\n\t\ttext = text.substr(0, text.length-1);\n\treturn text;\n}","import {Dialog} from \"./common\";\nimport {parseImage} from \"../math/writer\";\n\nexport const action = \"add-image\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tform.elements.preview.setHTML(\"\");\n\t\tform.elements.url.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseImage(value);\n\t\tif (data && data.url)\n\t\t\tform.elements.url.setValue(data.url);\n\t\n\t\tform.elements.url.focus();\n\t}\n\t$init(){\n\n\t\tvar save = this.view.config.save;\n\t\tvar server = (save && save.images) || null;\n\t\t\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"image-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"image-url\"], on:{\n\t\t\t\t\t\t\"onChange\": showPreview\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"label\", label:webix.i18n.spreadsheet.labels[\"image-or\"], align: \"center\"},\n\t\t\t\t\t{ view:\"uploader\", label:webix.i18n.spreadsheet.labels[\"image-upload\"], upload:server, on:{\n\t\t\t\t\t\t\"onBeforeFileAdd\": startLoad,\n\t\t\t\t\t\t\"onFileUpload\": endLoad\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless: true, css: \"webix_ssheet_preview\", template:\"\", height:50 }\n\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n\nfunction startLoad(file){ \n\tif (!this.config.upload){\n\t\tvar reader = new FileReader();\n\t\treader.onload = (e) => this.getFormView().elements.url.setValue(e.target.result);\n\t\treader.readAsDataURL(file.file);\n\t\treturn false;\n\t} else\n\t\tthis.getFormView().elements.preview.setHTML(\"\");\n}\n\nfunction endLoad(item, response){\n\tthis.getFormView().elements.url.setValue(response.imageURL);\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.cell;\n\tvar image = fillUrl(dialog.$dialog.getBody().elements.url.getValue());\n\tdialog.view.addImage(cell.row, cell.column, image);\n\tdialog.close();\n}\n\nfunction showPreview(image){\n\tif (image){\n\t\timage = webix.template.escape(fillUrl(image));\n\t\tthis.getFormView().elements.preview.setHTML(\"<img class='webix_ssheet_cimage' src='\"+image+\"'></img>\");\n\t}\n}\n\nfunction fillUrl(url){\n\tif (!/^[/]|((https?:\\/|data:image)\\/)/i.test(url))\n\t\turl = \"http://\" + url;\n\treturn url;\n}","import * as parser \t\t\tfrom \"./parser\";\n\n//convert math string to the js function\nlet actives = {};\nlet passives = {};\nexport function _parse(value, core, passive){\n\tvar struct = parser.parse(value, core, passive);\n\tvar cache = passive ? passives : actives;\n\tstruct.handler = cache[value] = cache[value] || _build_function(struct.code);\n\treturn struct;\n}\n\nexport function clearMathCache(){\n\tactives = {};\n\tpassives = {};\n}\n\nfunction error_function(){\n\treturn webix.i18n.spreadsheet.table[\"math-error\"];\n}\nfunction _build_function(value){\n\ttry{\n\t\treturn new Function(value);\n\t} catch(e){\n\t\treturn error_function;\n\t}\n}","import * as nms from \"../helpers/column_names\";\nimport {split} from \"../math/parser\";\n\nexport function updateMath(formula, action, area){\n\tvar stack = split(formula);\n\tvar max = stack.length;\n\tvar start = area ? area.start : null;\n\tvar end = area ? area.end : null;\n\tfor (var i = 1; i < max; i+=2) {\n\t\tvar [row, column, flags] = stack[i];\n\n\t\tconst isRowFix = flags & 1;\n\t\tconst isColumnFix = flags & 2;\n\n\t\t// for cut operations we need to check whether referenced values are inside cut block. if so - update them.\n\t\tif ((action.id === \"move\") && (!action.cut || (row >= start.row && row <= end.row && column >= start.column && column <= end.column))){\n\t\t\tcolumn += isColumnFix ? 0 : action.column;\n\t\t\trow += isRowFix ? 0 : action.row;\n\t\t} else if (action.id === \"row\" && action.start <= row){\n\t\t\trow += isRowFix ? 0 : action.count;\n\t\t} else if (action.id === \"column\" && action.start <= column){\n\t\t\tcolumn += isColumnFix ? 0 : action.count;\n\t\t}\n\n\t\tif (!column || !row)\n\t\t\tstack[i] = 0;\n\t\telse\n\t\t\tstack[i] = (isColumnFix?\"$\":\"\") + nms.encode[column] + (isRowFix?\"$\":\"\") + row;\n\t}\n\n\treturn stack.join(\"\");\n}\n\nexport function updateSheetNames(formula, oldName, newName, extra){\n\tvar stack = split(formula, true);\n\tfor(var i = 0; i < stack.length; i++){\n\t\tif(webix.isArray(stack[i])){\n\t\t\tvar thisSheet = stack[i][0] === oldName;\n\t\t\tif(!extra.multiSheet && thisSheet)\n\t\t\t\textra.multiSheet = true;\n\t\t\tvar sheet = thisSheet ? newName : stack[i][0];\n\t\t\tstack[i] = \"'\"+sheet+\"'!\"+stack[i][1];\n\t\t}\n\t}\n\treturn stack.join(\"\");\n}","//TODO\n// ### column deleting | adding\n// recalculate positions\n\n// ### copy paste between sheets\n// force sheet name\n\n// ### triggers\n// a <- p <- a\n// register triggers from passive sheet\n\n// ### sheet renaming\n// adjust math on sheet rename\n// adjust ranges on sheet rename\n\nimport {getActive, getSheet} from \"../sheets\";\nimport {range} from \"../helpers/column_names\";\nimport {clearMathCache} from \"./cache\";\nimport {updateSheetNames} from \"./updater\";\n\n\nexport function init(view, core, helpers){\n\tview.attachEvent(\"onBeforeSheetShow\", function(){\n\t\tdelete view._mathSheetCache[getActive(view)];\n\t});\n\tview.attachEvent(\"onSheetRename\", function(name, newName){\n\t\tview._sheets.forEach((sheet)=>{\n\t\t\tlet extra = {multiSheet:false};\n\t\t\tconst edit = [\"data\", \"editors\", \"conditions\", \"ranges\"];\n\t\t\tedit.forEach((param)=>{\n\t\t\t\tif(sheet.content[param])\n\t\t\t\t\tsheet.content[param].forEach((value)=>{\n\t\t\t\t\t\tswitch (param) {\n\t\t\t\t\t\t\tcase \"data\":\n\t\t\t\t\t\t\t\tif(value[2][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[2] = updateSheetNames(value[2], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"editors\":\n\t\t\t\t\t\t\t\tvalue[2].options = updateSheetNames(value[2].options, name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"conditions\":\n\t\t\t\t\t\t\t\tif(value[3][0] === \"=\")\n\t\t\t\t\t\t\t\t\tvalue[3] = updateSheetNames(value[3], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\tcase \"ranges\":\n\t\t\t\t\t\t\t\tvalue[1] = updateSheetNames(value[1], name, newName, extra);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t});\n\t\t\tif(extra.multiSheet === true){\n\t\t\t\tdelete view._mathSheetCache[sheet.name];\n\t\t\t\tgetAccessor(view, sheet.name);\n\t\t\t\tclearMathCache();\n\t\t\t}\n\t\t});\n\t\tdelete view._mathSheetCache[name];\n\t});\n\tview.attachEvent(\"onSheetRemove\", function(name){\n\t\tdelete view._mathSheetCache[name];\n\t});\n\n\tview._mathSheetCache = { };\n\tview._mathSheetCore = core;\n\tview._mathSheetHelpers = helpers;\n}\n\nexport function getAccessor(view, name){\n\t//actuve sheet accessor\n\tif (!name) \n\t\treturn SheetAccessor(activeAccessor(view));\n\n\t//passive sheet accessor\n\tif (!view._mathSheetCache[name]){\n\t\tlet temp = view._mathSheetCache[name] = (name === getActive(view)) ? \n\t\t\tSheetAccessor(activeAccessor(view)) :\n\t\t\tSheetAccessor(passiveAccessor(view, name));\n\t\ttemp.init();\n\n\t}\n\n\treturn view._mathSheetCache[name];\n}\n\nfunction SheetAccessor(helpers){\n\treturn {\n\t\tinit:function(){\n\t\t\thelpers.init();\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn helpers.getRangeCode(name);\n\t\t},\n\t\tgetValue(r,c){\n\t\t\tvar val = helpers.getCell(r,c);\n\t\t\tvar test = val*1;\n\t\t\tif (!isNaN(test)) return test;\n\t\t\treturn val?val:\"\";\n\t\t},\n\t\tgetRangeValue(name){\n\t\t\tvar code = this.getRangeCode(name) || name;\n\t\t\tif (code.indexOf(\":\") == -1) return [];\n\t\t\tvar pos = range(code);\n\t\t\treturn this.getRange.apply(this, pos);\n\t\t},\n\t\tgetRange(r1,c1,r2,c2){\n\t\t\tvar set = helpers.getRange(r1,c1,r2,c2);\n\t\t\tfor (var i = set.length-1; i>=0; i--){\n\t\t\t\tlet val = set[i];\n\t\t\t\tlet test = val !== \"\" ? val * 1 : \"\";\n\t\t\t\tset[i] = isNaN(test)?(val?val:\"\"):test;\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction activeAccessor(view){\n\treturn {\n\t\tinit:function(){\n\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn view.ranges.getCode(name);\n\t\t},\n\t\tgetRow:function(r){\n\t\t\treturn view.getRow(r);\n\t\t},\n\t\tgetCell:function(r,c){\n\t\t\treturn view.getRow(r)[c];\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++){\n\t\t\t\tvar item = view.getRow(i);\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(item[j]);\n\t\t\t}\n\t\t\treturn set;\n\t\t}\n\t};\n}\n\nfunction passiveAccessor(view, name){\n\tconst page = getSheet(view, name).content;\n\tconst table = [];\n\tconst formulas = [];\n\n\tconst ranges = [];\n\n\treturn {\n\t\tinit:function(){\n\t\t\tif (page.ranges){\n\t\t\t\tfor (var i = 0; i < page.ranges.length; i++) {\n\t\t\t\t\tvar line = page.ranges[i];\n\t\t\t\t\tranges[line[0]] = line[1];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (page.data){\n\t\t\t\tfor (let i = 0; i < page.data.length; i++) {\n\t\t\t\t\t//expand data structure\n\t\t\t\t\tlet [row, column, value] = page.data[i];\n\t\t\t\t\tif (!table[row])\n\t\t\t\t\t\ttable[row] = [];\n\t\t\t\t\ttable[row][column] = value;\n\n\t\t\t\t\tif (value[0] === \"=\"){\n\t\t\t\t\t\t//for math cells, store the code\n\t\t\t\t\t\tlet math = view._mathSheetHelpers.parse(value, view._mathSheetCore, name);\n\t\t\t\t\t\ttable[row][column] = math.handler;\n\n\t\t\t\t\t\t//store list of cross-sheet formulas\n\t\t\t\t\t\tfor (var j=0; j<math.triggers.length; j++){\n\t\t\t\t\t\t\tif (math.triggers[j][5]){\n\t\t\t\t\t\t\t\tformulas.push(page.data[i]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tgetRangeCode(name){\n\t\t\treturn ranges[name];\n\t\t},\n\t\tgetRow(i){\n\t\t\treturn table[i] || [];\n\t\t},\n\t\tgetCell(i, j){\n\t\t\tvar value = this.getRow(i)[j];\n\t\t\tif (typeof value === \"function\")\n\t\t\t\treturn view._mathSheetHelpers.execute(value, view._mathSheetCore);\n\n\t\t\treturn value;\n\t\t},\n\t\tgetRange:function(r1,c1,r2,c2){\n\t\t\tvar set = [];\n\t\t\tfor (var i = r1; i <= r2; i++)\n\t\t\t\tfor (var j = c1; j <= c2; j++)\n\t\t\t\t\tset.push(this.getCell(i,j));\n\t\t\treturn set;\n\t\t}\n\t};\n}","import {range} from \"../helpers/column_names\";\nimport {getAccessor} from \"./sheet\";\n\nexport function nullFilter(){ \n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn \"<span class='webix_ssheet_empty'>\"+locale[\"dropdown-empty\"]+\"</span>\";\n}\n\nexport function rangeValue(view, text, extra){\n\tvar vals;\n\tif (typeof text == \"string\"){\n\t\tvar pos = range(text, view);\n\t\tvar page = getAccessor(view, pos[4]);\n\t\tvals = page.getRange.apply(page, pos);\n\t} else {\n\t\tvals = webix.copy(text);\n\t}\n\n\tif (extra){\n\t\tif (extra.unique){\n\t\t\tlet t = {};\n\t\t\tfor (var i=vals.length-1; i>=0; i--){\n\t\t\t\tif (t[vals[i]])\n\t\t\t\t\tvals.splice(i,1);\n\t\t\t\telse\n\t\t\t\t\tt[vals[i]] = true;\n\t\t\t}\n\t\t}\n\t\tif (extra.order) vals.sort();\n\n\t\tvar empty = vals.indexOf(\"\");\n\t\tif (empty > -1){\n\t\t\tvals.splice(empty,1);\n\t\t\tif (extra.filter)\n\t\t\t\tvals.unshift(nullFilter());\n\t\t}\n\n\t\tif (extra.empty) vals.unshift({id: \"$empty\", $empty: true, value: \"\"});\n\t}\n\n\treturn vals;\n}\n\nexport class Ranges{\n\tconstructor(view){\n\t\tthis._master = view;\n\t\tthis._ranges = {};\n\t}\n\n\tclear(){\n\t\tthis._ranges = {};\n\t}\n\n\tadd(name, text){\n\t\tlet needUpdate = !!this._ranges[name];\n\n\t\tthis._master.callEvent(\"onAfterRangeSet\", [name, text]);\n\t\tthis._ranges[name] = text;\n\n\t\tif (needUpdate)\n\t\t\tthis._master.callEvent(\"onMathRefresh\", []);\n\t}\n\tgetCode(name, sheet){\n\t\tif (sheet)\n\t\t\treturn getAccessor(this._master, sheet).getRangeCode(name);\n\n\t\treturn this._ranges[name];\n\t}\n\tremove(name){\n\t\tdelete this._ranges[name];\n\t}\n\tgetRanges(){\n\t\tvar data = [];\n\t\tfor(var name in this._ranges)\n\t\t\tdata.push({ name, range:this._ranges[name] });\n\n\t\treturn data;\n\t}\n\n\tparse(data){\n\t\tif (!data) return;\n\n\t\tlet i = data.length;\n\t\twhile(i--){\n\t\t\tvar c = data[i];\n\t\t\tthis._ranges[c[0]] = c[1];\n\t\t}\n\t}\n\n\tserialize(){\n\t\tvar name, data = [];\n\t\tfor( name in this._ranges)\n\t\t\tdata.push([name,this._ranges[name]]);\n\t\treturn data;\n\t}\n}","import {Dialog} from \"./common\";\nimport {rangeValue} from \"../math/ranges\";\nimport {range} from \"../helpers/column_names\";\nimport {parseChart} from \"../math/writer\";\n\nexport const action = \"add-sparkline\";\n\nvar types = [\n\t{id:\"line\", value:\"Line\"},\n\t{id:\"spline\", value:\"Spline\"},\n\t{id:\"splineArea\", value:\"Spline Area\"},\n\t{id:\"area\", value:\"Area\"},\n\t{id:\"bar\", value:\"Bar\"},\n\t{id:\"pie\", value:\"Pie\"}\n];\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.cell = this.view.getSelectedId();\n\t\tif(!this.cell)\n\t\t\treturn false;\n\n\t\tvar els = form.elements;\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tels.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tels.range.setValue(\"\");\n\n\t\t//sync state of dialog to data with  the selected cell\n\t\tlet value = this.view.getCellValue(this.cell.row, this.cell.column);\n\t\tlet data = parseChart(value);\n\t\tif (data){\n\t\t\tform.blockEvent();\n\t\t\tels.type.setValue(data.type);\n\t\t\tels.range.setValue(data.range);\n\t\t\tif (data.color){\n\t\t\t\tels.color_def.setValue(data.color);\n\t\t\t\tels.color_pos.setValue(data.color);\t\t\n\t\t\t}\n\t\t\tif (data.negativeColor)\n\t\t\t\tels.color_neg.setValue(data.negativeColor);\n\t\t\tform.unblockEvent();\n\t\t\trenderPreview(this);\n\t\t}\t\n\n\t\tels.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"sparkline-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\", id: \"form\", visibleBatch:1, on:{ onChange : ()=> renderPreview(this) },  elements:[\n\t\t\t\t\t{view: \"richselect\", name:\"type\", label:webix.i18n.spreadsheet.labels[\"sparkline-type\"], value:\"line\", labelPosition:\"left\", suggest:{\n\t\t\t\t\t\tview:  \"ssheet-form-suggest\",\n\t\t\t\t\t\tdata:types\n\t\t\t\t\t}, on:{\n\t\t\t\t\t\t\"onChange\": typesChangeHandler\n\t\t\t\t\t}},\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"sparkline-range\"], name:\"range\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-color\"], name:\"color_def\", id:\"add_sparkline_color\", value:\"#6666FF\", batch:\"1\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-positive\"], name:\"color_pos\", value:\"#6666FF\", batch:\"2\"},\n\t\t\t\t\t{ view:\"ssheet-colorpicker\", label:webix.i18n.spreadsheet.labels[\"sparkline-negative\"], name:\"color_neg\", value:\"#FF6666\", batch:\"2\"},\n\t\t\t\t\t{ view:\"formlate\", name:\"preview\", borderless:true, css:\"webix_ssheet_preview\", height:50 }\n\t\t\t\t]\n\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tcheckRange(text){\n\t\tif(text && range(text, this.view))\n\t\t\treturn true;\n\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t}\n}\n\nfunction renderPreview(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar data = form.getValues();\n\n\tif (data.range && dialog.checkRange(data.range)){\n\t\tlet i,\n\t\t\tvalues = rangeValue(dialog.view, data.range),\n\t\t\tconfig = sparkConfig(form);\n\t\tfor(i =0 ; i < values.length; i++)\n\t\t\tvalues[i] = values[i]||0;\n\t\tform.elements.preview.setValue(webix.Sparklines.getTemplate(config)(values, { width:200, height: 40 }));\n\t}\n}\n\nfunction sparkConfig(form, config){\n\tvar data = form.getValues();\n\tconfig = config || { type: data.type  };\n\tif (data.type === \"bar\"){\n\t\tconfig.color = data.color_pos;\n\t\tconfig.negativeColor = data.color_neg;\n\t}\n\telse if(form.elements.color_def.isVisible())\n\t\tconfig.color = data.color_def;\n\n\treturn config;\n}\n\nfunction okClick(dialog){\n\tvar form = dialog.$dialog.getBody();\n\tvar config = sparkConfig(form, form.getValues());\n\tif (dialog.checkRange(config.range)){\n\t\tdialog.view.addSparkline(dialog.cell.row, dialog.cell.column, config);\n\t\tdialog.close();\n\t}\n}\n\n\n\n\nfunction typesChangeHandler(type){\n\tvar form = this.getFormView();\n\tswitch(type){\n\t\tcase \"pie\":\n\t\t\tform.showBatch(3);\n\t\t\tbreak;\n\t\tcase \"bar\":\n\t\t\tform.showBatch(2);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tform.showBatch(1);\n\t}\n}","import {Dialog} from \"./common\";\nimport {isRange, toSheetRange} from \"../helpers/column_names\";\n\nexport const action = \"add-range\";\n\nexport class DialogBox extends Dialog{\n\t$show(box){\n\t\tvar table = box.$$(\"table\");\n\t\tvar form = box.$$(\"form\");\n\t\tvar sheet = \"\";// this.view.getActiveSheet(); ranges are per-sheet by default\n\n\t\tform.clear();\n\t\tform.elements.name.focus();\n\t\tform.elements.range.setValue(this.view.getSelectedRange());\n\n\t\ttable.clearAll();\n\t\ttable.parse( this.view.ranges.getRanges() );\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(toSheetRange(a,b,sheet));\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tsaveClick(){\n\t\tvar form = this.$dialog.$$(\"form\");\n\t\tvar data = form.getValues();\n\n\t\tvar sheets = data.range.indexOf(\"!\");\n\t\tdata.range = data.range.substr(0, sheets+1)+data.range.substr(sheets+1).toUpperCase();\n\t\tdata.name = data.name.toUpperCase();\n\n\t\tform.setValues(data);\n\n\t\tif (form.validate()){\n\t\t\tlet table = this.$dialog.$$(\"table\");\n\n\t\t\tif (data.id && table.exists(data.id)){\t\t\t\t\n\t\t\t\tthis.view.ranges.remove(table.getItem(data.id).name);\n\t\t\t\ttable.updateItem(data.id, data);\n\t\t\t} else\n\t\t\t\tthis.$dialog.$$(\"table\").add(data);\n\n\t\t\tthis.view.ranges.add(data.name, data.range);\n\t\t\tform.clear();\n\t\t}\n\t}\n\tremoveRange(id){\n\t\tthis.view.confirm({\n\t\t\ttext: webix.i18n.spreadsheet.labels[\"range-remove-confirm\"],\n\t\t\tcallback:(res) => {\n\t\t\t\tif (res){\n\t\t\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\t\t\tthis.view.ranges.remove(table.getItem(id).name);\n\t\t\t\t\ttable.remove(id);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\teditRange(id){\n\t\tvar form = this.$dialog.$$(\"form\");\n\t\tform.setValues(this.$dialog.$$(\"table\").getItem(id));\n\t}\n\t$init(){\n\t\tvar theform = {\n\t\t\ttype: \"clean\",\n\t\t\tcols:[\n\t\t\t\t{ view: \"ssheet-dialog-table\", id: \"table\", borderless:true, columns:[\n\t\t\t\t\t{ id:\"name\", header:webix.i18n.spreadsheet.labels[\"range-name\"], width: 120 },\n\t\t\t\t\t{ id:\"range\", header:webix.i18n.spreadsheet.labels[\"range-cells\"], width: 120 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-pencil'></div>\", width:40 },\n\t\t\t\t\t{ template:\"<div class='webix_icon wxi-trash'></div>\", width:40 }\n\t\t\t\t],\n\t\t\t\tautowidth:true, height: 150,\n\t\t\t\tonClick:{\n\t\t\t\t\t\"wxi-trash\":(ev, id) => this.removeRange(id),\n\t\t\t\t\t\"wxi-pencil\":(ev, id) => this.editRange(id)\n\t\t\t\t}},\n\t\t\t\t{ width: 250, view: \"form\", id:\"form\",\n\t\t\t\t\trules:{\n\t\t\t\t\t\tname:(value) => { \n\t\t\t\t\t\t\tlet correct = /^[A-Za-z]+$/.test(value);\n\t\t\t\t\t\t\tlet table = this.$dialog.$$(\"table\");\n\t\t\t\t\t\t\tlet data = this.$dialog.$$(\"form\").getValues();\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\tlet unique = true;\n\t\t\t\t\t\t\ttable.eachRow(function(id){\n\t\t\t\t\t\t\t\tlet obj = this.getItem(id);\n\t\t\t\t\t\t\t\tif (obj.name == value && obj.id != data.id)\n\t\t\t\t\t\t\t\t\tunique = false; \n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\treturn correct && unique; \n\t\t\t\t\t\t},\n\t\t\t\t\t\trange:isRange\n\t\t\t\t\t},\n\t\t\t\t\telementsConfig:{\n\t\t\t\t\t\tlabelWidth: 70\n\t\t\t\t\t},\n\t\t\t\t\telements:[\n\t\t\t\t\t\t{ view: \"text\", name:\"name\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-name\"]},\n\t\t\t\t\t\t{ view: \"text\", name:\"range\", gravity:1, label: webix.i18n.spreadsheet.labels[\"range-cells\"]},\n\t\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t\t{},\n\t\t\t\t\t\t\t{ view:\"button\", value:\"Save\", click: () => this.saveClick() }\n\t\t\t\t\t\t]}\n\t\t\t\t\t]\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tmove:true,\n\t\t\thead: webix.i18n.spreadsheet.labels[\"range-title\"],\n\t\t\tbuttons: false,\n\t\t\tautoheight: true,\n\t\t\twidth: 610,\n\t\t\tposition: \"center\",\n\t\t\tbody: theform,\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.close(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\n","import {Dialog} from \"./common\";\nimport {range} from \"../helpers/column_names\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"add-dropdown\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tlet form = this.$dialog.$$(\"form\");\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tform.clear();\n\n\t\t//restore previosly selected range\n\t\tlet value = this.view.getCellEditor(this.cell[0].row, this.cell[0].column);\n\t\tif (value && value.options)\n\t\t\tform.elements.range.setValue(value.options);\n\n\t\tthis.view.$handleSelection = function(st, end, a, b){\n\t\t\tform.elements.range.setValue(a+\":\"+b);\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.range.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\thead:webix.i18n.spreadsheet.labels[\"dropdown-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tview:\"form\", id:\"form\", rows:[\n\t\t\t\t\t{ view:\"text\", label:webix.i18n.spreadsheet.labels[\"dropdown-range\"], name:\"range\" }\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tvar values = this.$dialog.$$(\"form\").elements.range.getValue();\n\n\t\tif (values){\n\t\t\tif(!range(values, this.view))\n\t\t\t\tthis.view.alert({text:webix.i18n.spreadsheet.labels[\"error-range\"]});\n\t\t\telse{\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tfor (var i = 0; i < this.cell.length; i++)\n\t\t\t\t\t\tthis.view.setCellEditor(this.cell[i].row, this.cell[i].column, { editor:\"richselect\", options:values});\n\t\t\t\t}, this);\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t\telse\n\t\t\tthis.close();\n\t}\n}","import {Dialog} from \"./common\";\nimport * as fmt from \"../operations/formats\";\nimport group from \"../operations/undo_group\";\n\nexport const action = \"custom\";\n\nexport class DialogBox extends Dialog{\n\t$show(){\n\t\tthis.form = this.$dialog.$$(\"form\");\n\t\tthis.list = this.$dialog.$$(\"list\");\n\t\tthis.preview = this.$dialog.$$(\"preview\");\n\n\t\tthis.cell = this.view.getSelectedId(true);\n\t\tif (!this.cell.length)\n\t\t\treturn false;\n\n\t\tthis.fillForm(this.view);\n\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\tconst docsLink = \"https://webix-guides.gitbook.io/spreadsheet-user-guide/formatting_numbers#custom-number-format\";\n\t\tconst delimiters = fmt.getDelimiters(\"int\");\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth:460,\n\t\t\thead: locale[\"format-title\"],\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tcols:[\n\t\t\t\t\t{ view:\"list\", id:\"list\", css:\"webix_ssheet_format_type\", width:120, scroll:false, data:this.getFormats(), select:true,\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonSelectChange: (id)=>{\n\t\t\t\t\t\t\t\tthis.updateForm();\n\t\t\t\t\t\t\t\tif(id[0] === \"custom\")\n\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"custom\");\n\t\t\t\t\t\t\t\telse{\n\t\t\t\t\t\t\t\t\tthis.form.showBatch(\"common\");\n\t\t\t\t\t\t\t\t\tthis.form.elements.separator.show();\n\t\t\t\t\t\t\t\t\tif(id[0] === \"percent\")\n\t\t\t\t\t\t\t\t\t\tthis.form.elements.separator.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"form\", id:\"form\", margin:15, height:270, paddingY:0, paddingX:20,\n\t\t\t\t\t\telements:[\n\t\t\t\t\t\t\t{ template: function(obj){\n\t\t\t\t\t\t\t\treturn \"<span class ='\"+obj.css+\"'>\"+obj.value+\"</span>\";\n\t\t\t\t\t\t\t}, css: \"webix_ssheet_format_preview\", autoheight: true, id: \"preview\", borderless:true},\n\t\t\t\t\t\t\t{ view:\"counter\", css:\"webix_ssheet_counter\", label:locale[\"decimal-places\"], name:\"zeros\", value:0, batch:\"common\" },\n\t\t\t\t\t\t\t{ view:\"checkbox\", label:locale[\"separator\"], name: \"separator\", batch:\"common\" },\n\t\t\t\t\t\t\t{ view:\"formlist\", label:locale[\"negative\"], name:\"negative\", batch:\"common\", css:\"webix_ssheet_format_negative\",\n\t\t\t\t\t\t\t\ttemplate: (obj)=>{\n\t\t\t\t\t\t\t\t\tif(this.list){\n\t\t\t\t\t\t\t\t\t\tlet format = this.getFormat(obj.id);\n\t\t\t\t\t\t\t\t\t\tformat = fmt.format2code(format.fmt, format.delimiters);\n\t\t\t\t\t\t\t\t\t\tlet style = {css:\"\"};\n\t\t\t\t\t\t\t\t\t\tlet value = format(-1234.56789, style);\n\n\t\t\t\t\t\t\t\t\t\treturn \"<span class='\"+style.css+\"'>\"+value+\"</span>\";\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata:[{id:1}, {id:2}, {id:3}]\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view:\"text\", label: locale[\"format-pattern\"], name:\"format\", labelPosition:\"top\", batch:\"custom\",\n\t\t\t\t\t\t\t\tplaceholder:\"[>100]0\"+delimiters.groupSign+\"000\"+delimiters.decimalSign+\"00;[>0]None\" },\n\t\t\t\t\t\t\t{ template: \"<a href='\"+docsLink+\"' target='_blank' class = 'docs'>\"+locale[\"format-docs\"]+\"</a>\",\n\t\t\t\t\t\t\t\tborderless:true, batch:\"custom\", id: \"docs\"}\n\t\t\t\t\t\t],\n\t\t\t\t\t\telementsConfig: {\n\t\t\t\t\t\t\tlabelWidth: 155\n\t\t\t\t\t\t},\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: () => this.updateForm()\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.closeWin()\n\t\t\t}\n\t\t};\n\t}\n\tokClick(){\n\t\tlet type = this.list.getSelectedId();\n\t\tlet values = (type == \"custom\")?{format:this.form.getValues().format}:this.form.getValues();\n\t\tvalues.type = type;\n\n\t\tgroup.set(()=>{\n\t\t\tfor (let i = 0; i < this.cell.length; i++)\n\t\t\t\tfmt.addFormat(this.view, this.cell[i].row, this.cell[i].column, values.format, values);\n\t\t});\n\n\t\tthis.view.$$(\"cells\").refresh();\n\t\tthis.closeWin();\n\t}\n\tcloseWin(){\n\t\tconst style = this.view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tconst name = style && style.props.format ? style.props.format : \"common\";\n\n\t\t//default format\n\t\tif(!fmt.isCustom(name))\n\t\t\tthis.view.$$(\"bar\").setValues({format:name}, true);\n\t\tthis.close();\n\t}\n\tgetFormat(negative){\n\t\tconst type = this.list.getSelectedId();\n\t\tlet values = this.form.getValues();\n\n\t\tvalues.negative = negative || values.negative;\n\t\tif(type !== \"custom\"){\n\t\t\tvalues = fmt.formToValues(type, values);\n\t\t\treturn {\n\t\t\t\tfmt: fmt.serializeFormat(values),\n\t\t\t\tdelimiters:fmt.getDelimiters(type)\n\t\t\t};\n\t\t}\n\t\telse\n\t\t\treturn {\n\t\t\t\tfmt: values.format,\n\t\t\t\tdelimiters: fmt.getDelimiters(type)\n\t\t\t};\n\t}\n\tfillForm(view){\n\t\tconst style = view.getStyle(this.cell[0].row, this.cell[0].column);\n\t\tlet values = { zeros:0, separator: 0, negative: 1, format: \"\"};\n\t\tlet type;\n\n\t\tlet name = style && style.props.format ? style.props.format : \"\";\n\n\t\tif(!name || name == -1)\n\t\t\ttype = name = \"price\";\n\t\telse\n\t\t\ttype = fmt.formatHelpers[name].values.type;\n\n\t\tvalues.format = fmt.getFormatSource(name);\n\t\tif(type !==\"custom\")\n\t\t\twebix.extend(values, fmt.formatHelpers[name].values, true);\n\n\t\tlet value = this.view.$$(\"cells\").getItem(this.cell[0].row)[this.cell[0].column];\n\t\tif(value === \"\" || isNaN(value))\n\t\t\tvalue = 1234.56789;\n\t\tthis.value = value;\n\n\t\tthis.form.setValues(values);\n\t\tthis.list.select(type);\n\t\tthis.updateForm();\n\t}\n\tupdateForm(){\n\t\tconst form = this.form.elements;\n\n\t\tconst format = this.getFormat();\n\t\tlet style = {css:\"\"};\n\t\tlet value = fmt.format2code(format.fmt, format.delimiters)(this.value*1, style);\n\t\t\n\t\t//preview values\n\t\tthis.preview.parse({value:value, css:style.css});\n\t\tform.negative.refresh();\n\t\t\n\t\t//set new format string\n\t\tform.format.setValue(format.fmt);\n\t}\n\tgetFormats(){\n\t\tconst locale = webix.i18n.spreadsheet.labels;\n\t\treturn [\n\t\t\t{id: \"price\", value: locale.currency},\n\t\t\t{id: \"int\", value: locale.number},\n\t\t\t{id: \"percent\", value: locale.percent},\n\t\t\t{id: \"custom\", value: locale[\"custom-format\"]}\n\t\t];\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"conditional-format\";\n\nconst condition = [\n\t{id: \">\",value: \">\" },\n\t{id: \"<\",value: \"<\"},\n\t{id: \"=\",value: \"=\"},\n\t{id: \"!=\",value: webix.i18n.spreadsheet.labels[\"conditional-not-equal\"]},\n\t{id: \"<>\",value: webix.i18n.spreadsheet.labels[\"conditional-between\"]}\n];\n\nfunction getConditionStyle(data){\n\treturn data.map(item => {\n\t\titem.id = item.css;\n\t\treturn item;\n\t});\n}\n\nexport class DialogBox extends Dialog{\n\t_getCondition() {\n\t\tlet view = this.view;\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tlet data = [];\n\n\t\tforms.forEach(form => {\n\t\t\tif (!form.getValues) return;\n\t\t\tlet values = form.getValues();\n\t\t\tlet item = [];\n\t\t\titem.push(values.condition);\n\n\t\t\tif(values.condition !== \"<>\"){\n\t\t\t\titem.push(this._safeInt(values.value, 10));\n\t\t\t} else {\n\t\t\t\titem.push([this._safeInt(values.value, 10),this._safeInt(values.value2, 10)]);\n\t\t\t}\n\t\t\titem.push(values.style);\n\t\t\tfor(var i=0; i < item.length; i++){\n\t\t\t\tif(item[i] === \"\")\n\t\t\t\t\treturn false;\n\t\t\t}\n\t\t\tdata.push(item);\n\t\t});\n\n\t\tview.callEvent(\"onConditionSet\", [data]);\n\t}\n\t_safeInt(a){\n\t\tvar num = parseFloat(a);\n\t\tif (num == a) return num;\n\t\treturn a;\n\t}\n\t_setCondition() {\n\t\tvar view = this.view,\n\t\t\tselect = view.getSelectedId(true),\n\t\t\tcell = select[0];\n\n\t\tif(!select.length) return false;\n\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\n\t\tif(collection){\n\t\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\t\tcollection.forEach((item, i) => {\n\t\t\t\tvar values = {};\n\t\t\t\tvalues.condition = item[0];\n\t\t\t\tif(webix.isArray(item[1])){\n\t\t\t\t\tvalues.value = item[1][0].toString();\n\t\t\t\t\tvalues.value2 = item[1][1].toString();\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t\tvalues.value = item[1].toString();\n\t\t\t\tvalues.style = item[2];\n\t\t\t\tforms[i+1].setValues(values);\n\t\t\t});\n\t\t}\n\t}\n\n\tapply(){\n\t\tthis._getCondition();\n\t\tthis.close();\n\t}\n\n\t_clean() {\n\t\tlet forms = this.$dialog.getBody().getChildViews()[0].getChildViews()[0].getChildViews();\n\t\tforms.forEach(form => {\n\t\t\tif (form.setValues) form.setValues({condition: \"\", value: \"\", value2: \"\", style: \"\"});\n\t\t});\n\t}\n\n\t$show(){\n\t\tif(!this.view.getSelectedId())\n\t\t\treturn false;\n\n\t\tthis.view.$handleSelection = (st, end, a, b)=>{\n\t\t\tif (this.activeValue && a == b){\n\t\t\t\tthis.activeValue.setValue(\"=\"+a);\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t\tthis._setCondition();\n\t}\n\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t\tthis._clean();\n\t}\n\n\tgetRows(data, count){\n\t\tlet headers = {\n\t\t\theight: 36,\n\t\t\tcols: [\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.display },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.condition },\n\t\t\t\t{ view:\"label\", label: webix.i18n.spreadsheet.labels.value },\n\t\t\t\t{ width: 25 }\n\t\t\t]\n\t\t};\n\t\tlet arr = [headers];\n\t\t\n\t\tlet item = {\n\t\t\tview: \"form\",\n\t\t\tpadding: 0,\n\t\t\tborderless: true,\n\n\t\t\telements: [{\n\t\t\t\tmargin: 10,\n\t\t\t\tcols: [\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\tname: \"style\",\n\t\t\t\t\t\twidth:120,\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-style\"],\n\t\t\t\t\t\tcss: \"webix_ssheet_cformat_select\",\n\t\t\t\t\t\tsuggest: {\n\t\t\t\t\t\t\tpadding:0,\n\t\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\t\tcss: \"webix_ssheet_cformat_list\",\n\t\t\t\t\t\t\tbody: {\n\t\t\t\t\t\t\t\ttemplate(obj) {\n\t\t\t\t\t\t\t\t\tvar css = \"webix_ssheet_cformat \"+obj.css;\n\t\t\t\t\t\t\t\t\treturn `<div class=\"${css}\">${obj.name}</div>`;\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tdata: data\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview:\"richselect\",\n\t\t\t\t\t\twidth: 105,\n\t\t\t\t\t\tname: \"condition\",\n\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-operator\"],\n\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\tonChange: function(newv){\n\t\t\t\t\t\t\t\tif(newv === \"<>\"){\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.show();\n\t\t\t\t\t\t\t\t}else {\n\t\t\t\t\t\t\t\t\tthis.getFormView().elements.value2.hide();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tsuggest:{\n\t\t\t\t\t\t\tview: \"ssheet-form-suggest\",\n\t\t\t\t\t\t\tbody:{\n\t\t\t\t\t\t\t\tdata: condition\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols: [\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tplaceholder: webix.i18n.spreadsheet.labels[\"conditional-number\"],\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tname: \"value\"\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"text\",\n\t\t\t\t\t\t\t\tname: \"value2\",\n\t\t\t\t\t\t\t\ton: {\n\t\t\t\t\t\t\t\t\tonFocus: (current_view)=>{\n\t\t\t\t\t\t\t\t\t\tthis.activeValue = current_view;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\thidden: true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t},\n\t\t\t\t\t{ view:\"icon\", css:\"webix_ssheet_cformat_clear\", icon:\"wxi-trash\", click:clearRow }\n\t\t\t\t]}\n\t\t\t]};\n\n\t\twhile(count--){\n\t\t\tarr.push(item);\n\t\t}\n\t\treturn arr;\n\t}\n\n\t$init(){\n\t\t//[IMPROVE] can be optimized by using datalayout instead of nested forms\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"conditional-format\"],\n\t\t\tposition:\"center\",\n\t\t\twidth: 500,\n\t\t\tmove: true,\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview: \"form\",\n\t\t\t\tborderless: true,\n\t\t\t\trows: [\n\t\t\t\t\t{rows: this.getRows(getConditionStyle(this.view.config.conditionStyle), 3)},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{gravity:2},\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tview: \"button\",\n\t\t\t\t\t\t\t\tvalue: webix.i18n.spreadsheet.labels.apply,\n\t\t\t\t\t\t\t\tclick: () => this.apply()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction clearRow(){\n\t//this - clear icon\n\tvar form = this.getFormView();\n\tform.clear();\n}","import {Dialog} from \"./common\";\n\nexport const action = \"excel-export\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tthis.view.$handleSelection = function(){\n\t\t\treturn false;\n\t\t};\n\n\t\tform.elements.sheets.setValue(this.getSheets());\n\t\tform.elements.filename.setValue(\"Data\");\n\t\tform.elements.filename.getInputNode().select();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"export-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"filename\",  placeholder:webix.i18n.spreadsheet.labels[\"export-name\"]},\n\t\t\t\t\t{ view:\"multicheckbox\", name:\"sheets\"}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tgetSheets(){\n\t\tvar view = this.view;\n\t\tvar sheets = view._sheets;\n\t\tvar value = {};\n\n\t\tif(sheets && sheets.length > 1){\n\t\t\tfor(var i = 0; i<sheets.length; i++)\n\t\t\t\tvalue[sheets[i].name] = (view._activeSheet === sheets[i].name?1:0);\n\t\t}\n\t\treturn value;\n\t}\n}\n\nfunction okClick(dialog){\n\tvar values = dialog.$dialog.getBody().getValues();\n\twebix.toExcel(dialog.view, values);\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-link\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif(!cell)\n\t\t\treturn false;\n\t\tif (!this.restoreValue(form))\n\t\t\tform.clear();\n\t\tform.elements.name.focus();\n\t}\n\trestoreValue(form){\n\t\tvar cell = this.view.getSelectedId();\n\t\tif (cell){\n\t\t\tvar item = this.view.getRow(cell.row);\n\t\t\tvar value = item[\"$\"+cell.column] || item[cell.column];\n\t\t\tif (value && value.indexOf(\"=LINK\") === 0){\n\t\t\t\tvar parts = value.split(\"\\\"\");\n\t\t\t\tform.setValues({\n\t\t\t\t\tname: (parts[3] || \"\"),\n\t\t\t\t\turl: (parts[1] || \"\")\n\t\t\t\t});\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"link-title\"],\n\t\t\tmove: true,\n\t\t\tposition: \"center\",\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ view:\"text\", name:\"name\",  placeholder:webix.i18n.spreadsheet.labels[\"link-name\"]},\n\t\t\t\t\t{ view:\"text\", name:\"url\",  placeholder:webix.i18n.spreadsheet.labels[\"link-url\"]}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => okClick(this),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}\n\nfunction okClick(dialog){\n\tvar cell = dialog.view.getSelectedId();\n\tvar data = dialog.$dialog.getBody().getValues();\n\n\tvar text = \"\";\n\tif (data.url){\n\t\tdata.name = data.name || data.url;\n\t\tif (!/^https?:\\/\\//i.test(data.url))\n\t\t\tdata.url = \"http://\" + data.url;\n\t\ttext = `=LINK(\"${data.url}\",\"${data.name}\")`;\n\t}\n\n\tdialog.view.setCellValue(cell.row, cell.column, text);\n\tdialog.view.refresh();\n\tdialog.close();\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"print\";\n\nexport class DialogBox extends Dialog{\n\t$show(box, form){\n\t\tform.setValues({\n\t\t\tdata:\"current\",\n\t\t\tpaper:\"A4\",\n\t\t\tfit:\"page\",\n\t\t\tmode:\"landscape\",\n\t\t\tsheetnames:1,\n\t\t\tmargin:0\n\t\t});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\thead: webix.i18n.spreadsheet.labels[\"print-title\"],\n\t\t\tmove: true,\n\t\t\tmodal:true,\n\t\t\twidth:520, height:520,\n\t\t\tposition: \"center\",\n\t\t\tbuttons:false,\n\t\t\tbody:{\n\t\t\t\tview:\"form\",\n\t\t\t\telements:[\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-settings\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{ view:\"radio\", name:\"data\",vertical:true, options:[\n\t\t\t\t\t\t\t{ id:\"current\", value:webix.i18n.spreadsheet.labels[\"current-sheet\"]},\n\t\t\t\t\t\t\t{ id:\"all\", value:webix.i18n.spreadsheet.labels[\"all-sheets\"]},\n\t\t\t\t\t\t\t{ id:\"selection\", value:webix.i18n.spreadsheet.labels[\"selection\"]}\n\t\t\t\t\t\t], on:{\n\t\t\t\t\t\t\tonChange:function(newv){\n\t\t\t\t\t\t\t\tif(newv == \"all\"){\n\t\t\t\t\t\t\t\t\tvar form = this.getFormView();\n\t\t\t\t\t\t\t\t\tform.elements.sheetnames.setValue(1);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}},\n\t\t\t\t\t\t{ rows:[\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"sheetnames\", labelRight:webix.i18n.spreadsheet.labels[\"sheet-names\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"borderless\", labelRight:webix.i18n.spreadsheet.labels[\"borderless\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"skiprows\", labelRight:webix.i18n.spreadsheet.labels[\"skip-rows\"]},\n\t\t\t\t\t\t\t{view:\"checkbox\", name:\"margin\", labelRight:webix.i18n.spreadsheet.labels[\"margin\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-paper\"]},\n\t\t\t\t\t{ view:\"radio\", name:\"paper\", options:[\n\t\t\t\t\t\t{ id:\"letter\", value:webix.i18n.spreadsheet.labels[\"page-letter\"]},\n\t\t\t\t\t\t{ id:\"A4\", value:webix.i18n.spreadsheet.labels[\"page-a4\"]},\n\t\t\t\t\t\t{ id:\"A3\", value:webix.i18n.spreadsheet.labels[\"page-a3\"]}\n\t\t\t\t\t]},\n\t\t\t\t\t{ type:\"section\", template: webix.i18n.spreadsheet.labels[\"print-layout\"]},\n\t\t\t\t\t{ cols:[\n\t\t\t\t\t\t{view:\"radio\", name:\"fit\", options:[\n\t\t\t\t\t\t\t{ id:\"page\", value:webix.i18n.spreadsheet.labels[\"page-width\"]},\n\t\t\t\t\t\t\t{ id:\"data\", value:webix.i18n.spreadsheet.labels[\"page-actual\"]}\n\t\t\t\t\t\t]},\n\t\t\t\t\t\t{ width:35},\n\t\t\t\t\t\t{ view:\"radio\", width:220, name:\"mode\", options:[\n\t\t\t\t\t\t\t{ id:\"portrait\", value:webix.i18n.spreadsheet.labels[\"page-portrait\"]},\n\t\t\t\t\t\t\t{ id:\"landscape\", value:webix.i18n.spreadsheet.labels[\"page-landscape\"]}\n\t\t\t\t\t\t]}\n\t\t\t\t\t]},\n\t\t\t\t\t{\n\t\t\t\t\t\tcols:[\n\t\t\t\t\t\t\t{ },\n\t\t\t\t\t\t\t{ view: \"button\", css:\"ssheet_cancel_button\", value: webix.i18n.spreadsheet.labels.cancel, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.close()\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t{ view: \"button\", value: webix.i18n.spreadsheet.labels.print, autowidth:true,\n\t\t\t\t\t\t\t\tclick: () => this.apply(this)\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonHideClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n\tapply(dialog){\n\t\tvar data = dialog.$dialog.getBody().getValues();\n\t\tdata.margin = data.margin?0:{};\n\t\tthis.close();\n\t\twebix.print(dialog.view, data);\n\t\t\n\t}\n}\n","import {Dialog} from \"./common\";\n\nexport const action = \"add-comment\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\t//we get cell only on hover commented cell\n\t\tthis.cell = action.cell ? action.cell : this.view.getSelectedId();\n\n\t\t// cell not provided\n\t\tif (!this.cell || \n\t\t\t// cell is locked and in the edit mode\n\t\t\t(this.view.isCellLocked(this.cell.row, this.cell.column) && !action.viewonly) ||\n\t\t\t// action blocked by user's code\n\t\t\t!(this.view.callEvent(\"onBeforeCommentShow\", [this.cell.row, this.cell.column, !action.viewonly]))){\n\t\t\treturn false;\n\t\t}\n\n\t\tthis.view.comments._activeComment = {editStatus: !action.viewonly, cell: this.cell};\n\n\t\tif(!this.$dialog){\n\t\t\tthis.$dialog = webix.ui(this.$init());\n\t\t\tthis.view.comments.commentsView = this.$dialog;\n\t\t\tthis.$dialog.attachEvent(\"onHide\", ()=>this.$hide());\n\t\t\tthis.view.attachEvent(\"onCommentHide\", ()=>this.$dialog.hide());\n\t\t}\n\n\t\tvar form = this.$dialog.getBody();\n\n\t\tvar span = this.view.$$(\"cells\").getSpan(this.cell.row, this.cell.column);\n\t\tvar item = span ? {row: this.cell.row, column:(span[1]*1+span[2]-1)} : this.cell;\n\n\t\twebix.delay(()=>{\n\t\t\tthis.$dialog.show(this.view.$$(\"cells\").getItemNode(item));\n\t\t\tthis._setComment();\n\t\t});\n\t\tif (this.$show(this.$dialog, form) === false)\n\t\t\tthis.close();\n\t}\n\t$show(){\n\t\tthis.textarea = this.$dialog.queryView({view:\"textarea\"});\n\t\tthis.template = this.$dialog.queryView({view:\"template\"});\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"popup\",\n\t\t\tcss:\"ssheet_comments\",\n\t\t\tminWidth:250,\n\t\t\tminHeight:150,\n\t\t\trelative:\"right\",\n\t\t\tresize:true,\n\t\t\ton:{\n\t\t\t\tonViewResize:()=>{\n\t\t\t\t\tthis.$dialog.hide();\n\t\t\t\t\tthis.$dialog.show();\n\t\t\t\t}\n\t\t\t},\n\t\t\tbody:{\n\t\t\t\tanimate:false,\n\t\t\t\tcells:[\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"template\",\n\t\t\t\t\t\tcss:\"ssheet_comment_view\",\n\t\t\t\t\t\tborderless: true,\n\t\t\t\t\t\tscroll:\"auto\",\n\t\t\t\t\t\tonClick:{\n\t\t\t\t\t\t\t\"ssheet_comment_view\":() => {\n\t\t\t\t\t\t\t\tif(!(this.view.config.readonly || this.view.isCellLocked(this.cell.row, this.cell.column)))\n\t\t\t\t\t\t\t\t\tthis.showInput(this.view.comments.get(this.cell.row, this.cell.column));\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tview: \"textarea\",\n\t\t\t\t\t\ton:{\n\t\t\t\t\t\t\tonChange:()=>{\n\t\t\t\t\t\t\t\tthis.addComment();\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFocus:()=>{\n\t\t\t\t\t\t\t\tthis.view.$$(\"cells\").select(this.cell.row, this.cell.column);\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {editStatus: true, cell: this.cell};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonBlur:()=>{\n\t\t\t\t\t\t\t\tthis.showTemplate(this.textarea.getValue());\n\t\t\t\t\t\t\t\tthis.changeTextarea();\n\t\t\t\t\t\t\t\tthis.view.comments._activeComment = {};\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t};\n\t}\n\t_setComment(){\n\t\tconst comment = this.view.comments.get(this.cell.row, this.cell.column);\n\t\tif(this.view.comments._activeComment.editStatus)\n\t\t\tthis.showInput(comment);\n\t\telse\n\t\t\tthis.showTemplate(comment);\n\t}\n\tshowTemplate(text){\n\t\tthis.template.show();\n\t\tthis.template.setHTML(text);\n\t}\n\tshowInput(text){\n\t\tthis.changeTextarea(text);\n\t\tthis.textarea.show();\n\t\tthis.textarea.focus();\n\t}\n\taddComment(){\n\t\tthis.view.comments.add(this.cell.row, this.cell.column, this.textarea.getValue());\n\t\tthis.$dialog.hide();\n\t}\n\tchangeTextarea(text){\n\t\tthis.textarea.blockEvent();\n\t\tthis.textarea.setValue(text||\"\");\n\t\tthis.textarea.unblockEvent();\n\t}\n}","import {Dialog} from \"./common\";\nexport const action = \"resize\";\n\nexport class DialogBox extends Dialog{\n\topen(action){\n\t\tthis.type = action.group;\n\t\tthis.header = action.value;\n\t\tDialog.prototype.open.apply(this, arguments);\n\t}\n\t$show(){\n\t\tconst sel = this.view.getSelectedId();\n\t\tif(!sel)\n\t\t\treturn false;\n\t\tthis.view.$handleSelection = ()=>{\n\t\t\treturn false;\n\t\t};\n\t\tthis.size = this.$dialog.getBody().elements[\"size\"];\n\t\tthis.$dialog.getHead().getChildViews()[0].setHTML(this.header);\n\t\tconst grid = this.view.$$(\"cells\");\n\n\t\tlet value;\n\t\tif(this.type == \"row\")\n\t\t\tvalue = grid.getItem(sel.row).$height || grid.config.rowHeight;\n\t\telse\n\t\t\tvalue = grid.getColumnConfig(sel.column).width || grid.config.columnWidth;\n\n\t\tthis.size.define({ value: value, label: webix.i18n.spreadsheet.labels[this.type == \"row\" ? \"height\" : \"width\"]});\n\t\tthis.size.refresh();\n\t\tthis.size.focus();\n\t}\n\t$hide(){\n\t\tthis.view.$handleSelection = null;\n\t}\n\tokClick(){\n\t\tconst size = this.size.getValue()*1;\n\t\tif(this.type == \"row\")\n\t\t\tthis.view.setRowHeight(null, size);\n\t\telse\n\t\t\tthis.view.setColumnWidth(null, size);\n\t\tthis.close();\n\t}\n\t$init(){\n\t\treturn {\n\t\t\tview: \"ssheet-dialog\",\n\t\t\tposition:\"center\",\n\t\t\twidth: 300,\n\t\t\tmove: true,\n\t\t\tbody:{\n\t\t\t\tname: \"size\",\n\t\t\t\tview: \"text\"\n\t\t\t},\n\t\t\ton:{\n\t\t\t\tonSaveClick: () => this.okClick(),\n\t\t\t\tonHideClick: () => this.close(),\n\t\t\t\tonCancelClick: () => this.close()\n\t\t\t}\n\t\t};\n\t}\n}","import * as aiw from \"./image\";\nimport * as asw from \"./sparkline\";\nimport * as rgs from \"./ranges\";\nimport * as dpd from \"./dropdown\";\nimport * as fmt from \"./format\";\nimport * as cnd from \"./conditional\";\nimport * as exp from \"./export\";\nimport * as lnk from \"./link\";\nimport * as pnt from \"./print\";\nimport * as cmt from \"./comments\";\nimport * as siz from \"./sizing\";\n\nvar bases = [ aiw, asw, rgs, dpd, fmt, cnd, exp, lnk, pnt, cmt, siz ];\n\nexport function init(view){\n\tvar dialogs = {};\n\tif(view.config.readonly)\n\t\tbases = [cmt];\n\tfor (var i = 0; i < bases.length; i++)\n\t\tdialogs[bases[i].action] = new bases[i].DialogBox(view);\n\n\tview.attachEvent(\"onCommand\", function(action){\n\t\tvar box = dialogs[action.id];\n\t\tif (box) box.open(action);\n\t});\n}","import group from \"./undo_group\";\n\nexport const lockCss = \"webix_lock\";\n\nexport function init(view){\n\tview._locks = {};\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, mode) => {\n\t\tif (type === \"lock\") lockCell(view, row, column, !!mode, true);\n\t});\n\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"lock-cell\")\n\t\t\tlock(view);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._locks = {};\n}\n\nexport function lockCell(view, row, column, mode, silent){\n\tvar table = view.$$(\"cells\");\n\tif (typeof row === \"object\" && typeof column === \"object\"){\n\t\tgroup.set(function() {\n\t\t\t_mapCellsCalls(row, column, function(row, column){\n\t\t\t\tlockCell(view, row, column, mode, true);\n\t\t\t});\n\t\t});\n\t} else {\n\t\tmode = ((mode === false) ? false : true);\n\t\tvar objrow = view._locks[row] = view._locks[row] || {};\n\t\tobjrow[column] = mode;\n\t\tif (mode)\n\t\t\ttable.addCellCss(row, column, lockCss, true);\n\t\telse\n\t\t\ttable.removeCellCss(row, column, lockCss, true);\n\n\t\tview.callEvent(\"onAction\", [\"lock\", { row, column, value: !mode, newValue: mode }]);\n\t}\n\n\tif (!silent)\n\t\ttable.refresh();\n}\n\nfunction _mapCellsCalls(start, end, handler,master){\n\tfor (let x = start.row; x<=end.row; x++)\n\t\tfor (let y = start.column; y<=end.column; y++)\n\t\t\thandler.call(master||this, x, y);\n}\n\nexport function isCellLocked(view, row, column){\n\treturn view._locks[row]?view._locks[row][column]:false;\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tlocked = [];\n\tfor(row in view._locks){\n\t\tfor(column in view._locks[row])\n\t\t\tif(view._locks[row][column])\n\t\t\t\tlocked.push([row,column]);\n\t}\n\tdata.locked = locked;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tlocked = data.locked;\n\n\tif(locked)\n\t\tfor(i = 0; i < locked.length; i++)\n\t\t\tlockCell(view, locked[i][0],locked[i][1],true, true);\n}\n\nfunction lock(view){\n\tvar block = view.$$(\"cells\").getSelectArea();\n\tif (block){\n\t\tvar mode = view.isCellLocked(block.start.row, block.start.column);\n\t\tview.lockCell(block.start, block.end, !mode);\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet locked = data.locked,\n\t\ti = locked.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = locked[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tlocked.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tlocked[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tlocked.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tlocked[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}","import {isCellLocked} from \"./lock_cell\";\nimport group from \"./undo_group\";\n\n\nvar ignoreUndoReset = false;\n\nexport function init(view){\n\treset(view);\n\tundoHandlers(view);\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\tview.attachEvent(\"onAfterSheetShow\", () => reset(view));\n\t// styles\n\tview.attachEvent(\"onBeforeStyleChange\", (row, column, nstyle, ostyle) =>{\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"style\", row:row, column: column, value: ostyle, newValue: nstyle, group: group.value});\n\t});\n\t// editing\n\tview.attachEvent(\"onBeforeValueChange\", (row, column, nvalue, ovalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"value\", row:row, column: column, value: ovalue, newValue: nvalue, group: group.value});\n\t});\n\t// merge cells\n\tview.attachEvent(\"onBeforeSpan\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"span\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// split cells\n\tview.attachEvent(\"onBeforeSplit\", (row, column, value) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\t\taddToHistory(view, {action: \"split\", row:row, column: column, value: value, newValue:value, group: group.value});\n\t});\n\t// Any abstract undo actions\n\tview.attachEvent(\"onAction\", (action, obj) =>\n\t\taddToHistory(\n\t\t\tview,\n\t\t\t{\n\t\t\t\taction: action,\n\t\t\t\trow: obj.row || null,\n\t\t\t\tcolumn: obj.column || null,\n\t\t\t\tvalue: obj.value || null,\n\t\t\t\tnewValue: obj.newValue || null,\n\t\t\t\tgroup: group.value\n\t\t\t}\n\t\t)\n\t);\n\n\t// column resize\n\tview.$$(\"cells\").attachEvent(\"onColumnResize\", (column, nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"c-resize\", row:0, column:column, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\t// column hide\n\tview.attachEvent(\"onColumnOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:0, column:{ start, end } });\n\t});\n\t// row hide\n\tview.attachEvent(\"onRowOperation\", (action, start, end) => {\n\t\tif (action.id !== \"add\" && action.id !== \"del\")\n\t\t\taddToHistory(view, { action:action, row:{ start, end }, column:0 });\n\t});\n\t// row resize\n\tview.$$(\"cells\").attachEvent(\"onRowResize\", (row,  nvalue, ovalue) =>\n\t\taddToHistory(view, {action: \"r-resize\", row: row, column:0, value: ovalue, newValue: nvalue, group: group.value})\n\t);\n\n\t// condition formats\n\tview.attachEvent(\"onBeforeConditionSet\", (row, column, value, nvalue) => {\n\t\tif (isCellLocked(view, row, column)) return false;\n\n\t\tvalue = value ? webix.copy(value) : null;\n\t\taddToHistory(view, {action: \"condition\", row: row, column: column, value: value, newValue: nvalue, group: group.value});\n\t});\n\tview.$skipHistory = 0;\n}\n\nexport function undo(view){\n\trestoreHistory(view,-1);\n}\n\nexport function redo(view){\n\trestoreHistory(view,1);\n}\n\nexport function reset(view){\n\tif(!ignoreUndoReset){\n\t\tview._ssUndoHistory = [];\n\t\tview._ssUndoCursor = -1;\n\t}\n}\n\nfunction addToHistory(view, data){\n\tif(!view.$skipHistory){\n\t\t// remove futher history\n\t\tview._ssUndoHistory.splice(view._ssUndoCursor+1);\n\t\t// add to an array and increase cursor\n\t\tview._ssUndoHistory.push(data);\n\t\tview._ssUndoCursor++;\n\t}\n}\n\nexport function ignoreUndo(func, view){\n\tview.$skipHistory++;\n\ttry{\n\t\tfunc.call(view);\n\t}\n\tfinally {\n\t\tview.$skipHistory--;\n\t}\n}\n\nexport function ignoreReset(func){\n\tignoreUndoReset = true;\n\tfunc();\n\tignoreUndoReset = false;\n}\n\nfunction restoreHistory(view, step){\n\tvar data = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\tif(data){\n\t\tvar value = step > 0 ? data.newValue : data.value;\n\t\tvar direction = step>0;\n\t\tvar params = [data.action, data.row, data.column, value, direction];\n\n\t\tview._ssUndoCursor += step;\n\n\t\t// group support\n\t\tvar group = data.group;\n\t\tvar prevData = view._ssUndoHistory[step>0?(view._ssUndoCursor+step):view._ssUndoCursor];\n\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onUndo\", params);\n\t\t\tif(!group || !(prevData && group == prevData.group))\n\t\t\t\tview.refresh();\n\t\t},view);\n\n\t\tif(prevData && group && group == prevData.group){\n\t\t\trestoreHistory(view, step);\n\t\t}\n\t}\n}\n\nfunction undoHandlers(view){\n\tview.attachEvent(\"onUndo\", function(type, row, column, value) {\n\t\tswitch (type) {\n\t\t\tcase \"freeze-row\":\n\t\t\t\tview.freezeRows(value);\n\t\t\t\tbreak;\n\t\t\tcase \"freeze-column\":\n\t\t\t\tview.freezeColumns(value);\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import {lockCss} from \"./lock_cell\";\nimport {find, findIndex} from \"../helpers/array\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\tview.attachEvent(\"onStyleChange\", (row, column, style) => {\n\t\tvar span = getSpan(view, row, column);\n\t\tif (span)\n\t\t\tspan[3] = style?style.id:\"\";\n\t});\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.spans)\n\t\t\tfor (var i = 0; i < data.spans.length; i++) {\n\t\t\t\tvar span = data.spans[i];\n\t\t\t\taddSpan( view,\n\t\t\t\t\t{ row: span[0], column: span[1] },\n\t\t\t\t\tspan[2]*1,\n\t\t\t\t\tspan[3]*1,\n\t\t\t\t\ttrue \n\t\t\t\t);\n\t\t\t}\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar spans = [];\n\t\tvar pull = view.$$(\"cells\").getSpan();\n\t\tif (pull){\n\t\t\tfor (var rid in pull){\n\t\t\t\tvar row = pull[rid];\n\t\t\t\tfor (var cid in row){\n\t\t\t\t\tvar span = row[cid];\n\t\t\t\t\tspans.push([rid*1, cid*1, span[0], span[1]]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tdata.spans = spans;\n\t\t}\n\t});\n\t\n\tview.attachEvent(\"onUndo\", (type, row, column, value, isUndo) => {\n\t\tif(type == \"span\" || type == \"split\"){\n\t\t\tif (type == \"span\") \n\t\t\t\tisUndo = !isUndo;\n\t\t\tundoSpan(view, row, column, value, isUndo);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (name, options) => {\n\t\tif(name == \"lock\")\n\t\t\tsetLockCss(view, options.row, options.column, options.newValue);\n\t\telse if(name == \"before-grid-change\")\n\t\t\tupdatePosition(options.name,options.inc,options.data, options.start);\n\t\telse if(name == \"check-borders\")\n\t\t\treturn checkSpanBorders(view, options.row, options.column, options.area, options.mode);\n\t});\n}\n\nfunction getSpan(view, row, column){\n\tvar item = view.$$(\"cells\").getSpan()[row];\n\tif (item)\n\t\treturn item[column];\n}\n\nexport function addSpan(view, cell, x, y, silent){\n\tif (x<2 && y<2) return;\n\n\tif(silent || view.callEvent(\"onBeforeSpan\", [cell.row, cell.column, [x, y]])){\n\t\tvar row = view.getRow(cell.row);\n\t\tvar css = row.$cellCss ? (row.$cellCss[cell.column] || \"\") : \"\";\n\t\tsetSpanValue(view, cell, x, y);\n\t\tview.$$(\"cells\").addSpan(cell.row, cell.column, x, y, null, css);\n\t\tif(!silent){\n\t\t\tview.callEvent(\"onAfterSpan\", [cell.row, cell.column, [x, y]]);\n\t\t\tsave(view, \"spans\", {\n\t\t\t\trow:cell.row, column: cell.column,\n\t\t\t\tx:x, y:y\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport function removeSpan(view, cell){\n\tvar span = view.$$(\"cells\").getSpan(cell.row, cell.column);\n\tif(span && view.callEvent(\"onBeforeSplit\", [ cell.row, cell.column, [span[2], span[3]] ])){\n\t\tview.$$(\"cells\").removeSpan(cell.row, cell.column);\n\t\tview.callEvent(\"onAfterSplit\", [ cell.row, cell.column, [span[2], span[3]] ]);\n\t\tsave(view, \"spans\", {\n\t\t\trow:cell.row, column: cell.column,\n\t\t\tx:0, y:0\n\t\t});\n\t}\n}\n\nexport function getRange(sel){\n\tvar lx, ly, rx, ry;\n\trx = ry = 0;\n\tlx = ly = Infinity;\n\n\tfor (var i=0; i<sel.length; i++){\n\t\tvar cx = sel[i].column*1;\n\t\tvar cy = sel[i].row*1;\n\n\t\tlx = Math.min(cx, lx);\n\t\trx = Math.max(cx, rx);\n\t\tly = Math.min(cy, ly);\n\t\try = Math.max(cy, ry);\n\t}\n\n\treturn {\n\t\tcell:{ row:ly, column:lx },\n\t\tx: rx-lx+1,\n\t\ty: ry-ly+1\n\t};\n}\n\nfunction undoSpan(view,row, column,value,isUndo){\n\tif(isUndo){\n\t\tremoveSpan(view,{row: row, column: column});\n\t}\n\telse{\n\t\taddSpan(view, {row: row, column: column}, value[0], value[1]);\n\t}\n}\n\nfunction setLockCss(view, row, column, mode){\n\tvar span = getSpan(view, row, column);\n\tif(span){\n\t\tif(mode){\n\t\t\tif(span[3].indexOf(lockCss) == -1)\n\t\t\t\tspan[3] += \" \"+lockCss;\n\t\t}\n\t\telse\n\t\t\tspan[3] = span[3].replace(\" \"+lockCss,\"\");\n\t\tview._table.refresh();\n\t}\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet spans = data.spans;\n\tif(inc){\n\t\tfor(let i = spans.length-1;i >=0;i--){\n\t\t\tlet [row,column] = spans[i];\n\n\t\t\tif(inc < 0){//deleting\n\t\t\t\tif(name == \"row\" && row <= start.row-inc-1)\n\t\t\t\t\tinc = start.row - spans[i][0];\n\t\t\t\telse if (name == \"column\" && column <= start.column-inc-1)\n\t\t\t\t\tinc = start.column - spans[i][1];\n\t\t\t}\n\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tspans[i][0] =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tspans[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t}\n\t\t}\n\t}\n}\n\nvar borderChecks = {\n\t\"border-right\":\t\tfunction(row, column, span, area){\n\t\treturn area.end.column == column+span[0]-1;\n\t},\n\t\"border-bottom\":\tfunction(row, column, span, area){\n\t\treturn area.end.row == row+span[1]-1;\n\t}\n};\n\nfunction checkSpanBorders(view, row, column, area, mode){\n\tvar span = getSpan(view, row, column);\n\treturn span&&borderChecks[mode]?borderChecks[mode](row, column, span, area):false;\n}\n\n// clear merged cells except the first one\nfunction setSpanValue(view, cell, x, y){\n\tvar i,j,value,\n\t\trow = cell.row*1,\n\t\tcolumn = cell.column*1,\n\t\tisEmpty = !view.getCellValue(row,column);\n\tfor(i = row; i < row+y; i++){\n\t\tfor(j = column; j < column+x; j++) {\n\t\t\tvalue = view.getCellValue(i,j);\n\t\t\tif(value!==\"\" && (j != column || i != row)){\n\t\t\t\tif(isEmpty){\n\t\t\t\t\tisEmpty = false;\n\t\t\t\t\tview.setCellValue(row,column,value);\n\t\t\t\t}\n\t\t\t\tview.setCellValue(i,j,\"\");\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function adjustSpan (span, action, start, end, data){\n\tvar length = action.group == \"row\" ? span[3] : span[2];\n\tvar checkSpan = action.group == \"row\" ? [span[0]*1, span[0]*1+span[3]-1] : [span[1]*1, span[1]*1+span[2]-1];\n\tvar selection = action.group == \"row\" ? [start.row, end.row] : [start.column, end.column];\n\n\t//if we add, the number of selected rows/cols is added to span, so we need original selection length\n\tvar inc = selection[1] - selection[0] + 1;\n\n\tselection[0] = Math.max(selection[0], checkSpan[0]);\n\tselection[1] = Math.min(selection[1], checkSpan[1]);\n\n\tvar isFirstCell = selection[0] == checkSpan[0];\n\n\tif(selection[0] <= selection[1]){ //selection is in span\n\t\tif(action.id == \"del\") //if we delete, only rows/cols included into span\n\t\t\tinc = (selection[1] - selection[0]+ 1) * -1;\n\t\t//delete smth which starts as span and less than it's length\n\t\tif(action.id == \"del\" && isFirstCell && length > -1*inc){\n\t\t\tvar value = find(data, function(value) {\n\t\t\t\treturn (value[0] == span[0] && value[1] == span[1]);\n\t\t\t});\n\n\t\t\tvalue[0] = action.group == \"row\" ? value[0] - inc : value[0];\n\t\t\tvalue[1] = action.group == \"column\" ? value[1] - inc : value[1];\n\n\t\t\tvar oldValue = findIndex(data, function(oldValue) {\n\t\t\t\treturn oldValue[0] == value[0] && oldValue[1] == value[1] && (oldValue[2] != value[2] || oldValue[3] != value[3]); \n\t\t\t});\n\n\t\t\tif(oldValue > -1) //remove another data at the same place\n\t\t\t\tdata.splice(oldValue,1);\n\t\t}\n\n\t\tif(!(isFirstCell && action.id == \"add\")){\n\t\t\tspan[2] = action.group == \"column\" ? span[2]+inc : span[2];\n\t\t\tspan[3] = action.group == \"row\" ? span[3]+inc : span[3];\n\t\t}\n\t}\n\treturn span;\n}\n\nexport function pasteSpan(view, extra, row, col, cutted, translate){\n\t//existing span\n\tvar s = view._table.getSpan(row, col);\n\tif(extra && extra.span){\n\t\tvar span = extra.span;\n\t\t//if we are on start position for the future span\n\t\tif(row == span[0]*1+translate.row && col == span[1]*1+translate.column){\n\t\t\t//delete spans in future paste zone \n\t\t\tview._table.mapCells(row, col, span[3], span[2], (value, rid, cid) => {\n\t\t\t\ts = view._table.getSpan(rid,cid);\n\t\t\t\tif(s) removeSpan(view, {row:s[0], column:s[1]});\n\t\t\t}, true);\n\t\t\taddSpan(view, {row:row, column:col}, span[2], span[3]);\n\t\t\tif(cutted === 1)\n\t\t\t\tremoveSpan(view, {row:extra.row, column:extra.col});\n\t\t}\n\t}\n\telse if(s)\n\t\tremoveSpan(view, {row:s[0], column:s[1]});\n}","import {updateMath}  from \"../math/updater\";\nimport {ignoreReset, ignoreUndo}  from \"../operations/undo\";\nimport group  from \"../operations/undo_group\";\nimport {adjustSpan}  from \"../operations/spans\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action, start, end) => {\n\t\tif (action.id == \"add\" || action.id == \"del\"){\n\t\t\tvar area = view._table.getSelectArea();\n\t\t\tif(area && !(start && end)){\n\t\t\t\tstart = area.start;\n\t\t\t\tend = area.end;\n\t\t\t}\n\n\t\t\tif (start && end){\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tprocess(action, start, end, view);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t});\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif(action == \"grid-change\")\n\t\t\tloadChangedData(view,value);\n\t});\n}\n\nexport function process(action, start, end, view, e, r) {\n\tvar data, i, newData, oldData, values,\n\t\tcount=0, origin=0;\n\n\tvar select = view._table.getSelectArea();\n\tvar state = view._table.getScrollState();\n\n\tnewData = view.serialize({\n\t\tmath: true\n\t});\n\n\toldData = webix.copy(newData);\n\n\tvar spans = newData.spans;\n\tfor (var s in spans){\n\t\tvar span = spans[s];\n\t\tspan = adjustSpan(span, action, start, end, newData.data);\n\t\tif(span[2] <= 0 || span[3] <= 0){\n\t\t\tspans.splice(s, 1);\n\t\t}\n\t}\n\n\tvalues = getUpdateValues(action, start, end);\n\n\tview.$handleSelection = null;\t\n\n\tif(!e)\n\t\tignoreUndo(function(){\n\t\t\tview.callEvent(\"onAction\", [\"before-grid-change\", {\n\t\t\t\tname: values.name,\n\t\t\t\tinc: values.inc,\n\t\t\t\tdata:newData,\n\t\t\t\tstart: start\n\t\t\t}]);\n\t\t},view);\n\n\tdata = newData.data;\n\n\tif (action.group == \"column\") {\n\t\tcount = end.column - start.column + 1;\n\t\torigin = start.column;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addColumn(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delColumn(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t} else if (action.group == \"row\") {\n\t\tcount = end.row - start.row + 1;\n\t\torigin = start.row;\n\n\t\tif (action.id == \"add\")\n\t\t\t_addRow(action, start, end, view, e, r, data);\n\t\telse if (action.id == \"del\"){\n\t\t\t_delRow(action, start, end, view, e, r, data);\n\t\t\tcount = -count;\n\t\t}\n\t}\n\n\t//update formulas\n\tvar update = { id:action.group, start:origin, count:count };\n\ti = data.length;\n\twhile (i--) {\n\t\tif (data[i][2] && typeof data[i][2] === \"string\" && data[i][2].substr(0, 1) == \"=\")\n\t\t\tdata[i][2] = updateMath(data[i][2], update);\n\t}\n\n\tview.callEvent(\"onAction\", [\"grid-change\",{value: oldData, newValue: newData} ]);\n\n\tignoreUndo(function() {\n\t\tloadChangedData(view, newData);\n\t\tview._table.scrollTo(state.x, state.y);\n\t},view);\n\n\tif (select){\n\t\tvar grid = view.$$(\"cells\");\n\t\tselect = fixSelectArea(select, grid);\n\t\tif (select)\n\t\t\tgrid.addSelectArea(select.start, select.end);\n\t}\n}\n\nfunction fixSelectArea(select, grid){\n\tvar rows = grid.count();\n\tvar cols = grid.config.columns.length;\n\tif (select.start.row*1 > rows) return null;\n\tif (select.end.row*1 > rows) return null;\n\tif (select.start.column*1 > cols) return null;\n\tif (select.end.column*1 > cols) return null;\n\t\n\treturn select;\n}\n\nfunction loadChangedData(view, data){\n\t// data loading resets undo history, and\n\t// we need to preserve it\n\tignoreReset(function(){\n\t\tview.$handleSelection = null;\n\t\tview.parse(data);\n\t});\n}\n\nfunction getUpdateValues( action, start, end){\n\tvar name = action.group,\n\t\tinc = action.id==\"add\"?1:(action.id==\"del\"?-1:0);\n\n\tif(inc) {\n\t\t// span support\n\t\tif (name == \"row\")\n\t\t\tinc += inc * (end.row - start.row);\n\t\tif (name == \"column\")\n\t\t\tinc += inc * (end.column - start.column);\n\t}\n\treturn {name: name, inc: inc};\n}\n\nfunction _addColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_column_count = end.column - start.column + 1;\n\tview.config.columnCount += add_column_count;\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column)\n\t\t\tdata[i][1] += add_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]); //add item to history\n\telse\n\t\tdata.push(...value); //recovering value which has been deleted\n}\n\nfunction _delColumn(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_column_count = end.column - start.column + 1;\n\n\tif (view.config.columnCount === del_column_count){\n\t\tif (start.column == end.column)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.column--;\n\t\tdel_column_count--;\n\t}\n\n\tview.config.columnCount -= del_column_count;\n\n\n\tview.reset();\n\tlet deleted = []; // for history\n\n\twhile (i--)\n\t\tif (data[i][1] >= start.column && data[i][1] <= end.column)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][1] > end.column)\n\t\t\tdata[i][1] -= del_column_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, deleted]);\n}\n\nfunction _addRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet add_row_count = end.row - start.row + 1;\n\tview.config.rowCount += add_row_count;\n\n\tview.reset();\n\n\twhile (i--)\n\t\tif (data[i][0] >= start.row)\n\t\t\tdata[i][0] += add_row_count;\n\n\tif (!silent) {\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n\t} else {\n\t\tdata.push(...value);\n\t}\n}\n\nfunction _delRow(action, start, end, view, silent, value, data) {\n\tlet i = data.length;\n\tlet del_row_count = end.row - start.row + 1;\n\n\tif (view.config.rowCount === del_row_count){\n\t\tif (start.row == end.row)\n\t\t\treturn; //deleting last column, ignoring\n\t\t//prevent deleting all columns\n\t\tend.row--;\n\t\tdel_row_count--;\n\t}\n\n\tview.config.rowCount -= del_row_count;\n\n\tview.reset();\n\n\tlet deleted = [];\n\twhile (i--)\n\t\tif (data[i][0] >= start.row && data[i][0] <= end.row)\n\t\t\tdeleted.push(data.splice(i, 1)[0]);\n\t\telse if (data[i][0] > end.row)\n\t\t\tdata[i][0] -= del_row_count;\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, deleted]);\n}","import \t\t{methods} \t\tfrom \"./methods\";\nimport * as rgs \t\t\tfrom \"./ranges\";\nimport * as psh \t\t\tfrom \"./placeholder\";\nimport \t\t{changeRange} \tfrom \"../helpers/column_names\";\nimport * as sheets \t\t\tfrom \"./sheet\";\nimport \t\t{_parse} \t\tfrom \"./cache\";\n\n\nexport function init(view){\n\tvar triggers = [];\n\tvar backtrak = [];\n\n\t//math operations object\n\tvar core = get_core(view);\n\n\t//init named ranges\n\tview.ranges = core.ranges = new rgs.Ranges(view);\n\t//init placeholders\n\tcore.p = psh.init(view);\n\n\tview.attachEvent(\"onReset\", () => {\n\t\ttriggers = [];\n\t\tbacktrak = [];\n\t\tview.ranges.clear();\n\t});\n\n\tview.attachEvent(\"onCellChange\", recalckCell);\n\tview.attachEvent(\"onMathRefresh\", recalckAll);\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _dataParse(view, data));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\tvar solvedMath;\n\tvar solvedCounter;\n\t//execute math handler\n\tfunction applyMath(r, c, handler){\n\t\tconst row = view.getRow(r);\n\t\tconst value = _execute(handler, core);\n\t\trow[c] = value;\n\n\t\t\n\t\tconst tkey = c*100000000+r;\n\t\tconst count = solvedCounter[tkey] = (solvedCounter[tkey] || 0) + 1;\n\n\t\tif (solvedMath[tkey] === value || count > 1000){\n\t\t\t//prevent infinity loops\n\t\t\t//if cell was already calculated with the same value, do not recaculate dependent cells\n\t\t\t//in some cases we have have non-stable loop, where value of math is different each time\n\t\t\t//counter limits calculation for 1000 itterations per cell\n\t\t\treturn;\n\t\t}\n\n\t\tsolvedMath[tkey] = value;\n\t\t//check if we have related cells, process their math as well\n\t\tcheck_trigger(r, c);\n\t}\n\n\t//check and run triggers\n\tfunction check_trigger(srow, scolumn){\n\t\t//triggers is a matrix[row][column]\n\t\t//store array of coordinates of related cells\n\n\t\tconst line = triggers[srow];\n\t\tif (line){\n\t\t\tconst block = line[scolumn];\n\t\t\tif (block){\n\t\t\t\tfor (var i = 0; i < block.length; i++){\n\t\t\t\t\tconst {row, column, handler} = block[i];\n\t\t\t\t\tif (row != srow || column != scolumn){\n\t\t\t\t\t\tapplyMath(row, column, handler);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction recalckAll(){\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar state = grid.getState();\n\t\tvar columns = state.ids.concat(state.hidden);\n\n\t\tgrid.eachRow(function(obj){\n\t\t\tvar item = this.getItem(obj);\n\t\t\tfor (var i=1; i<columns.length; i++){\n\t\t\t\tvar key = columns[i];\n\t\t\t\tvar value = item[\"$\"+key];\n\t\t\t\tif (value)\n\t\t\t\t\trecalckCell(obj, key, value);\n\t\t\t}\n\t\t}, true);\n\n\t\tgrid.refresh();\n\t}\n\n\tfunction recalckCell(r,c,value){\n\t\t//check if changed cell was a math cell, based on some other cells\n\t\t//clean triggers in such case\n\t\tvar line = backtrak[r];\n\t\tif (line && line[c])\n\t\t\tremove_triggers(triggers, backtrak, c, r);\n\n\t\t//if new value is a math, calculate it and store triggers\n\t\tif (value){\n\t\t\tvalue = value.toString();\n\t\t\tif(value.length > 1 && value.indexOf(\"=\") === 0){\n\t\t\t\tvar formula = _parse(value, core, \"\");\n\t\t\t\tvar row = view.getRow(r);\n\t\t\t\trow[c] = _execute(formula.handler, core);\n\t\t\t\trow[\"$\"+c] = formula.text;\n\n\t\t\t\tif (formula.triggers.length){\n\t\t\t\t\tadd_triggers(triggers, backtrak, formula.triggers, \n\t\t\t\t\t\t{ row: r, column: c, handler: formula.handler }, view.getActiveSheet());\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t//check if we have some other cells, related to the changed one\n\t\tsolvedMath = {};\n\t\tsolvedCounter = {};\n\t\tcheck_trigger(r, c);\n\t}\n\n\tsheets.init(view, core, { parse: _parse, execute: _execute });\n}\n\nexport function calculate(view, value){\n\tvar core = get_core(view);\n\tvar formula = _parse(value, core, \"\");\n\tvalue = _execute(formula.handler, core);\n\treturn value;\n}\n\n//add new triggers\nfunction add_triggers(trs, back, adds, cell, active){\n\t//trs - matrix of triggers\n\t//back - matrix of backlinks\n\t//adds - list of triggers\n\tvar blist = [];\n\tfor (var i = 0; i < adds.length; i++){\n\t\tvar line = adds[i];\n\t\t//line = [start_row, start_column, end_row, end_column, sheet]\n\n\t\t//ignore triggers from passive cells\n\t\tif (line[4] !== \"\" && line[4] !== active)\n\t\t\tcontinue;\n\n\t\tfor (var j = line[0]; j<=line[2]; j++){\n\t\t\tvar step = trs[j];\n\t\t\tif (!step) step = trs[j]=[];\n\t\t\tfor (var k = line[1]; k <= line[3]; k++){\n\t\t\t\tvar block = step[k];\n\t\t\t\tif (!block)\n\t\t\t\t\tblock = step[k] = [];\n\n\t\t\t\tblist.push([j, k]);\n\t\t\t\tblock.push(cell);\n\t\t\t}\n\t\t}\n\t}\n\n\t//store back-relations, for easy trigger removing \n\tadd_backtrack(back, cell.row, cell.column, blist);\n}\n\n//store backtrack relations as a matrix\nfunction add_backtrack(back, row, column, adds){\n\tvar line = back[row];\n\tif (!line)\n\t\tline = back[row] = [];\n\tline[column] = adds;\n}\n\n//remove unused triggers\nfunction remove_triggers(trs, back, c, r){\n\t//get list of triggers from backtrack structure\n\tvar adds = back[r][c];\n\tback[r][c] = null;\n\n\t//delete triggers\n\tfor (var i = adds.length - 1; i >= 0; i--) {\n\t\tvar cell = adds[i];\n\t\tvar block = trs[cell[0]][cell[1]];\n\t\t\n\t\tfor (var j = block.length-1; j >= 0; j--){\n\t\t\tvar bcell = block[j];\n\t\t\tif (bcell.row == r && bcell.column == c)\n\t\t\t\tblock.splice(j,1);\n\t\t}\n\t}\n}\n\n//run math function\nfunction _execute(formula, core){\n\tvar value;\n\tvar error = webix.i18n.spreadsheet.table[\"math-error\"];\n\ttry {\n\t\tvalue = formula.call(core);\t\n\t} catch(e){\n\t\t//some error in the math code\n\t\treturn error;\n\t}\n\n\tif (typeof value === \"number\"){\n\t\tif(!isFinite(value)) return error;\n\t\t//round values to fix math precision issue in JS\n\t\treturn Math.round(value*100000)/100000;\n\t} else if (typeof value !== \"string\"){\n\t\treturn value ? value.toString() : error;\n\t} else\n\t\treturn value;\n}\n\n//converts cell references to code\nfunction get_core(view){\n\tvar active = sheets.getAccessor(view);\n\n\treturn {\n\t\trs:function(sheet, r1, c1, r2, c2){\n\t\t\treturn sheets.getAccessor(view, sheet).getRange(r1,c1,r2,c2);\n\t\t},\n\t\tr:active.getRange,\n\t\tvs:function(sheet, r, c){\n\t\t\treturn sheets.getAccessor(view, sheet).getValue(r,c);\n\t\t},\n\t\tv:active.getValue,\n\t\tm:methods,\n\t\tp:{}\n\t};\n}\n\nfunction _serialize(view, obj){\n\tobj.ranges = view.ranges.serialize();\n}\n\nfunction _dataParse(view, obj){\n\tview.ranges.parse(obj.ranges);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tvar ranges = data.ranges;\n\tfor(let i=0; i < ranges.length; i++)\n\t\tranges[i][1] = changeRange(ranges[i][1],name,inc, start);\n}","export function init(view){\n\tvar holders = {};\n\n\tview.setPlaceholder = function(obj, value){\n\t\tif (typeof obj === \"object\")\n\t\t\tfor (var key in obj)\n\t\t\t\tholders[key.toLowerCase()] = obj[key];\n\t\telse\n\t\t\tholders[obj.toString().toLowerCase()] = value;\n\n\t\tview.callEvent(\"onMathRefresh\",[]);\n\t};\n\n\treturn holders;\n}","import group from \"./undo_group\";\nimport {calculate} from \"../math/math\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.conditions = {\n\t\t_empty:true,\n\t\t_pull: {},\n\t\thandlers: {\n\t\t\t\">\": function(a,b){\n\t\t\t\treturn a > getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<\": function(a,b){\n\t\t\t\treturn a < getCellValue(view, b);\n\t\t\t},\n\t\t\t\"=\": function(a,b){\n\t\t\t\treturn a == getCellValue(view, b);\n\t\t\t},\n\t\t\t\"!=\": function(a,b){\n\t\t\t\treturn a != getCellValue(view, b);\n\t\t\t},\n\t\t\t\"<>\": function(a,b){\n\t\t\t\tvar first = b[0];\n\t\t\t\tvar second = b[1];\n\t\t\t\treturn webix.isArray(b) && a < getCellValue(view, second) && a > getCellValue(view, first);\n\t\t\t}\n\t\t},\n\t\tadd: add,\n\t\tremove: remove,\n\t\tupdate: update,\n\t\tget: get,\n\t\tparse: parse,\n\t\tserialize: serialize,\n\t\tclear: clear\n\t};\n\n\tview.attachEvent(\"onConditionSet\", (data) => _setCondition(view, data));\n\n\tview.attachEvent(\"onUndo\", (type_action, row, column, value) => {\n\t\tif(type_action == \"condition\")\n\t\t\t_undoCondition(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onDataSerialize\", (data) => _serialize(view, data));\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\n\tview.attachEvent(\"onColumnInit\", (column) => _setCssFormat(view, column));\n\n\tview.attachEvent(\"onReset\", () => view.conditions.clear() );\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\treset(view);\n}\n\nfunction getCellValue(view, value){\n\tif(isNaN(value*1)){\n\t\tif (value.charAt(0) == \"=\"){\n\t\t\tvalue = calculate(view, value);\n\t\t}\n\t}\n\telse {\n\t\tvalue = value*1;\n\t}\n\treturn value;\n}\n\nfunction reset(view){\n\tview.conditions.clear();\n}\n\nfunction _setCondition(view, data){\n\tgroup.set(function(){\n\t\tview.eachSelectedCell((cell) => {\n\t\t\tvar collection = view.conditions.get(cell.row,cell.column);\n\t\t\t_changeCondition(\"update\", cell.row, cell.column, (collection||null), data, view);\n\t\t});\n\t});\n\tview.refresh();\n}\n\nfunction _undoCondition(view, row, column, value){\n\tif(view.conditions.get(row, column))\n\t\tview.conditions.remove(row, column);\n\tif(value)\n\t\tview.conditions.update(row, column, value);\n}\n\nfunction _serialize(view, obj){\n\tobj.conditions = view.conditions.serialize();\n}\n\nfunction _parse(view, obj){\n\tview.conditions.parse(obj.conditions);\n}\n\nfunction _setCssFormat(view,column){\n\tcolumn.cssFormat = function (value, obj, row, column){\n\t\tif (view.conditions._empty) return \"\";\n\n\t\tvar collection, i;\n\t\tcollection = view.conditions.get(row, column);\n\t\tif(!collection)\n\t\t\treturn \"\";\n\n\t\ti = collection.length;\n\t\twhile(i--){\n\t\t\tvar handler = view.conditions.handlers[collection[i][0]];\n\t\t\tif(handler && handler(obj[column],collection[i][1]))\n\t\t\t\treturn collection[i][2];\n\t\t}\n\t\treturn \"\";\n\t};\n}\n\n\nfunction addEmptyCollection(pull, row, column, state){\n\tstate._empty = false;\n\tif(!pull[row])\n\t\tpull[row] = {};\n\tif(!pull[row][column])\n\t\tpull[row][column] = [];\n\treturn pull[row][column];\n}\n\n\nfunction parse(data){\n\tthis._empty = true;\n\tif (!data) return;\n\n\tlet i = data.length;\n\twhile(i--){\n\t\tvar c = data[i];\n\t\tvar collection = addEmptyCollection(this._pull,c[0],c[1],this);\n\t\tcollection.push([c[2],c[3],c[4]]);\n\t}\n}\n\nfunction clear(){\n\tthis._pull = {};\n}\n\nfunction update(row, column, newData){\n\tvar collection = this.get(row, column);\n\tif(!collection)\n\t\taddEmptyCollection(this._pull, row, column, this);\n\tthis._pull[row][column] = newData;\n}\n\nfunction get(rowId, columnId){\n\tif(!rowId)\n\t\treturn this._pull;\n\tif(!columnId)\n\t\treturn this._pull[rowId];\n\treturn this._pull[rowId]?this._pull[rowId][columnId]:null;\n}\n\nfunction add(rowId, columnId, condition, value, style){\n\tvar collection = addEmptyCollection(this._pull, rowId, columnId, this);\n\tcollection.push([condition, value, style]);\n}\n\nfunction remove(rowId, columnId){\n\tvar collection = this.get(rowId, columnId);\n\tif(collection)\n\t\tdelete this._pull[rowId][columnId];\n}\n\nfunction serialize(){\n\tvar column, condition, i, row,\n\t\tdata = [];\n\n\tfor( row in this._pull)\n\t\tfor( column in this._pull[row])\n\t\t\tfor(i=0; i < this._pull[row][column].length; i++){\n\t\t\t\tcondition = this._pull[row][column][i];\n\t\t\t\tdata.push([row,column, condition[0],condition[1],condition[2]]);\n\t\t\t}\n\n\treturn data;\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet conditions = data.conditions,\n\t\ti = conditions.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = conditions[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\tconditions.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tconditions[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tconditions.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tconditions[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport function clearConditionalFormats(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tvar condition = view.conditions.get(cell.row, cell.column);\n\t\t\tif(condition)\n\t\t\t\t_changeCondition(\"remove\", cell.row, cell.column, condition, null, view);\t\t\t\t\n\t\t});\n\t\tview.refresh();\n\t});\n}\n\nexport function pasteCondition(view, extra, row, col, cutted){\n\tvar condition = extra.condition;\n\tvar collection = view.conditions.get(row,col);\n\t_changeCondition(\"update\", row, col, (collection||null), condition, view);\n\tif(cutted === 1)\n\t\t_changeCondition(\"remove\", extra.row, extra.col, condition, null, view);\t\n\t\t\t\n}\n\nexport function _changeCondition(name, row, column, oldCondition, newCondition, view){\n\tif (view.callEvent(\"onBeforeConditionSet\", [row, column, oldCondition, newCondition])){\n\t\tview.conditions[name].apply(view.conditions, [row, column, newCondition]);\n\t\tview.callEvent(\"onAfterConditionSet\", [row, column, oldCondition, newCondition]);\n\t}\n}","import {rangeValue} from \"../math/ranges\";\nimport {changeRange, eachRange} from \"../helpers/column_names\";\nimport {toRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\tview.attachEvent(\"onReset\", () => reset(view));\n\n\treset(view);\n\ttable.attachEvent(\"onBeforeEditStart\", function(id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tif (this._ssEditors[id.row]){\n\t\t\tlet ed = this._ssEditors[id.row][id.column];\n\t\t\tif (ed){\n\t\t\t\twebix.extend(col, ed, true);\n\t\t\t\tif (ed.options){\n\t\t\t\t\tif (typeof ed.options == \"string\")\n\t\t\t\t\t\tcol.options = rangeValue(view, ed.options, { unique: true, empty:true, order:true, filter: ed.useAsFilter });\n\t\t\t\t\telse if(webix.isArray(ed.options))\n\t\t\t\t\t\tcol.options = rangeValue(view, ed.options, { empty:true, filter: ed.useAsFilter });\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n\ttable.attachEvent(\"onAfterEditStop\", function(state, id){\n\t\tlet col = this.getColumnConfig(id.column);\n\t\tcol.editor = \"text\";\n\t\tdelete col.popup;\n\t\tdelete col.$popup;\n\n\t\tif (isFilter(view, id.row, id.column))\n\t\t\treturn view.filterSpreadSheet();\n\t});\n\n\ttable.on_click.ss_filter = function(e, id){\n\t\tthis.edit(id);\n\t};\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction reset(view){\n\tview._table._ssEditors = {};\n\tview._table._ssFilters = {};\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\ttblEditors = view._table._ssEditors,\n\t\teditors = [];\n\n\tfor(row in tblEditors){\n\t\tfor(column in tblEditors[row]){\n\t\t\tif(!isFilter(view, row, column))\n\t\t\t\teditors.push([row, column, tblEditors[row][column]]);\n\t\t}\n\t}\n\tdata.editors = editors;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\teditors = data.editors;\n\n\tif(editors)\n\t\tfor(i = 0; i < editors.length; i++)\n\t\t\tview.setCellEditor.apply(view,editors[i]);\n}\n\n\n\n\nexport function clearEditors(view, range){\n\tvar refilter = false;\n\n\tview._table.editStop();\n\teachRange(range, view, function(view, cell){\n\t\tlet editor = view._table._ssEditors[cell.row];\n\t\tlet filter = view._table._ssFilters[cell.row];\n\n\t\tif (editor){\n\t\t\tif (editor[cell.column]){\n\t\t\t\tdelete editor[cell.column];\n\t\t\t\tview._table.removeCellCss(cell.row, cell.column, \"ss_filter\");\n\t\t\t}\n\t\t}\n\t\tif (filter){\n\t\t\tif (filter[cell.column]){\n\t\t\t\tdelete filter[cell.column];\n\t\t\t\trefilter = true;\n\t\t\t}\n\t\t}\n\t});\n\n\tif (refilter)\n\t\tview.filterSpreadSheet();\n}\n\n\n\nexport function isFilter(view, row, column){\n\tvar filters = view._table._ssFilters;\n\treturn filters[row] && filters[row][column];\n}\n\nexport function addCellFilter(view, row, column, initial){\n\tvar filters = view._table._ssFilters;\n\tvar line = filters[row] = filters[row] || {};\n\tline[column] = [row,column];\n\n\tview.callEvent(\"onAction\", [\"addFilter\", { row, column }]);\n\tif(!initial && view.getCellValue(row,column) != \"\")\n\t\tview.setCellValue(row,column,\"\");\n}\n\n// called on column/row add, delete, hide,show\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\teditors = data.editors;\n\n\tif(inc){\n\t\t// create new editors\n\t\tfor(i = editors.length-1;i >=0;i--){\n\t\t\tlet [row,column,editor] = editors[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\t//make copy of editor object\n\t\t\t\teditor = editors[i][2] = webix.copy(editor);\n\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete lock mark if row was deleted\n\t\t\t\t\t\teditors.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\teditors[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\teditors.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\teditors[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t\teditor.options = changeRange(editor.options, name, inc, start);\n\t\t}\n\t}\n}\n\nexport function pasteDropdown(view, extra, row, col, cutted, translate, updateFilters){\n\tvar editor = extra.dropdown.editor;\n\tif(extra.dropdown.filter){\n\t\tif(updateFilters){\n\t\t\tvar  options = changeRange(editor.options, \"row\", translate.row, {column:extra.col, row:extra.row});\n\t\t\toptions = changeRange(options, \"column\", translate.column, {column:extra.col, row:extra.row});\n\t\t\tview.setCellFilter(row, col, options);\n\t\t\tview.callEvent(\"onAction\", [\"filter\", { row, column:col, value:null, newValue:{options:options} }]);\n\t\t}\n\t}\n\telse {\n\t\tview.setCellEditor(row, col, editor);\n\t\tif(cutted === 1)\n\t\t\tview.setCellEditor(extra.row, extra.col, {});\n\t}\n}\n\nexport function setFilter(view, row, column, range, initial){\n\tif(!range)\n\t\trange = {end:{row:row}};\n\n\tif (range.end){\n\t\tvar endRow = range.end.row;\n\t\trange = getFilterRange(view, row, column, endRow);\n\t}\n\tview.setCellEditor(row,column, { editor:\"richselect\", options: range, useAsFilter:true });\n\taddCellFilter(view, row, column, initial);\n}\n\nfunction getFilterRange(view,  row, column, endRow){\n\tif (row === endRow){\n\t\tfor (endRow = row; endRow < view.config.rowCount; endRow++){\n\t\t\tif(!view.getCellValue(endRow+1,column))\n\t\t\t\tbreak;\n\t\t}\n\t}\n\treturn toRange(row+1, column, endRow, column);\n}","import group from \"./undo_group\";\nimport {updateMath} from \"../math/updater\";\nimport {pasteCondition} from \"../operations/conditional_formats\";\nimport {isFilter, pasteDropdown} from \"../operations/dropdown\";\nimport {pasteSpan} from \"../operations/spans\";\n\nvar styledata, clipdata, origin, cutted, updateFilters;\n\nexport function init(view){\n\tconst keyC = 67; //keyboard 'c' code\n\tconst keyX = 88; //keyboard 'x' code\n\tvar grid = view.$$(\"cells\");\n\t\n\tgrid.attachEvent(\"onKeyPress\", (code, e) => {\n\t\tif((code === keyC || code === keyX) && (e.ctrlKey || e.metaKey) && grid.getSelectedId()){\n\t\t\tstyledata = _get_sel_style(view, grid);\n\t\t\tclipdata = document.getElementsByClassName(\"webix_clipbuffer\")[0].value;\n\t\t\torigin = grid.getSelectArea();\n\t\t\tcutted = (code === keyX)*1;\n\t\t\tif(cutted && Object.keys(view._table._ssFilters).length !== 0)\n\t\t\t\tupdateFilters = allFiltersInZone(view._table._ssFilters, origin, view.config.columnCount);\n\t\t}\n\t});\n\n\tif (!view.config.readonly) {\n\t\tgrid.attachEvent(\"onPaste\", (text) => {\n\t\t\t_clip_to_sel(view, grid, text);\n\t\t});\n\t}\n}\n\nfunction _clip_to_sel(view, grid, text){\n\tvar leftTop = grid.getSelectArea();\n\tif (!leftTop) return;\n\tvar start = leftTop.start;\n\tvar fromSheet = text === clipdata;\n\n\tvar data = fromSheet ? styledata : webix.csv.parse(text, grid.config.delimiter);\n\tif(!fromSheet && view.config.clipboardDecimalDelimiter)\n\t\tdata = _changeDelimiter(data, view.config.clipboardDecimalDelimiter);\n\n\tvar translate = { id:\"move\", column:0, row: 0, cut:cutted };\n\tif (fromSheet){\n\t\ttranslate.column = start.column - origin.start.column;\n\t\ttranslate.row = start.row - origin.start.row;\n\t} else {\n\t\tcutted = 0;\n\t}\n\n\tgroup.set(function(){\n\t\tif (updateFilters)\n\t\t\tview.removeFilter();\n\n\t\t_add_row_col(view, start, data);\n\n\t\tif (cutted === 1) {\n\t\t\tfor (let row = origin.start.row; row <= origin.end.row; row++) {\n\t\t\t\tfor (let column = origin.start.column; column <= origin.end.column; column++) {\n\t\t\t\t\tview.setCellValue(row, column, null);\n\t\t\t\t\tview.setStyle(row, column, null);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (data.length == 1 && data[0].length == 1 && !updateFilters) {\n\t\t\tview.eachSelectedCell(function(cell) {\n\t\t\t\tvar subtrans = {\n\t\t\t\t\tid: \"move\",\n\t\t\t\t\tcolumn: translate.column + cell.column * 1 - start.column,\n\t\t\t\t\trow: translate.row + cell.row * 1 - start.row,\n\t\t\t\t\tcut:cutted\n\t\t\t\t};\n\t\t\t\t_clipboardToTable(view, cell.row, cell.column, data[0][0], fromSheet, subtrans);\n\t\t\t});\n\t\t} else {\n\t\t\tgrid.mapCells(\n\t\t\t\tstart.row,\n\t\t\t\tstart.column,\n\t\t\t\tdata.length,\n\t\t\t\tnull,\n\t\t\t\tfunction(value, row, col, row_ind, col_ind) {\n\t\t\t\t\tif (data[row_ind] && data[row_ind].length > col_ind) {\n\t\t\t\t\t\tvar cdata = data[row_ind][col_ind];\n\t\t\t\t\t\t_clipboardToTable(view, row, col, cdata, fromSheet, translate);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\ttrue\n\t\t\t);\n\t\t}\n\n\t\tif (cutted === 1){\n\t\t\t//cut and cleared\n\t\t\tcutted = 2;\n\t\t\tupdateFilters = false;\n\t\t}\n\t});\n\t\n\tview.refresh();\n}\n\nfunction _clipboardToTable(view, row, col, cdata, fromSheet, translate){\n\n\tvar newValue = cdata;\n\tvar style = null;\n\n\tif (typeof cdata === \"object\"){\n\t\tif (cdata.math)\n\t\t\tnewValue = updateMath(cdata.math, translate, origin);\n\t\telse \n\t\t\tnewValue = cdata.text;\n\n\t\tstyle = cdata.style;\n\t\tview.setStyle(row, col, style);\n\n\t\tvar extra = cdata.extra;\n\t\tif(extra){\n\t\t\tif(extra.condition)\n\t\t\t\tpasteCondition(view, extra, row, col, cutted);\n\t\t\tif(extra.dropdown)\n\t\t\t\tpasteDropdown(view, extra, row, col, cutted, translate, updateFilters);\n\t\t}\n\t\tpasteSpan(view, extra, row, col, cutted, translate);\n\t}\n\n\tview.setCellValue(row, col, newValue);\n}\n\nfunction _get_sel_style(view, grid){\n\tvar data = [];\n\tvar row, last;\n\n\tgrid.mapSelection(function(value, id, col) {\n\t\tif (id != last){\n\t\t\trow = []; data.push(row);\n\t\t\tlast = id;\n\t\t}\n\n\t\tvar item = grid.getItem(id);\n\t\tvar math = item[\"$\"+col];\n\t\tvar obj = { text:value, math:math, style:view.getStyle(id, col)};\n\n\t\tvar condition = view.conditions.get(id,col);\n\t\tvar editor = view.getCellEditor(id, col);\n\t\tvar span = view._table.getSpan(id, col);\n\n\t\tif (editor || condition || span){\n\t\t\tvar extra = { row:id, col:col };\n\t\t\tif (condition) extra.condition = condition;\n\t\t\tif (editor) extra.dropdown = { editor:editor, filter: !!isFilter(view, id, col) };\n\t\t\tif (span) extra.span = span;\n\t\t\tobj.extra = extra;\n\t\t}\n\t\t\n\t\trow.push(obj);\n\t\treturn value;\n\t});\n\n\treturn data;\n}\n\nfunction allFiltersInZone(extra, origin, columnCount){\n\tvar filters = Object.keys(extra);\n\tvar startRow = Math.min.apply(null, filters);\n\tvar endRow = Math.max.apply(null, filters);\n\tvar startCol = columnCount;\n\tvar endCol = 1;\n\n\tfor (var i = startRow; i <= endRow; i++){\n\t\tif(extra[i]){\n\t\t\tvar columns = Object.keys(extra[i]);\n\t\t\tstartCol = Math.min(startCol, Math.min.apply(null, columns));\n\t\t\tendCol = Math.max(endCol, Math.max.apply(null, columns));\n\t\t}\n\t}\n\n\tif(origin.start.row <= startRow && origin.end.row >= endRow && origin.start.column <= startCol && origin.end.column >= endCol)\n\t\treturn true;\n\telse\n\t\treturn false;\n}\n//dynamically increase rows and columns according to pasted data size\nfunction _add_row_col(view, start, data){\n\tvar maxRow = start.row + data.length - 1;\n\tvar maxCol = start.column + data[0].length - 1;\n\n\tif(maxRow > view.config.rowCount || maxCol > view.config.columnCount){\n\t\tvar action = { id:\"add\" };\n\t\tif (maxRow > view.config.rowCount) {\n\t\t\taction.group = \"row\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ row: view.config.rowCount + 1 }, \n\t\t\t\t{ row: maxRow }\n\t\t\t]);\n\t\t}\n\t\tif (maxCol > view.config.columnCount) {\n\t\t\taction.group = \"column\";\n\t\t\tview.callEvent(\"onCommand\", [\n\t\t\t\taction, \n\t\t\t\t{ column: view.config.columnCount + 1 },\n\t\t\t\t{ column: maxCol }\n\t\t\t]);\n\t\t}\n\t}\n}\n\nfunction _changeDelimiter(data, clipboardDecimalDelimiter){\n\tfor(var i = 0; i < data.length; i++)\n\t\tfor(var k = 0; k < data[i].length; k++){\n\t\t\tvar record = data[i][k].toString().replace(clipboardDecimalDelimiter, \".\");\n\t\t\tif(webix.rules.isNumber(record))\n\t\t\t\tdata[i][k] = record;\n\t\t}\n\treturn data;\n}","export function init(view){\n\t//parsing initial data\n\tview.attachEvent(\"onDataParse\", (data) => _parse(view, data));\n\tview.attachEvent(\"onDataSerialize\", (data, config) => _serialize(view, data, config));\n\n\t// undo\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif(type == \"value\")\n\t\t\t_undoValue(view, row, column, value);\n\t});\n}\n\nfunction _serialize(view, obj, config){\n\tvar math = !config || config.math!==false;\n\tvar data = [];\n\tvar grid = view.$$(\"cells\");\n\tvar state = grid.getState();\n\tvar columns = state.ids.concat(state.hidden);\n\n\t// remove \"rowId\" column\n\tcolumns.splice(columns.indexOf(\"rowId\"), 1);\n\n\tgrid.eachRow(function(obj){\n\t\tvar item = this.getItem(obj);\n\t\tfor (var i=0; i<columns.length; i++){\n\t\t\tvar key = columns[i];\n\t\t\tvar value = item[key];\n\t\t\tvar css = item.$cellCss ? (item.$cellCss[key] || \"\") : \"\";\n\n\t\t\t//serialize instead of value if defined\n\t\t\tif (math)\n\t\t\t\tvalue = item[\"$\"+key] || value;\n\n\t\t\t//put not empty values in serialization\n\t\t\tvar hasValue = value || value === 0;\n\t\t\tif (hasValue || css) {\n\t\t\t\tdata.push([obj*1, key*1, (hasValue ? value : \"\"), css]);\n\t\t\t}\n\t\t}\n\t}, true);\n\n\tobj.table = {\n\t\tfrozenColumns : (view._frozenColumns || 0),\n\t\tfrozenRows : (view._frozenRows || 0)\n\t};\n\n\tobj.data = data;\n}\n\nfunction _parse(view, obj){\n\tvar grid = view.$$(\"cells\");\n\n\tvar tconfig = obj.table || { frozenColumns : 0, frozenRows : 0 };\n\tview._frozenColumns = view._frozenRows = 0;\n\tif (tconfig){\n\t\tif (!webix.isUndefined(tconfig.frozenColumns) && (tconfig.frozenColumns+1) != grid.config.leftSplit)\n\t\t\tview.freezeColumns(tconfig.frozenColumns);\n\t\tif (!webix.isUndefined(tconfig.frozenRows) && tconfig.frozenRows != grid.config.topSplit)\n\t\t\tview.freezeRows(tconfig.frozenRows);\n\t}\n\n\tif(obj.sizes)\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\tfor (var i = 0; i < obj.data.length; i++){\n\t\tvar [ row, column, value, style] = obj.data[i];\n\n\t\tvar item = grid.getItem(row);\n\t\titem[column] = value;\n\t\tif (style){\n\t\t\titem.$cellCss = item.$cellCss || {};\n\t\t\titem.$cellCss[column] = style;\n\t\t}\n\t\tview.callEvent(\"onCellChange\", [row, column, value]);\n\t}\n}\n\nfunction _undoValue(view, row, column, value){\n\tview.setCellValue(row, column, value);\n}\n","export function init(view) {\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tif (action.id == \"show\" || action.id == \"hide\"){\n\t\t\tvar sel = view._table.getSelectArea();\n\t\t\tif (sel)\n\t\t\t\tprocess(action, sel.start, sel.end, view);\n\t\t}\n\t});\n\treset(view);\n\n\tview.attachEvent(\"onUndo\", (action, row, column, value, direction) => {\n\t\tif ((action.id == \"hide\" || action.id == \"show\") && (action.group == \"column\" || action.group == \"row\")){\n\t\t\tvar type = action.id;\n\t\t\tif (!direction)\n\t\t\t\ttype = type == \"hide\" ? \"show\" : \"hide\";\n\t\t\tvar obj = (row || column);\n\t\t\tprocess({ id: type, group: action.group }, obj.start, obj.end, view, true);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onHardReset\", () => reset(view));\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\t_updatePosition(view, p.name,p.inc,p.data, p.start);\n\t});\n}\n\n\nexport function reset(view, mode) {\n\tif(mode) view[\"_hidden_\"+mode+\"_hash\"] = {};\n\telse{\n\t\tview._hidden_cols_hash = {};\n\t\tview._hidden_rows_hash = {};\n\t}\n}\n\nfunction getIds(id){\n\treturn webix.isArray(id)?id: [id, id];\n}\n\nexport function setColumnState(view, column, state){\n\t// hide\n\tif(!column){\n\t\tlet sel = view.getSelectedId(true),\n\t\t\taction = {id:state === false?\"show\":\"hide\", group:\"column\"};\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse{\n\t\tlet ids = getIds(column);\n\t\tif(!view._hidden_cols_hash[ids[0]] && (webix.isUndefined(state)||state)){\n\t\t\t_hideColumn({id: \"hide\", group: \"column\"}, {column:ids[0]}, {column:ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if(view._hidden_cols_hash[ids[0]] && (webix.isUndefined(state)|| !state)){\n\t\t\tvar inc = ids[0]>1?1:-1;\n\t\t\t_showColumn({id: \"show\", group: \"column\"},  {column:ids[0]+inc},  {column:ids[1]+inc}, view);\n\t\t}\n\t}\n\n}\nexport function isColumnVisible(view, column){\n\treturn !view._hidden_cols_hash[column];\n}\n\nexport function setRowState(view, row, state){\n\t// hide\n\tif(!row){\n\t\tlet sel = view.getSelectedId(true),\n\t\t\taction = {id:state === false?\"show\":\"hide\", group:\"row\"};\n\t\tif(sel.length)\n\t\t\tview.callEvent(\"onCommand\", [action, sel[0], sel[sel.length-1]]);\n\t}\n\telse {\n\t\tlet ids = getIds(row);\n\t\tif (!view._hidden_rows_hash[ids[0]] && (webix.isUndefined(state) || state)) {\n\t\t\t_hideRow({id: \"hide\", group: \"row\"}, {row: ids[0]}, {row: ids[1]}, view);\n\t\t}\n\t\t// show\n\t\telse if (view._hidden_rows_hash[ids[0]] && (webix.isUndefined(state) || !state)) {\n\t\t\tvar inc = ids[0] > 1 ? 1 : -1;\n\t\t\t_showRow({id: \"show\", group: \"row\"}, {row: ids[0] + inc}, {row: ids[1] + inc}, view);\n\t\t}\n\t}\n}\n\nexport function isRowVisible(view, row){\n\treturn !view._hidden_rows_hash[row];\n}\n\nexport function serialize(view, data){\n\tvar hrows  = []; var hcols = [];\n\tfor(var r in view._hidden_rows_hash) hrows.push(r);\n\tfor(var c in view._hidden_cols_hash) hcols.push(c);\n\n\tif(hrows.length || hcols.length)\t\n\t\tdata.table.hidden = {};\n\tif(hrows.length)\n\t\tdata.table.hidden.row = hrows;\n\tif(hcols.length)\n\t\tdata.table.hidden.column = hcols;\n}\n\nexport function load(view, data){\n\treset(view);\n\t\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.hidden)){\n\t\tvar hidden = data.table.hidden;\n\n\t\tif(hidden.row && hidden.row.length){\n\t\t\tfor(var r = 0; r<hidden.row.length; r++)\n\t\t\t\t_hideRow({id:\"hide\", group:\"row\"}, {row:hidden.row[r]}, {row:hidden.row[r]}, view, true);\n\t\t}\n\n\t\tif(hidden.column && hidden.column.length){\n\t\t\tfor(var c = 0; c<hidden.column.length; c++)\n\t\t\t\t_hideColumn({id:\"hide\", group:\"column\"}, {column:hidden.column[c]}, {column:hidden.column[c]}, view, true);\n\t\t}\n\t}\n}\n\nfunction process(action) {\n\tif (action.group == \"column\"){\n\t\tif (action.id == \"show\")\n\t\t\t_showColumn.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideColumn.apply(this, arguments);\n\t} else if (action.group == \"row\") {\n\t\tif (action.id == \"show\")\n\t\t\t_showRow.apply(this, arguments);\n\t\telse if (action.id == \"hide\")\n\t\t\t_hideRow.apply(this, arguments);\n\t}\n}\n\nfunction _showColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tconst grid = view.$$(\"cells\");\n\n\twhile (i >= start.column) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_cols_hash[i*1-1] || view._hidden_cols_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_cols_hash[id];\n\t\t\tlet cell = grid.getColumnConfig(id - 1 || \"rowId\").header[0];\n\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_column\", \"\");\n\t\t\tgrid.showColumn(id);\n\t\t\tstart.column = start.column < id ? start.column : id;\n\t\t\tend.column = end.column > id ? end.column : id;\n\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onColumnOperation\", [action, { column: id }, { column:id }, null]);\n\t\t}\n\t\ti--;\n\t}\n}\n\nfunction _showRow(action, start, end, view, silent) {\n\tlet i = end.row;\n\tconst grid = view.$$(\"cells\");\n\n\tconst split = view._frozenRows;\n\tif(split+1 >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tlet id = i;\n\t\tif (!silent)\n\t\t\tid = view._hidden_rows_hash[i*1-1] || view._hidden_rows_hash[i*1+1] || false;\n\n\t\tif (id !== false) {\n\t\t\tdelete view._hidden_rows_hash[id];\n\t\t\tif (id - 1 === 0) {\n\t\t\t\tlet cell = view.$$(\"cells\").getColumnConfig(\"rowId\").header[0];\n\t\t\t\tcell.css = cell.css.replace(\"webix_ssheet_hide_row\", \"\");\n\t\t\t\tgrid.refreshColumns();\n\t\t\t} else {\n\t\t\t\tgrid.removeCellCss(id - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t\t}\n\t\t\tif (!silent)\n\t\t\t\tview.callEvent(\"onRowOperation\", [action, { row: id }, { row: id }, null]);\n\t\t}\n\t\ti--;\n\t}\n\n\tgrid.filter(function(obj) {\n\t\treturn !view._hidden_rows_hash[obj.id];\n\t});\n\n\tif(split+1 >= start.row)\n\t\tview.freezeRows(split);\n}\n\nfunction _hideColumn(action, start, end, view, silent) {\n\tlet i = end.column;\n\tview.$handleSelection = null;\n\tview.$$(\"cells\").unselect();\n\n\tif (end.column<1 || start.column<1){\n\t\tdelete view._hidden_cols_hash[start.column];\n\t\treturn;\n\t}\n\twhile (i >= start.column) {\n\t\tview._hidden_cols_hash[i] = i;\n\n\t\tlet cell = view.$$(\"cells\").getColumnConfig(i - 1 || \"rowId\").header[0];\n\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_column\";\n\n\n\t\tview.$$(\"cells\").hideColumn(i);\n\t\ti--;\n\t}\n\n\tif (!silent)\n\t\tview.callEvent(\"onColumnOperation\", [action, start, end, null]);\n}\n\nfunction _hideRow(action, start, end, view, silent) {\n\tconst grid = view.$$(\"cells\");\n\tlet i = end.row;\n\tif (end.row<1 || start.row<1){\n\t\tdelete view._hidden_rows_hash[start.row];\n\t\treturn;\n\t}\n\n\tconst split = view._frozenRows;\n\tif(split >= start.row){\n\t\t//Frozen rows ignore filtering applied to the datatable\n\t\tview.freezeRows(0);\n\t}\n\n\twhile (i >= start.row) {\n\t\tview._hidden_rows_hash[i] = i;\n\n\t\tif (i - 1 === 0) {\n\t\t\tlet cell = grid.getColumnConfig(\"rowId\").header[0];\n\t\t\tcell.css = (cell.css || \"\") + \" webix_ssheet_hide_row\";\n\t\t\tgrid.refreshColumns();\n\t\t} else {\n\t\t\tgrid.addCellCss(i - 1, \"rowId\", \"webix_ssheet_hide_row\");\n\t\t}\n\t\ti--;\n\t}\n\n\tgrid.filter(function(obj) {\n\t\treturn !view._hidden_rows_hash[obj.id];\n\t});\n\n\tif(split >= start.row)\n\t\tview.freezeRows(split);\n\n\tif (!silent)\n\t\tview.callEvent(\"onRowOperation\", [action, start, end, null]);\n}\n\nfunction _updatePosition(view, name, inc, data, start){\n\n\tif(data.table && data.table.hidden && data.table.hidden[name] && data.table.hidden[name].length){\n\t\tif(name ===\"column\") reset(view, \"cols\");\n\t\tif(name === \"row\") reset(view, \"rows\");\n\n\t\tvar s = start[name], e = s + inc; \n\t\tif(s>e) [s, e] = [e, s];\n\n\t\tfor(var i = s; i<e; i++){\n\t\t\tfor(var h = 0; h<data.table.hidden[name].length; h++){\n\t\t\t\tif(data.table.hidden[name][h] >= i)\n\t\t\t\t\tdata.table.hidden[name][h] = data.table.hidden[name][h]*1+(inc>0? 1: -1);\n\t\t\t}\n\t\t}\n\t}\n}\n\n","import {getStyle, getTextSize} from \"./styles\";\nimport {save} from \"./save\";\n\nexport function init(view){\n\n\tif (view.config.resizeCell){\n\t\tvar grid = view.$$(\"cells\");\n\t\tgrid.define(\"resizeRow\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"resizeColumn\", { headerOnly: true, size: 10 });\n\t\tgrid.define(\"fixedRowHeight\", false);\n\n\t\tgrid.attachEvent(\"onRowResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: id, column: 0, size: view.getRow(id).$height });\n\t\t});\n\t\tgrid.attachEvent(\"onColumnResize\", (id) => {\n\t\t\tview.$$(\"cells\").refreshSelectArea();\n\t\t\tsave(view, \"sizes\", { row: 0, column: id, size: view.getColumn(id).width });\n\t\t});\n\n\t\t// undo\n\t\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\t\tif(type == \"c-resize\" || type == \"r-resize\")\n\t\t\t\t_undoResize(view, row, column, value);\n\t\t});\n\t}\n\n\tview.attachEvent(\"onDataParse\", (data) => {\n\t\tif (data.sizes){\n\t\t\tfor (var i=0; i<data.sizes.length; i++){\n\t\t\t\tvar size = data.sizes[i];\n\t\t\t\tif (size[0]*1 !== 0){\n\t\t\t\t\tvar row = view.getRow(size[0]);\n\t\t\t\t\tif(row) row.$height = size[2]*1;\n\t\t\t\t} else {\n\t\t\t\t\tvar col = view.getColumn(size[1]);\n\t\t\t\t\tif(col) col.width = size[2]*1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (data.sizes.length)\n\t\t\t\tview.refresh(true);\n\t\t}\n\t});\n\n\t\n\tview.attachEvent(\"onDataSerialize\", (data) => {\n\t\tvar sizes = [];\n\t\tvar grid = view.$$(\"cells\");\n\t\tvar columns = grid.getState().order;\n\t\tvar order = grid.data.order;\n\n\t\tvar defWidth = grid.config.columnWidth;\n\t\tvar defHeight = grid.config.rowHeight;\n\n\t\tfor (let i = 1; i < columns.length; i++){\n\t\t\tvar width = grid.getColumnConfig(columns[i]).width;\n\t\t\tif (width && width != defWidth)\n\t\t\t\tsizes.push([0, i, width]);\n\t\t}\n\n\t\tfor (let i = 0; i < order.length; i++){\n\t\t\tvar height = grid.getItem(order[i]).$height;\n\t\t\tif (height && height != defHeight)\n\t\t\t\tsizes.push([order[i]*1, 0, height]);\n\t\t}\n\t\t\n\t\tdata.sizes = sizes;\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n\n\tview.attachEvent(\"onBeforeStyleChange\", function(row, column, n, o){\n\t\tif (o && o.props.wrap === \"wrap\" && (!n || n.props.wrap != o.props.wrap)){\n\t\t\tdelete view._table.getItem(row).$height;\n\t\t}\n\t});\n\tview.attachEvent(\"onStyleChange\", _adjustRowHeight);\n\tview.attachEvent(\"onCellChange\",  _adjustRowHeight);\n}\n\nfunction _undoResize(view, row, column, value){\n\tif(row){\n\t\tview.$$(\"cells\").getItem(row).$height = value;\n\t\tsave(view, \"sizes\", { row:row, column: 0, size: value });\n\t}\n\telse{\n\t\tview._table.setColumnWidth(column, value);\n\t}\n\t// update area selection\n\tview._table.refreshSelectArea();\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tsizes = data.sizes,\n\t\tnsizes = [];\n\n\tif(inc){\n\t\tfor(i = sizes.length-1;i >=0;i--){\n\t\t\tlet [row,column,size] = sizes[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\t//moving row|column index\n\t\t\t\trow =  name == \"row\"?row*1 + inc:row;\n\t\t\t\tcolumn = name == \"column\"?column*1 + inc:column;\n\t\t\t\tif((name == \"row\" && row>0) || (name == \"column\" && column >0))\n\t\t\t\t\tnsizes.push([row, column, size]);\n\t\t\t} else //row, column not affected by resize\n\t\t\t\tnsizes.push(sizes[i]);\n\t\t}\n\t\tdata.sizes = nsizes;\n\t}\n}\n\nfunction _adjustRowHeight(row, column){\n\tconst view = this;\n\tlet style = getStyle(view, {row:row, column:column});\n\n\t//changing styles or content of wrapped cell -> resize the related row\n\tif (style && style.props.wrap){\n\t\tlet item = view._table.getItem(row);\n\t\tlet height = item.$height || view._table.config.rowHeight;\n\n\t\tview._table.eachColumn(function(col, config){\n\t\t\tlet style = getStyle(view, {row:row, column:col});\n\t\t\t//include only cells with active wrap into calculation \n\t\t\tif(style && style.props && style.props.wrap === \"wrap\"){\n\t\t\t\tlet text = this.getText(row, col);\n\t\t\t\theight = Math.max(height, getTextSize(view, text, style.id, config.width).height);\n\t\t\t}\n\t\t});\n\n\t\titem.$height  = height;\n\t}\n}\n","import {encode} from \"../helpers/column_names\";\n\nexport function init(view){\n\tvar table = view._table;\n\n\tvar bs = 0;\n\ttable.attachEvent(\"onAreaDrag\", () => bs = new Date());\n\ttable.attachEvent(\"onBeforeAreaRemove\", function(){\n\t\t//[FIXME] currently we don't have enough info to know\n\t\t//is user selects new area, and removing need to be blocked\n\t\t//or is it some API which attempts to remove the area\n\t\tif (view.$handleSelection && (new Date() - bs)<500) return false;\n\t});\n\n\ttable.attachEvent(\"onBeforeAreaAdd\", (area) => {\n\t\t//[FIXME] \n\t\t//block selection of row-id column\n\t\t//temporary fix, we need to fire onBeforeBlockSelect when selection moves\n\t\t//so the common onBeforeBlockSelect handler will block rowId selection\n\t\tif (area.start.column == \"rowId\") return false;\n\n\t\t//if we have an active editor, we need to close it on block selection\n\t\t//ignore, when selecting the editor's cell\n\t\tvar editor = table.getEditor();\n\t\tif (editor && (\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ||\n\t\t\teditor.row != area.start.row || editor.column != area.start.column ))\n\t\t\ttable.editStop();\n\n\t\tif (!view.$handleSelection) return true;\n\t\t\n\n\t\tlet blockStart = encode[area.start.column] + area.start.row;\n\t\tlet blockEnd = encode[area.end.column] + area.end.row;\n\n\t\tvar res = view.$handleSelection(area.start, area.end, blockStart, blockEnd);\n\n\t\tif (res !== false){\n\t\t\tview.$handleSelection = null;\n\t\t\ttable.removeSelectArea();\n\t\t}\n\n\t\treturn res;\n\t});\n\n\twebix.event(table.$view, \"mousedown\", function(e){\n\t\tif (view.$handleSelection)\n\t\t\treturn webix.html.preventEvent(e);\n\t});\n}\n","export function expandSelection(r, view){\n\tlet maxY = view.config.rowCount;\n\tlet maxX = view.config.columnCount;\n\tlet table = view._table;\n\n\tlet nr1 = r.start.row, nr2 = r.end.row, nc1 = r.start.column, nc2 = r.end.column;\n\n\tfor (let i=nr1-1; i>0; i--){\n\t\tif (getValue(i, r.start.column, table))\n\t\t\tnr1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nr2+1; i<maxY; i++){\n\t\tif (getValue(i, r.end.column, table))\n\t\t\tnr2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc1-1; i>0; i--){\n\t\tif (getValue(r.start.row, i, table))\n\t\t\tnc1 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tfor (let i=nc2+1; i<maxX; i++){\n\t\tif (getValue(r.end.row, i, table))\n\t\t\tnc2 = i;\n\t\telse\n\t\t\tbreak;\n\t}\n\n\tlet newrange = { start:{ row:nr1, column:nc1 } , end:{ row: nr2, column: nc2 }};\n\tif (nr1 != r.start.row || nr2 != r.end.row || nc1 != r.start.column || nc2 != r.end.column){\n\t\tview._table.addSelectArea(newrange.start, newrange.end);\n\t}\n\n\treturn newrange;\n}\n\nfunction getValue(r,c, table){\n\tvar value = table.getItem(r)[c];\n\tif(value === undefined || value === \"\"){\n\t\treturn false;\n\t} else {\n\t\treturn true;\n\t}\n}","import {expandSelection} from \"../helpers/expand_selection\";\nimport {updateMath} from \"../math/updater\";\nimport {rangeObj} from \"../helpers/column_names\";\nimport group from \"./undo_group\";\nimport {_changeCondition} from \"./conditional_formats\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"sort-asc\" || cm.id === \"sort-desc\")\n\t\t\tsortRange(view, null, cm.id.replace(\"sort-\",\"\"));\n\t});\n}\n\nconst sorters = {\n\t\"int\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = parseFloat(a[key]) || -Infinity;\n\t\t\tlet d = parseFloat(b[key]) || -Infinity;\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;\n\t\t};\n\t},\n\t\"str\":function(dir, key){\n\t\treturn (a,b) => {\n\t\t\tlet c = (a[key] || \"\").toString().toLowerCase();\n\t\t\tlet d = (b[key] || \"\").toString().toLowerCase();\n\t\t\treturn (c > d ? 1 : (c == d ? 0 : -1))*dir;  \n\t\t};\n\t}\n};\n\nexport function sortRange(view, range, dir, type){\n\trange = range || view._table.getSelectArea();\n\n\tif (range){\n\t\trange = rangeObj(range, view);\n\t\tlet fullrange = range;\n\t\tif (range.start.row === range.end.row)\n\t\t\tfullrange = expandSelection(range, view);\n\n\t\tlet key = view.getRow(range.start.row)[range.start.column];\n\t\ttype = type || (isNaN(parseFloat(key)) ? \"str\" : \"int\");\n\t\tdir = (!dir || dir === \"asc\") ? 1 : -1;\n\t\tgroup.set(()=>\n\t\t\tsort(fullrange, range.start.column, type, dir, view)\n\t\t);\n\t}\n}\n\nfunction sort(range, by, type, dir, view){\n\tfor (let column = range.start.column; column <= range.end.column; column++){\n\t\t//get all selected column values\n\t\tconst values = [];\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst fullRow = view.getRow(row);\n\t\t\t\tlet value = fullRow[column];\n\t\t\t\tlet style = view.getStyle(row, column);\n\t\t\t\tlet math = fullRow[\"$\"+column];\n\t\t\t\tlet conditions = view.conditions.get(row,column);\n\t\t\t\tif(conditions)\n\t\t\t\t\t_changeCondition(\"remove\", row, column, conditions, null, view);\n\n\t\t\t\tvalues.push({\n\t\t\t\t\tvalue: value,\n\t\t\t\t\tstyle: style,\n\t\t\t\t\tmath: math,\n\t\t\t\t\trow: row,\n\t\t\t\t\tconditions: conditions\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//sort them\n\t\tvalues.sort(sorters[type](dir, \"value\"));\n\n\t\t//set new values to original column\n\t\tfor (let row = range.start.row; row <= range.end.row; row++) {\n\t\t\tif(view.isRowVisible(row)){\n\t\t\t\tconst element = values.shift();\n\t\t\t\t\n\t\t\t\tview.setStyle(row, column, (element.style || null));\n\t\t\t\tif(element.conditions)\n\t\t\t\t\t_changeCondition(\"update\", row, column, null, element.conditions, view);\n\n\t\t\t\tif (!element.math) view.setCellValue(row, column, element.value);\n\t\t\t\telse {\n\t\t\t\t\tconst translate = {\n\t\t\t\t\t\tid: \"move\",\n\t\t\t\t\t\trow: row - element.row,\n\t\t\t\t\t\tcolumn: 0\n\t\t\t\t\t};\n\t\t\t\t\tconst newMath = updateMath(element.math, translate);\n\n\t\t\t\t\tview.setCellValue(row, column, newMath);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tview.refresh();\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"gridlines-hide\"){\n\t\t\thideGridlines(view, value);\n\t\t}\n\t});\n}\n\nexport function hideGridlines(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tvar borderless = grid.$view.className.indexOf(\"webix_borderless\") !=-1;\n\tif (state === \"toggle\")\n\t\tstate = !borderless;\n\n\tif(!borderless && state){\n\t\twebix.html.addCss( grid.$view, \"webix_borderless\", true);\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:true, value: false}]);\n\t}\n\telse if(borderless && !state){\n\t\twebix.html.removeCss( grid.$view, \"webix_borderless\");\n\t\tview.callEvent(\"onAction\", [\"gridlines-hide\", {newValue:false, value: true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.gridlines = view.$$(\"cells\").$view.className.indexOf(\"webix_borderless\") !=-1?0:1;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(!webix.isUndefined(data.table) && !webix.isUndefined(data.table.gridlines))\n\t\tmode = !data.table.gridlines;\n\thideGridlines(view, mode);\n}","export function init(view) {\n\tview.attachEvent(\"onUndo\", (action, row, column, value) => {\n\t\tif (action == \"header-hide\"){\n\t\t\thideHeaders(view, value);\n\t\t}\n\t});\n}\n\nexport function hideHeaders(view, state = true){\n\tvar grid = view.$$(\"cells\");\n\tif (state === \"toggle\")\n\t\tstate = grid.config.header;\n\n\tif(grid.config.header && state){\n\t\tgrid.config.header = false;\n\t\tif (grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.hideColumn(\"rowId\", {}, true, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:true, value:false}]);\n\t}\n\telse if(!grid.config.header && !state){\n\t\tgrid.config.header = true;\n\t\tif (!grid.isColumnVisible(\"rowId\"))\n\t\t\tgrid.showColumn(\"rowId\", {}, true);\n\t\tgrid.refreshColumns();\n\t\tview.callEvent(\"onAction\", [\"header-hide\", {newValue:false, value:true}]);\n\t}\n}\n\nexport function serialize(view, data){\n\tdata.table.headers = view.$$(\"cells\").config.header?1:0;\n}\n\nexport function load(view, data){\n\tvar mode = false;\n\tif(data.table && !webix.isUndefined(data.table.headers))\n\t\tmode = !data.table.headers;\n\thideHeaders(view, mode);\n}","import group from \"./undo_group\";\nimport {changeRange} from \"../helpers/column_names\";\nimport {setFilter} from \"./dropdown\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (cm) => {\n\t\tif (cm.id === \"create-filter\")\n\t\t\tfilter(view);\n\t});\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"filter\"){\n\t\t\tif (!value)\n\t\t\t\tview.removeFilter();\n\t\t\telse\n\t\t\t\tview.setCellFilter(row, column, value.options);\n\t\t} else if (type == \"dropdown\"){\n\t\t\tview.setCellEditor(row, column, value);\n\t\t}\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\n\nexport function getFilters(table){\n\tvar filters = table._ssFilters;\n\tvar all = [];\n\tfor (var row in filters)\n\t\tfor (var column in filters[row])\n\t\t\tall.push(filters[row][column]);\n\treturn all;\n}\n\nexport function serialize(view,data){\n\tlet filters = getFilters(view._table);\n\tlet editors = view._table._ssEditors;\n\t\n\tlet result = data.filters = [];\n\tfor (var i = 0; i<filters.length; i++){\n\t\tlet [row, column] = filters[i];\n\t\tlet options = editors[row][column].options;\n\t\tif(options)\n\t\t\tresult.push([row,column,options]);\n\t}\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tfilters = data.filters;\n\n\tif(filters){\n\t\tfor(i = 0; i < filters.length; i++)\n\t\t\tsetFilter(view, filters[i][0],filters[i][1], filters[i][2], true);\n\t\t\n\t\tview.filterSpreadSheet();\n\t}\n}\n\nfunction filter(view, range){\n\trange = range || view._table.getSelectArea();\n\n\tgroup.set(function(){\n\t\tview.removeFilter();\n\t\tif (!range) return;\n\t\tlet row = range.start.row;\n\t\tfor (let i=range.start.column; i<=range.end.column; i++){\n\t\t\tview.setCellFilter(row, i, range);\n\t\t\tview.callEvent(\"onAction\", [\"filter\", { row, column:i, value:null, newValue:range }]);\n\t\t}\n\t});\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet i,\n\t\tfilters = data.filters;\n\n\tif(inc){\n\t\tfor(i = filters.length-1;i >=0;i--){\n\t\t\tlet [row,column,range] = filters[i];\n\t\t\tif(name == \"row\" && row>= start.row || name == \"column\" && column >= start.column){\n\t\t\t\tfilters[i][0] = name == \"row\"?row*1 + inc:row;\n\t\t\t\tfilters[i][1] = name == \"column\"?column*1 + inc:column;\n\t\t\t\tfilters[i][2] = changeRange(range, name, inc, start);\n\t\t\t}\n\t\t}\n\t}\n}","import group from \"./undo_group\";\nimport {eachRange} from \"../helpers/column_names\";\n\nexport function init(view){\n\tview.comments = {\n\t\tget: function(row, column){\n\t\t\treturn getComment(view, row, column);\n\t\t},\n\t\tadd: function(row, column, comment){\n\t\t\tcommentCell(view, row, column, comment);\n\t\t},\n\t\tremove: function(row, column){\n\t\t\tremoveComment(view, row, column);\n\t\t},\n\t\t_activeComment: {},\n\t\t_pull:{}\n\t};\n\n\tview.attachEvent(\"onReset\", () => reset(view));\n\tview.attachEvent(\"onUndo\", (type, row, column, value) => {\n\t\tif (type === \"comment\")\n\t\t\t_undoComment(view, row, column, value);\n\t});\n\n\tview.attachEvent(\"onAction\", (action, p)=> {\n\t\tif(action == \"before-grid-change\")\n\t\t\tupdatePosition(p.name,p.inc,p.data, p.start);\n\t});\n}\n\nfunction _undoComment(view, row, column, value){\n\tif(getComment(view, row, column))\n\t\tremoveComment(view, row, column, true);\n\tif(value)\n\t\tcommentCell(view, row, column, value, true);\n}\n\nfunction reset(view){\n\tview.comments._pull = {};\n}\n\nfunction removeComment(view, row, column, silent){\n\tif(getComment(view, row, column)){\n\t\tif (!silent)\n\t\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue: null, value: view.comments._pull[row][column]}]);\n\t\tdelete view.comments._pull[row][column];\n\t}\n\tview.$$(\"cells\").updateItem(row,column);\n}\n\nexport function removeCommentsRange(view, range){\n\tgroup.set(function(){\n\t\teachRange(range, view, function(view, cell){\n\t\t\tif(getComment(view, cell.row, cell.column))\n\t\t\t\tremoveComment(view, cell.row, cell.column);\n\t\t});\n\t\tview.$$(\"cells\").refresh();\n\t});\n}\n\nfunction commentCell(view, row, column, comment, silent){\n\tvar oldValue = getComment(view, row, column) ? view.comments._pull[row][column] : null;\n\tvar table = view.$$(\"cells\");\n\n\tif(typeof comment == \"string\")\n\t\tcomment = comment.trim() ? comment : \"\";\n\tview.comments._pull[row] = view.comments._pull[row] ? view.comments._pull[row] : {};\n\tview.comments._pull[row][column] = comment;\n\n\ttable.addCellCss(row, column, \"ssheet_commented_cell\");\n\n\tif (!silent)\n\t\tview.callEvent(\"onAction\", [\"comment\", {row, column, newValue:comment, value:oldValue}]);\n}\n\nexport function serialize(view,data){\n\tvar row, column,\n\t\tcomments = [];\n\tfor(row in view.comments._pull){\n\t\tfor(column in view.comments._pull[row])\n\t\t\tif(view.comments._pull[row][column])\n\t\t\t\tcomments.push([row, column, view.comments._pull[row][column]]);\n\t}\n\tdata.comments = comments;\n}\n\nexport function load(view,data){\n\tvar i,\n\t\tcomments = data.comments;\n\n\tif(comments)\n\t\tfor(i = 0; i < comments.length; i++)\n\t\t\tcommentCell(view, comments[i][0], comments[i][1], comments[i][2], true);\n}\n\nfunction updatePosition(name, inc, data, start){\n\tlet comments = data.comments,\n\t\ti = comments.length;\n\n\tif(inc){\n\t\twhile(i--){\n\t\t\tlet [row,column] = comments[i];\n\t\t\tif(row && name == \"row\" && row>= start.row || column && name == \"column\" && column >= start.column){\n\t\t\t\tif (name == \"row\"){\n\t\t\t\t\tif (row < start.row - inc)\t//delete comment if row was deleted\n\t\t\t\t\t\tcomments.splice(i,1);\n\t\t\t\t\telse\t\t\t\t\t\t//update mark position if upper row was deleted\n\t\t\t\t\t\tcomments[i][0] = row*1 + inc;\n\t\t\t\t} else if (name == \"column\"){\n\t\t\t\t\tif (column < start.column - inc){\n\t\t\t\t\t\tcomments.splice(i, 1);\n\t\t\t\t\t} else \n\t\t\t\t\t\tcomments[i][1] = column*1 + inc;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction getComment(view, row, column){\n\treturn view.comments._pull[row] && view.comments._pull[row][column] ? view.comments._pull[row][column] : \"\";\n}","import * as m1  from \"./hide_gridlines\";\nimport * as m2  from \"./hide_headers\";\nimport * as m3  from \"./lock_cell\";\nimport * as m4  from \"./dropdown\";\nimport * as m5  from \"./filter\";\nimport * as m6  from \"./formats\";\nimport * as m7  from \"./hide_row_col\";\nimport * as m8  from \"./comments\";\n\nexport function init(view){\n\tvar modules = [m1,m2,m3,m4,m5,m6, m7, m8];\n\tview.attachEvent(\"onDataSerialize\", function(data){\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].serialize)\n\t\t\t\tmodules[i].serialize(view,data);\n\t\t}\n\n\t});\n\tview.attachEvent(\"onDataParse\", function(data){\n\t\tview._loading_data = true;\n\t\tfor (var i = 0; i < modules.length; i++){\n\t\t\tif(modules[i].load)\n\t\t\t\tmodules[i].load(view,data);\n\t\t}\n\t\tview._loading_data = false;\n\t});\n}","var types = [\".xls\",\".xlt\",\".xla\",\".xlsx\",\".xlsm\",\".xltx\",\".xltm\",\".xlam\",\".xlsb\"];\n\nexport function init(view){\n\tvar uploader;\n\tif (window.XMLHttpRequest && (new XMLHttpRequest()).upload){\n\t\tuploader = webix.ui({\n\t\t\tview:\"uploader\",\n\t\t\tapiOnly:true,\n\t\t\taccept: types.join()\n\t\t});\n\n\t\tuploader.attachEvent(\"onBeforeFileAdd\",webix.bind(function(upload){\n\t\t\tif(types.indexOf(\".\"+upload.type.toLowerCase())>-1){\n\t\t\t\tview.reset();\n\t\t\t\tview.parse(upload.file, \"excel\");\n\t\t\t}\n\t\t\treturn false;\n\t\t},this));\n\t}\n\n\tview.attachEvent(\"onCommand\", (obj) => {\n\t\tif (obj.id === \"excel-import\")\n\t\t\tstartImport(view, uploader);\n\t});\n}\n\nfunction startImport(view, uploader){\n\tif (!uploader)\n\t\twebix.alert(webix.i18n.spreadsheet.labels[\"import-not-support\"]);\n\telse\n\t\twebix.delay(() => uploader.fileDialog());\n}","export function print(view, options){\n\tlet active = view._activeSheet;\n\n\tlet html = _buildHtml(view, options, active);\n\twebix.html.insertBefore(html, options.docFooter, document.body);\n\twindow.print();\n\t_cleanHtml(view, html);\n\n\tview.showSheet(active);\n}\n\nexport function init(view){\n\tview.$customPrint = function(options){\n\t\tprint(view, options);\n\t};\n}\n\nfunction _cleanHtml(view, html){\n\twebix.html.remove(html);\n\n\tview._sheets.forEach((sheet, i) => {\n\t\twebix.html.removeStyle(\".wss_\"+view.$index+\"_\"+i);\n\t});\n}\nfunction _buildHtml(view, options, active){\n\tlet doc = webix.html.create(\"div\", { \"class\":\"webix_ssheet_print\"});\n\n\toptions.xCorrection = 1;\n\toptions.header = options.header || false;\n\toptions.trim = webix.isUndefined(options.trim) ? true : options.trim;\n\toptions.sheetnames = webix.isUndefined(options.sheetnames) ? true : options.sheetnames;\n\tconst baseIndex = view.$index;\n\n\tview._sheets.forEach((sheet, i) => {\n\t\tview.$index = baseIndex+\"_\"+i;\n\t\tif(options.data ===\"all\" || (options.data !== \"all\" && sheet.name === active)){\n\t\t\tview.showSheet(sheet.name);\n\t\t\tlet prefix = \"wss_\"+view.$index;\n\n\t\t\tif(options.sheetnames){\n\t\t\t\tlet sheetname = webix.html.create(\"div\", { \"class\":\"webix_view webix_ssheet_sheetname\"}, sheet.name+\":\");\n\t\t\t\tdoc.appendChild(sheetname);\n\t\t\t}\n\n\t\t\tlet table = view._table.$customPrint(options, true);\n\n\t\t\t//for empty sheet we don't have any HTML\n\t\t\tif (table.firstChild)\n\t\t\t\ttable.firstChild.className += \" \"+prefix;\n\t\t\tdoc.appendChild(table);\n\t\t\t\n\t\t\tif(options.data == \"all\" && i+1 < view._sheets.length){\n\t\t\t\tvar br = webix.html.create(\"DIV\", {\"class\":\"webix_print_pagebreak\"});\n\t\t\t\tdoc.appendChild(br);\n\t\t\t}\n\t\t}\n\t});\n\tview.$index = baseIndex;\n\t\n\treturn doc;\n}","import { style_names } from \"../operations/styles\";\nimport { defaultStyles} from \"../toolbar/defaults\";\nimport { getFormatSource } from \"../operations/formats\";\n\nexport function init(view){\n\tview.$exportView = function(options){\n\t\twebix.extend(options, { header: false, rawValues: true, spans: true, styles:true, math:true, xCorrection:1, ignore:{rowId:true}});\n\t\tif(options.export_mode ==\"excel\")\n\t\t\treturn _exportExcel(view, options);\n\t\telse\n\t\t\treturn view._table;\n\t};\n}\n\nfunction _exportExcel(view, options){\n\tif(options.sheets === true) \n\t\toptions.sheets  = view._sheets.map(function(s){ return s.name;});\n\telse if(!options.sheets || !options.sheets.length)\n\t\toptions.sheets = [view._activeSheet];\n\telse if(typeof options.sheets == \"string\")\n\t\toptions.sheets = [options.sheets];\n\n\toptions.dataOnly = true;\n\n\tlet data = [];\n\tlet active = view._activeSheet;\n\n\tfor(let i = 0; i<options.sheets.length; i++){\n\t\tview.showSheet(options.sheets[i]);\n\t\toptions.xCorrection = view.$$(\"cells\").config.header ? 1 : 0;\n\t\tdata = data.concat(webix.toExcel(view._table, options));\n\t\tdata[i].ranges = [];\n\n\t\tlet ranges = view.ranges.getRanges();\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\tdata[i].ranges.push({\n\t\t\t\tSheet:i,\n\t\t\t\tName:ranges[r].name,\n\t\t\t\tRef:options.sheets[i]+\"!\"+ranges[r].range.replace(/(\\w)/gi, function(match){ return \"$\"+match; })\n\t\t\t});\n\t\t}\n\t\tif(options.styles)\n\t\t\tdata[i].styles = _getStyles(view, options);\n\t}\n\tview.showSheet(active);\n\t\n\tdelete options.dataOnly;\n\treturn data;\n}\n\nfunction _safeColor(str){\n\tstr = str.substring(1);\n\tif(str.length === 3) str = str+str;\n\treturn str;\n}\n\nfunction _getDefaults(){\n\tlet d = defaultStyles;\n\treturn {\n\t\tfont:{\n\t\t\tsz:d[\"font-size\"].replace(\"px\", \"\")*0.75,\n\t\t\tname:d[\"font-family\"].replace(/'|,.*$/g, \"\"),\n\t\t\t//we do not export default color, but it is the right place to do it\n\t\t},\n\t\talignment:{\n\t\t\thorizontal:d[\"text-align\"],\n\t\t\tvertical:d[\"vertical-align\"]==\"middle\"?\"center\":d[\"vertical-align\"],\n\t\t\twrapText:d[\"white-space\"]!=\"nowrap\"\n\t\t}\n\t};\n}\n\nfunction _getStyles(view, options){\n\n\tview.compactStyles();\n\n\tlet result = [];\n\tlet cached = {};\n\tconst defaults = _getDefaults();\n\n\tif(options.docHeader) result  = result.concat([{0:_getDocStyle(options.docHeader.css, defaults)}, {}]);\n\tif(options.header) result.push({});\n\n\tconst delta = result.length;\n\n\tconst grid = view.$$(\"cells\");\n\tconst columns = grid.config.columns;\n\n\tlet rIndex = delta;\n\tgrid.eachRow((row) =>{\n\t\tfor (let cIndex = options.xCorrection; cIndex < columns.length; cIndex++){\n\t\t\tconst css = view.getStyle(row, columns[cIndex].id);\n\n\t\t\tresult[rIndex] = result[rIndex] || {};\n\t\t\tif (css)\n\t\t\t\tresult[rIndex][cIndex - options.xCorrection] = cached[css.id] = cached[css.id] || _getCellStyle(css.text);\n\t\t\telse\n\t\t\t\tresult[rIndex][cIndex - options.xCorrection] = defaults;\n\t\t}\n\t\trIndex++;\n\t});\n\n\tif(options.docFooter) result  = result.concat([{},{0:_getDocStyle(options.docFooter.css, defaults)}]);\n\n\treturn result;\n}\n\nfunction _getCellStyle(styles){\n\tlet str = styles.split(\";\"), stl = { font:{}, alignment:{}, border:{}};\n\n\tfor(let s = 0; s<str.length; s++){\n\t\tif(str[s]){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstl.font.color = {rgb:_safeColor(str[s])};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":{\n\t\t\t\t\tlet fill = _safeColor(str[s]);\n\t\t\t\t\tif(fill && fill.toLowerCase() !==\"ffffff\")\n\t\t\t\t\t\tstl.fill = { fgColor:{ rgb:fill}};\n\t\t\t\t\tbreak;\n\t\t\t\t}\t\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstl.alignment.horizontal = str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstl.font.name = str[s].replace(/'|,.*$/g, \"\"); // cut off fallback font\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstl.font.sz = str[s].replace(\"px\", \"\")*0.75; //px to pt conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstl.font.italic = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstl.font.underline = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstl.font.bold = true;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tstl.alignment.vertical = str[s] == \"middle\"?\"center\":str[s];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstl.alignment.wrapText = str[s] == \"wrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstl.format = getFormatSource(str[s], true) || \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstl.border.right = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstl.border.bottom = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstl.border.left = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstl.border.top = { color:{ rgb:_safeColor(str[s])}, style:\"thin\"};\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\treturn stl;\n}\n\nfunction _getDocStyle(css){\n\tif(!css) return {};\n\tvar str = [];\n\tfor(let i =0; i<style_names.length; i++)\n\t\tstr.push(css[style_names[i]]||\"\");\n\treturn _getCellStyle(str.join(\";\"));\n}\n\n","import { style_names } from \"../operations/styles\";\nimport { fontFamily} from \"../toolbar/buttons\";\nimport { defaultStyles} from \"../toolbar/defaults\";\n\nexport function init(view){\n\tview._parseExcel = function(obj, driver){\n\t\tvar options = obj.options || {};\n\t\toptions.math = view.config.math;\n\t\t\n\t\tvar full = { sheets:[]};\n\t\tfor(let i  = 0; i< obj.names.length; i++){\n\t\t\toptions.name = obj.names[i];\n\t\t\tfull.sheets.push({\n\t\t\t\tname:options.name,\n\t\t\t\tcontent:_excel_to_data(driver.getSheet(obj, options), obj.ranges, i)\n\t\t\t});\n\t\t}\n\t\treturn full;\n\t};\n\tview._parseCsv = function(obj, driver){\n\t\tobj = driver.getRecords(obj);\n\t\t\n\t\tvar dataObj = webix.copy(obj);\n\t\tvar data = [];\n\n\t\tfor(let i = 0; i<dataObj.length; i++){\n\t\t\tlet item = dataObj[i].split(driver.cell);\n\t\t\tfor(let c  = 0; c<item.length; c++){\n\t\t\t\tvar row = i+1, column = c+1;\n\t\t\t\tdata.push([row, column, item[c]]);\n\t\t\t}\n\t\t}\n\t\treturn { data:data };\n\t};\n}\n\n\nfunction _excel_to_data(obj, ranges, index){\t\n\tvar dataObj = webix.copy(obj.data);\n\tvar data =  [];\n\n\tfor (let i = 0; i < dataObj.length; i++){\n\t\tfor(let c = 0; c<dataObj[0].length; c++){\n\t\t\tvar row = i+1, column = c+1;\n\t\t\tdata.push([row, column, dataObj[i][c]]);\n\t\t}\n\t}\n\tobj.data = data;\n\n\t//merged cells\n\tif(obj.spans){\n\t\tfor(let i = 0; i<obj.spans.length; i++){\n\t\t\tobj.spans[i][0]++;\n\t\t\tobj.spans[i][1]++;\n\t\t}\n\t}\n\n\t//named ranges\n\tif(ranges){\n\t\tfor(let r = 0; r<ranges.length; r++){\n\t\t\t//we don't support global named ranges, so import only sheet-based :(\n\t\t\tif(ranges[r].Sheet === index){\n\t\t\t\tobj.ranges = obj.ranges || [];\n\t\t\t\tobj.ranges.push([ranges[r].Name.toUpperCase(), ranges[r].Ref.substring(ranges[r].Ref.indexOf(\"!\")+1).replace(/\\$/g, \"\")]);\n\t\t\t}\n\t\t}\n\t}\n\n\t//cell styles\n\tif(obj.styles)\n\t\tobj = _getStyles(obj);\n\n\t//column width and row height\n\tif(obj.sizes){\n\t\tfor(let i = 0; i<obj.sizes.length; i++){\n\t\t\tif(obj.sizes[i][0] == \"column\")\n\t\t\t\tobj.sizes[i] = [0, obj.sizes[i][1]+1, obj.sizes[i][2]];\n\t\t\telse\n\t\t\t\tobj.sizes[i] = [obj.sizes[i][1]+1, 0, obj.sizes[i][2]];\n\t\t}\n\t}\n\t\n\treturn obj; \n}\n\n//ARGB conversion\nfunction _safeColor(str){\n\tstr = str || \"000000\";\n\tif(str.length === 8) str = str.substring(2);\n\treturn \"#\"+str;\n}\n\n//only fonts that we support can be imported\nfunction _safeFont(str){\n\tlet safe = defaultStyles[\"font-family\"];\n\tfor(let i = 0; i<fontFamily.length; i++){\n\t\tif(fontFamily[i].value == str) { safe = fontFamily[i].id; break; }\n\t}\n\treturn safe;\n}\n\nfunction _getStyles(obj){\n\tlet styleshash = {}, styles = [], stylescount = 1;\n\tfor(let i = 0; i<obj.styles.length; i++){\n\t\tlet str = [], stl = obj.styles[i][2], css;\n\n\t\tfor(let s  = 0; s<style_names.length; s++){\n\t\t\tswitch (style_names[s]){\n\t\t\t\tcase \"color\": \n\t\t\t\t\tstr[s] = stl.font && stl.font.color?(_safeColor(stl.font.color.rgb)||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"background\":\n\t\t\t\t\tstr[s] = stl.fill && stl.fill.fgColor?(_safeColor(stl.fill.fgColor.rgb) ||\"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-align\":\n\t\t\t\t\tstr[s] = (stl.alignment ?stl.alignment.horizontal:\"\") || defaultStyles[\"text-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-family\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.name?_safeFont(stl.font.name):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-size\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.sz?((stl.font.sz/0.75)+\"px\" ||\"\"):\"\"; //pt to px conversion\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-style\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.italic?\"italic\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"text-decoration\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.underline?\"underline\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"font-weight\":\n\t\t\t\t\tstr[s] = stl.font && stl.font.bold?\"bold\":\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"vertical-align\":\n\t\t\t\t\tvar va = stl.alignment ? (stl.alignment.vertical || \"\"):\"\";\n\t\t\t\t\tstr[s] = (va ==\"center\"?\"middle\":va) || defaultStyles[\"vertical-align\"];\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"wrap\":\n\t\t\t\t\tstr[s] = stl.alignment && stl.alignment.wrapText?\"wrap\":\"nowrap\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"borders\":\n\t\t\t\t\tstr[s] = \"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"format\":\n\t\t\t\t\tstr[s] = \"\"; //stl.numFmt\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-right\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.right? (_safeColor(stl.border.right.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-bottom\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.bottom? (_safeColor(stl.border.bottom.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-left\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.left? (_safeColor(stl.border.left.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"border-top\":\n\t\t\t\t\tstr[s] = stl.border && stl.border.top? (_safeColor(stl.border.top.color.rgb) || \"\"):\"\";\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tstr = str.join(\";\");\n\t\tcss = styleshash[str] || \"wss\"+stylescount;\n\n\t\tfor(let d = 0; d<obj.data.length; d++){\n\t\t\tif(obj.data[d][0] === obj.styles[i][0]+1 && obj.data[d][1] === obj.styles[i][1]+1){\n\t\t\t\tobj.data[d][3] = css;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif(!styleshash[str]){\n\t\t\tstyles.push([css, str]);\n\t\t\tstyleshash[str] = css;\n\t\t\tstylescount++;\n\t\t}\n\t}\n\tobj.styles = styles;\n\treturn obj;\n}","import group from \"../operations/undo_group\";\n\nexport function init(view){\n\tview.attachEvent(\"onCommand\", (action) => {\n\t\tswitch (action.id) {\n\t\t\tcase \"clear-value\":\n\t\t\t\tview.clearRange(null,{values: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-style\":\n\t\t\t\tview.clearRange(null,{styles: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-conditional-formats\":\n\t\t\t\tview.clearRange(null,{conditions: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-dropdown-editors\":\n\t\t\t\tview.clearRange(null,{editors: true});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-all\":\n\t\t\t\tgroup.set(function(){\n\t\t\t\t\tview.clearRange(null,null);\n\t\t\t\t});\n\t\t\t\tbreak;\n\t\t\tcase \"clear-comments\":\n\t\t\t\tview.clearRange(null,{comments: true});\n\t\t\t\tbreak;\n\t\t}\n\t});\n}","import group from \"../operations/undo_group\";\n\n/* row operations */\n\nexport function insertRow(row){\n\tcallCommand(this, \"add\", \"row\", row);\n}\n\nexport function deleteRow(row){\n\tcallCommand(this, \"del\", \"row\", row);\n}\n\nexport function setRowHeight(row, height){\n\tsetSize(this, \"row\", row, height);\n}\n\n/* col operations */\n\nexport function insertColumn(column){\n\tcallCommand(this, \"add\", \"column\", column);\n}\n\nexport function deleteColumn(column){\n\tcallCommand(this, \"del\", \"column\", column);\n}\n\nexport function setColumnWidth(column, width){\n\tsetSize(this, \"column\", column, width);\n}\n\n/* helpers */\n\nfunction getCells(view, id, group){\n\tif(!id){\n\t\tlet area = view.$$(\"cells\").getSelectArea();\n\t\tif(area)\n\t\t\tid = [area.start[group],area.end[group]];\n\t}\n\telse if(!webix.isArray(id)){\n\t\tid =  [id,id];\n\t}\n\treturn id;\n}\n\nfunction callCommand(view, name, group, id){\n\tlet start = {}, end = {};\n\tid = getCells(view, id, group);\n\tif(!id)\n\t\treturn;\n\tstart[group] = id[0];\n\tend[group] = id[1];\n\tview.callEvent(\"onCommand\", [{id:name,  group:group}, start, end]);\n}\n\nfunction setSize(view, type, id, size){\n\tid = getCells(view, id, type);\n\tif(!id)\n\t\treturn;\n\tgroup.set(()=>{\n\t\tfor (let i = id[0]; i <= id[1]; i++)\n\t\t\tview.$$(\"cells\")[type == \"row\" ? \"setRowHeight\" : \"setColumnWidth\"](i, size);\n\t});\n}","import * as lock from \"../operations/lock_cell\";\n\nexport function lockCell(row, column, state){\n\tlock.lockCell(this, row, column, state);\n}\n\nexport function isCellLocked(row, column){\n\treturn lock.isCellLocked(this, row, column);\n}","import group from \"../operations/undo_group\";\n\nexport function freezeColumns(column){\n\tconst grid = this.$$(\"cells\");\n\t\n\tif( webix.isUndefined(column) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\tcolumn = sel.length?sel[0].column:0;\n\t}\n\n\tconst base = grid.config.columns[0].id == \"rowId\" ? 1 : 0;\n\tlet index = base;\n\tif (column && column != this._frozenColumns)\n\t\tindex = grid.getColumnIndex(column*1+1);\n\tif (index<base) index = base;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"column\", column);\n\t\tgrid.unselect();\n\t\tgrid.define(\"leftSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-column\", { value: (this._frozenColumns || 0), newValue: column}]);\n\t\tthis._frozenColumns = index > base ? column : 0;\n\t},this);\n}\n\nexport function freezeRows(row){\n\tconst grid = this.$$(\"cells\");\n\n\tif( webix.isUndefined(row) ){\n\t\tlet sel = this.getSelectedId(true);\n\t\trow = sel.length?sel[0].row:0;\n\t}\n\n\tlet index = 0;\n\tif (row && row != this._frozenRows)\n\t\tindex = grid.getIndexById(row*1+1);\n\tif (index < 0) index = 0;\n\n\tgroup.set(function(){\n\t\tcheckSpans(this, \"row\", row);\n\t\tgrid.unselect();\n\t\tgrid.define(\"topSplit\", index);\n\t\tgrid.refreshColumns();\n\n\t\tthis.callEvent(\"onAction\", [ \"freeze-row\", { value: this._frozenRows, newValue: row}]);\n\t\tthis._frozenRows = index ? row : 0;\n\t},this);\n}\n\nfunction checkSpans(view, type, num){\n\tconst grid = view.$$(\"cells\");\n\n\tif(type == \"row\"){\n\t\tlet start = 1;\n\t\tlet end = view.config.columnCount;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(num, i);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[0]*1) + span[3] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, span[2], num-span[1]+1);\n\t\t\t}\n\t\t}\n\t}\n\telse{//column\n\t\tlet start = grid.data.order[0];\n\t\tlet end = grid.data.order.length;\n\t\tfor(let i = start; i <= end; i++){\n\t\t\tconst span = grid.getSpan(i, num);\n\t\t\tif(span){\n\t\t\t\tconst spanSize = (span[1]*1) + span[2] - 1;\n\t\t\t\tif(spanSize>num)\n\t\t\t\t\tchangeSpan(view, span, num-span[0]+1, span[3]);\n\t\t\t}\n\t\t}\n\t}\n}\n\nfunction changeSpan(view, span, x, y){\n\tview.splitCell(span[0], span[1]);\n\tview.combineCells({\n\t\tcell:{\n\t\t\trow:span[0],\n\t\t\tcolumn:span[1]\n\t\t},\n\t\tx:x,\n\t\ty:y\n\t});\n}","import * as gridlines from \"../operations/hide_gridlines\";\n\nexport function hideGridlines(state){\n\tgridlines.hideGridlines(this,state);\n}","import * as headers from \"../operations/hide_headers\";\n\nexport function hideHeaders(state){\n\theaders.hideHeaders(this,state);\n}","import * as hrows from \"../operations/hide_row_col\";\n\nexport function hideColumn(column,state){\n\throws.setColumnState(this, column, state);\n}\nexport function isColumnVisible(column){\n\treturn hrows.isColumnVisible(this, column);\n}\nexport function hideRow(row,state){\n\throws.setRowState(this, row, state);\n}\nexport function isRowVisible(row){\n\treturn hrows.isRowVisible(this, row);\n}","import {addMethod} from \"../math/methods\";\nimport {image, chart} from \"../math/writer\";\nimport {getAccessor} from \"../math/sheet\";\n\nexport function addImage(row, column, url){\n\tthis.setCellValue(row, column, image(url));\n\tthis.refresh();\n}\n\nexport function addSparkline(row, column, config){\n\tlet value = chart(config);\n\tthis.setCellValue(row, column, value);\n\tthis.refresh();\n}\n\nexport function getSheetData(name){\n\treturn getAccessor(this, name);\n}\n\nexport function recalculate(){\n\tthis.callEvent(\"onMathRefresh\",[]);\n}\n\nexport function registerMathMethod(name, handler){\n\tname = name.toUpperCase();\n\taddMethod(name, handler);\n\tif(this.$$(\"liveEditor\")){\n\t\tconst sid = this.$$(\"liveEditor\").config.suggest;\n\t\tconst list = webix.$$(sid).getList();\n\t\tif(!list.exists(name))\n\t\t\tlist.add({id:name, value:name});\n\t}\n}","import * as sheets from \"../sheets\";\nimport * as spn from \"../operations/spans\";\nimport * as und from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\nimport * as stl from \"../operations/styles\";\nimport * as srt from \"../operations/sorting\";\nimport {removeCommentsRange} from \"../operations/comments\";\nimport {clearConditionalFormats} from \"../operations/conditional_formats\";\nimport {clearEditors} from \"../operations/dropdown\";\n\n//spans\nexport function combineCells(range){\n\tif(!range){\n\t\tvar sel = this.getSelectedId(true);\n\t\tif (sel.length>1){\n\t\t\trange = spn.getRange(sel);\n\t\t}\n\t}\n\tgroup.set(()=> {\n\t\tif (range)\n\t\t\tspn.addSpan(this, range.cell, range.x, range.y);\n\t});\n\tthis.refresh();\n}\n\nexport function splitCell(row, column){\n\tif (row && column) {\n\t\tspn.removeSpan(this, {row: row, column: column});\n\t}\n\telse{\n\t\tgroup.set(function(){\n\t\t\tthis.eachSelectedCell(function(cell){\n\t\t\t\tspn.removeSpan(this, cell);\n\t\t\t});\n\t\t},this);\n\n\t}\n\n\tthis.refresh();\n}\n\n//styles\nexport function addStyle(prop, origin){\n\treturn stl.addStyle(this, prop, origin);\n}\n\nexport function getStyle(row, column){\n\treturn stl.getStyle(this, {row:row, column:column});\n}\n\nexport function setStyle(row, column, style){\n\treturn stl.setStyle(this, {row: row, column: column}, style);\n}\n\nexport function setRangeStyle(rangeStr, style){\n\tgroup.set(function() {\n\t\tstl.setRangeStyle(this, rangeStr, style);\n\t},this);\n}\n\nexport function clearRange(rangeStr, type) {\n\tif (!rangeStr){\n\t\trangeStr = this._table.getSelectArea();\n\t\tif (!rangeStr) return;\n\t}\n\n\tif (!type) type = {styles: true, values: true, editors:true, conditions:true, comments:true };\n\t\n\tif (type.styles)\n\t\tstl.clearRangeStyle(this,rangeStr);\n\n\tif (type.conditions)\n\t\tclearConditionalFormats(this,rangeStr);\n\t\n\tif (type.values)\n\t\tthis.setRangeValue(rangeStr, null);\n\n\tif (type.editors)\n\t\tclearEditors(this, rangeStr);\n\n\tif (type.comments)\n\t\tremoveCommentsRange(this, rangeStr);\n\n\tthis.refresh();\n}\n\nexport function compactStyles(){\n\treturn stl.compactStyles(this);\n}\n\n// serialize\nexport function serialize(config){\n\tvar obj = {};\n\tthis.callEvent(\"onDataSerialize\",[obj, config]);\n\n\tif (config && config.sheets)\n\t\treturn sheets.serialize(this, obj);\n\treturn obj;\n}\n\n//sheets\nexport function showSheet(name){\n\tsheets.show(this,name);\n}\nexport function getActiveSheet(){\n\treturn this._activeSheet;\n}\nexport function addSheet(content){\n\tsheets.add(this, content);\n}\nexport function clearSheet(){\n\tthis.reset();\n}\nexport function renameSheet(name,newName){\n\tsheets.rename(this,name,newName);\n}\nexport function editSheet(name){\n\tsheets.edit(this,name);\n}\nexport function removeSheet(name){\n\tsheets.remove(this,name);\n}\n\n\n//undo\nexport function undo(){\n\tund.undo(this);\n}\nexport function redo(){\n\tund.redo(this);\n}\n\n// sort\nexport function sortRange(range, dir){\n\tsrt.sortRange(this, range, dir);\n}","import {toRange,rangeObj} from \"../helpers/column_names\";\nimport * as tbl from \"../table\";\nimport group from \"../operations/undo_group\";\nimport {newSheet} from \"../sheets\";\n\nexport function refresh(all){\n\tif (all)\n\t\tthis._table.refreshColumns();\n\telse\n\t\tthis._table.refresh();\n}\nexport function eachSelectedCell(cb){\n\tvar cells = this.getSelectedId(true);\n\tfor (var i=0; i<cells.length; i++)\n\t\tcb.call(this, cells[i]);\n}\nexport function getSelectedRange(sheet){\n\tvar area = this._table.getSelectArea();\n\tif (area){\n\t\tif (sheet)\n\t\t\tsheet = this.getActiveSheet();\n\t\treturn toRange(area.start.row,area.start.column,area.end.row,area.end.column,sheet);\n\t}\n\treturn \"\";\n}\nexport function getSelectedId(all){\n\tvar area = this._table.getSelectArea();\n\tif(!all)\n\t\treturn area && area.start.row ? area.start : null;\n\n\tvar selection = [];\n\tif(area){\n\t\tvar c0 = area.start;\n\t\tvar c1 = area.end;\n\n\t\tfor(var i = c0.row; i<= c1.row; i++){\n\t\t\tfor(var j = c0.column; j <= c1.column; j++){\n\t\t\t\tselection.push({row: i,column:j});\n\t\t\t}\n\t\t}\n\t}\n\n\treturn selection;\n\t//return this._table.getSelectedId(all)\n}\nexport function getCellValue(row, column){\n\tvar item = this.getRow(row);\n\tvar value = item[\"$\"+column] || item[column];\n\t\n\tif (typeof value === \"undefined\") return \"\";\n\treturn value;\n}\nexport function setCellValue(row, column, value){\n\tif(this.getCellValue(row, column) !== value){\n\t\tvar item = this.getRow(row);\n\t\tvar old = item[\"$\"+column]||item[column];\n\n\t\tif (this.callEvent(\"onBeforeValueChange\",[row, column, value, old])){\n\t\t\titem[column] = value;\n\t\t\tdelete item[\"$\"+column];\n\n\t\t\tthis.callEvent(\"onCellChange\", [row, column, value]);\n\t\t\tthis.saveCell(row, column);\n\t\t}\n\t}\n}\n\nexport function setRangeValue(range, value){\n\tgroup.set(function(){\n\t\tvar pos = rangeObj(range, this);\n\t\tfor (let row = pos.start.row; row <= pos.end.row; row++) {\n\t\t\tfor (let column = pos.start.column; column <=  pos.end.column; column++) {\n\t\t\t\tthis.setCellValue(row, column, value);\n\t\t\t}\n\t\t}\n\t},this);\n\n}\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\nexport function getColumn(id){\n\treturn this._table.getColumnConfig(id);\n}\nexport function reset(mode){\n\tvar obj = { data:[] };\n\tif (mode && mode.sheets){\n\t\tobj = newSheet(obj);\n\t}\n\t\n\tthis.parse(obj);\n}\n\nexport function _resetTable(){\n\ttbl.reset(this);\n}\n","import {save} from \"../operations/save\";\n\nexport function saveCell(row, column){\n\tvar style = this.getStyle(row, column);\n\n\tsave(this, \"data\", {\n\t\trow: row,\n\t\tcolumn: column,\n\t\tvalue: this.getCellValue(row, column),\n\t\tstyle: (style ? style.id : \"\")\n\t});\n}","import {nullFilter} from \"../math/ranges\";\nimport  * as drd from \"../operations/dropdown\";\nimport {getFilters} from \"../operations/filter\";\n\nexport function getRow(id){\n\treturn this._table.getItem(id);\n}\n\nexport function setCellFilter(row, column, range){\n\tdrd.setFilter(this, row, column, range);\n}\n\nexport function setCellEditor(row, column, editor) {\n\tlet line = this._table._ssEditors[row] = this._table._ssEditors[row] || {};\n\tlet value = line[column]|| this._table.getItem(row)[column];\n\tline[column] = editor;\n\n\tif (editor && editor.editor)\n\t\tthis._table.addCellCss(row,column, \"ss_filter\");\n\telse{\n\t\tdelete this._table._ssEditors[row][column];\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t}\n\tthis.callEvent(\"onAction\", [\"dropdown\", { row, column, value, newValue:editor }]);\n}\n\nexport function getCellEditor(row, column){\n\tlet line = this._table._ssEditors[row] || {};\n\treturn line[column] || null; \n}\n\nexport function addFilter(row,column){\n\treturn drd.addCellFilter(this,row,column);\n}\n\nexport function removeFilter(){\n\tvar fs = getFilters(this._table);\n\tfor\t(let i=0; i<fs.length; i++){\n\t\tlet [row,column] = fs[i];\n\t\tlet value = this.getCellEditor(row, column);\n\t\tthis.setCellEditor(row,column, null);\n\t\tthis._table.removeCellCss(row,column, \"ss_filter\");\n\t\tthis.callEvent(\"onAction\", [\"filter\", {row, column, value, newValue:null }]);\n\t}\n\n\tthis._table._ssFilters = {};\n\tthis._table.data.filter(function(){ return true; });\n}\n\n\nexport function filterSpreadSheet(){\n\tthis._table.data.silent(function(){ \n\t\tvar filters = getFilters(this._table);\n\t\tfor (var i=0; i<filters.length; i++){\n\t\t\tlet [row,column] = filters[i];\n\t\t\tvar value = this._table.getItem(row)[column];\n\n\t\t\tvar all = false;\n\t\t\tconst isNull = (value == nullFilter());\n\t\t\tthis._table.data.filter(function(obj){\n\t\t\t\tif (!value) return true;\n\t\t\t\tif (isNull && !obj[column]) return true;\n\t\t\t\tif (obj.id*1 <= row*1) return true;\n\t\t\t\tif (!obj[column] && obj[column] !== \"\") all = true;\n\t\t\t\treturn all || obj[column] == value;\n\t\t\t}, 1, i);\n\t\t}\n\t}, this);\n\n\tthis._table.refresh();\n}\n","export function confirm(config){\n\twebix.modalbox({\n\t\ttype: \"alert webix_ssheet_confirm\",\n\t\ttext:config.text,\n\t\tbuttons:[webix.i18n.spreadsheet.labels.cancel,webix.i18n.spreadsheet.labels.ok],\n\t\tcallback:(result) => {\n\t\t\tconfig.callback.call(this,result!=\"0\");\n\t\t}\n\t});\n}\n\nexport function alert(config){\n\twebix.modalbox({\n\t\ttype: \"alert webix_ssheet_alert\",\n\t\ttext:config.text,\n\t\tbuttons:[webix.i18n.spreadsheet.labels.ok]\n\t});\n}","import * as undo from \"../operations/undo\";\nimport group from \"../operations/undo_group\";\n\nexport function resetUndo(){\n\tundo.reset(this);\n}\n\nexport function groupUndo(func){\n\tgroup.set(func, this);\n}\n\nexport function ignoreUndo(func){\n\tundo.ignoreUndo(func, this);\n}","import * as fmt from \"../operations/formats\";\n\nexport function setFormat(row, column, format){\n\tfmt.addFormat(this, row, column, format);\n}\n\nexport function changeDecimals(row, column, inc){\n\t//row and column may be obj\n\tfmt.changeAreaDecimals(this, inc, row, column);\n}","const defaultMenu = [\n\t{ id:\"file\", submenu:[\n\t\t{id: \"sheet\", submenu: [\n\t\t\t{id: \"new-sheet\"},\n\t\t\t{id: \"copy-sheet\"},\n\t\t\t{id: \"remove-sheet\"}\n\t\t]},\n\t\t{id: \"excel-import\"},\n\t\t{id: \"excel-export\"}\n\t]},\n\t{ id:\"edit\", submenu:[\n\t\t{id: \"add-range\"},\n\t\t{id: \"add-dropdown\"},\n\t\t{id: \"add-link\"},\n\t\t{id: \"lock-cell\"},\n\t\t{id: \"conditional-format\"},\n\t\t{id: \"clear\", submenu:[\n\t\t\t{id: \"clear-value\"},\n\t\t\t{id: \"clear-style\"},\n\t\t\t{id: \"clear-conditional-formats\"},\n\t\t\t{id: \"clear-dropdown-editors\"},\n\t\t\t{id: \"clear-comments\"},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"clear-all\"}\n\t\t]}\n\t]},\n\t{ id:\"insert\", submenu:[\n\t\t{id: \"add-image\"},\n\t\t{id: \"add-sparkline\"},\n\t\t{id: \"add-comment\"}\n\t]},\n\t{ id:\"data\", submenu:[\n\t\t{id: \"sort\", submenu: [\n\t\t\t{id: \"sort-asc\"},\n\t\t\t{id: \"sort-desc\"}\n\t\t]},\n\t\t{id: \"create-filter\"}\n\t]},\n\t{\n\t\tid: \"view\", submenu:[\n\t\t\t{id: \"columns\", submenu: [\n\t\t\t\t{id: \"insert-column\"},\n\t\t\t\t{id: \"delete-column\"},\n\t\t\t\t{id: \"show-column\"},\n\t\t\t\t{id: \"hide-column\"},\n\t\t\t\t{id: \"resize-column\"}\n\t\t\t]},\n\t\t\t{id: \"rows\", submenu: [\n\t\t\t\t{id: \"insert-row\"},\n\t\t\t\t{id: \"delete-row\"},\n\t\t\t\t{id: \"show-row\"},\n\t\t\t\t{id: \"hide-row\"},\n\t\t\t\t{id: \"resize-row\"}\n\t\t\t]},\n\t\t\t{ $template:\"Separator\" },\n\t\t\t{id: \"freeze-columns\"},\n\t\t\t{id: \"freeze-rows\"},\n\t\t\t{id: \"hide-gridlines\"},\n\t\t\t{id: \"hide-headers\"}\n\t\t]\n\t}\n];\n\nconst ui = {\n\tgetMenuData: function(menu, config){\n\t\tvar i;\n\t\tfor(i=0; i < menu.length; i++){\n\t\t\tif(typeof menu[i] == \"string\")\n\t\t\t\tmenu[i] = {id: menu[i]};\n\t\t\tif((menu[i].id == \"resize-column\" || menu[i].id == \"resize-row\") && !config.resizeCell){\n\t\t\t\tmenu.splice(i,1);\n\t\t\t\ti--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!menu[i].value)\n\t\t\t\tmenu[i].value = webix.i18n.spreadsheet.menus[menu[i].id];\n\t\t\tif(menu[i].submenu)\n\t\t\t\tmenu[i].submenu = this.getMenuData(menu[i].submenu, config);\n\t\t}\n\n\t\treturn menu;\n\t}\n};\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => ready(view));\n\n\tvar config = view.config,\n\t\tmenu = {\n\t\t\tview: \"menu\",\n\t\t\tborderless: true,\n\t\t\tcss: \"webix_ssheet_menu\",\n\t\t\tid: \"menu\",\n\t\t\tautowidth: true,\n\t\t\ttype:{\n\t\t\t\theight: 40\n\t\t\t},\n\t\t\tdata: ui.getMenuData(webix.isArray(config.menu)?config.menu : webix.copy(defaultMenu), view.config)\n\t\t};\n\n\tview.callEvent(\"onViewInit\", [\"menu\", menu]);\n\treturn menu;\n}\n\n\nfunction ready(view){\n\tif(view.$$(\"menu\"))\n\t\tview.$$(\"menu\").attachEvent(\"onMenuItemClick\",(id) => callAction(view,id));\n}\n\nconst actionMap = {\n\t\"undo\": function (view) {\n\t\tview.undo();\n\t},\n\t\"redo\": function (view) {\n\t\tview.redo();\n\t},\n\t\"insert-column\": function (view) {\n\t\tview.insertColumn();\n\t},\n\t\"delete-column\": function (view) {\n\t\tview.deleteColumn();\n\t},\n\t\"show-column\": function (view) {\n\t\tview.hideColumn(null,false);\n\t},\n\t\"hide-column\": function (view) {\n\t\tview.hideColumn(null,true);\n\t},\n\t\"resize-column\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"column\", value: webix.i18n.spreadsheet.menus[\"resize-column\"]}]);\n\t},\n\t\"insert-row\": function (view) {\n\t\tview.insertRow();\n\t},\n\t\"delete-row\": function (view) {\n\t\tview.deleteRow();\n\t},\n\t\"show-row\": function (view) {\n\t\tview.hideRow(null,false);\n\t},\n\t\"hide-row\": function (view) {\n\t\tview.hideRow(null,true);\n\t},\n\t\"resize-row\": function (view) {\n\t\t//like we are calling from the toolbar\n\t\tview.callEvent(\"onCommand\",[{id: \"resize\", group: \"row\", value: webix.i18n.spreadsheet.menus[\"resize-row\"]}]);\n\t},\n\t\"freeze-columns\": function(view){\n\t\tview.freezeColumns();\n\t},\n\t\"hide-gridlines\": function(view){\n\t\tview.hideGridlines(\"toggle\");\n\t},\n\t\"hide-headers\": function(view){\n\t\tview.hideHeaders(\"toggle\");\n\t}\n};\n\nfunction callAction(view,id){\n\tif(view.callEvent(\"onMenuItemClick\",[id])){\n\t\tif(actionMap[id])\n\t\t\tactionMap[id](view);\n\t\telse\n\t\t\tview.callEvent(\"onCommand\",[{id: id}]);\n\t}\n}","function getText(text){\n\tvar locale = webix.i18n.spreadsheet.labels;\n\treturn locale[text] || text;\n}\nexport function getDefaultStyles(){\n\treturn [\n\t\t{name: getText(\"normal\"), css: \"webix_ssheet_condition_regular\"},\n\t\t{name: getText(\"neutral\"), css: \"webix_ssheet_condition_neutral\"},\n\t\t{name: getText(\"bad\"), css: \"webix_ssheet_condition_bad\"},\n\t\t{name: getText(\"good\"), css: \"webix_ssheet_condition_good\"}\n\t];\n}","//global definitions\nimport \"./locale\";\nimport \"./views/index\";\n\n//special content for non-production builds\nimport \"./init\";\n\n//modules\nimport * as bar from \"./toolbar\";\nimport * as tbl from \"./table\";\nimport * as key from \"./hotkeys\";\nimport * as editor from \"./editor\";\nimport * as sheets from \"./sheets\";\nimport * as dialogs from \"./dialogs/index\";\nimport * as context from \"./context\";\n\nimport {setDefaultFormats} from \"./operations/formats\";\nimport {operations} from \"./operations/index\";\nimport {api} from \"./api/index\";\n\n//styling\nimport * as menu from \"./menu\";\nimport {getDefaultStyles} from \"./helpers/conditional\";\nimport {setSkinDefaults} from \"./toolbar/defaults\";\n\n\nvar component = {\n\tname:\"spreadsheet\",\n\t_base_index:{ count:1 },\n\tdefaults:{\n\t\tspans: true,\n\t\trowCount:50,\n\t\tmath:true,\n\t\tcolumnCount:20,\n\t\tresizeCell: true,\n\t\tsheetTabWidth: 90,\n\t\tconditionStyle: getDefaultStyles()\n\t},\n\t$init:function(){\n\t\tthis.$index = (this._base_index.count++);\n\t\tthis.$view.className += \" webix_ssheet\";\n\n\t\tthis.$ready.unshift(this._sub_init);\n\t\tthis.$ready.unshift(setDefaultFormats);\n\t\tthis.$ready.push(this._set_handlers);\n\t},\n\t$skin:function(){\n\t\tsetSkinDefaults();\n\t},\n\t_sub_init:function(){\n\t\tvar obj = this.config;\n\t\tvar rows = [];\n\n\t\t//toolbars\n\t\tif(!obj.readonly && obj.menu)\n\t\t\trows.push(menu.init(this));\n\t\tif(!obj.readonly && obj.toolbar !== false)\n\t\t\trows.push(bar.init(this));\n\t\tif (obj.subbar)\n\t\t\trows.push(obj.subbar);\n\t\tif(obj.liveEditor)\n\t\t\trows.push(editor.init(this));\n\t\t\n\t\t//data part\n\t\tlet tblObj = {\n\t\t\teditable : !obj.readonly,\n\t\t\tclipboard : obj.clipboard,\n\t\t\tliveEditor: obj.liveEditor,\n\t\t\tclipboardDecimalDelimiter : obj.clipboardDecimalDelimiter\n\t\t};\n\t\tif(obj.rowHeight)\n\t\t\ttblObj.rowHeight = obj.rowHeight;\n\t\tif(obj.columnWidth)\n\t\t\ttblObj.columnWidth = obj.columnWidth;\n\n\t\trows.push(tbl.init(this, tblObj));\n\n\t\tvar bottom = obj.bottombar === true ? sheets.defaultBottom(this) : obj.bottombar;\n\t\tif (bottom)\n\t\t\trows.push(bottom);\n\n\t\tsheets.init(this);\n\n\t\tif(!obj.readonly)\n\t\t\tcontext.init(this);\n\n\t\tdialogs.init(this);\n\n\t\tthis.rows_setter(rows);\n\t},\n\t_set_handlers:function(){\n\t\t//prevent double init\n\t\tif (this._table) return;\n\t\tthis._table = this.$$(\"cells\");\n\n\t\t//init all sub modules\n\t\toperations(this);\n\n\t\t//set sizes for the table\n\t\ttbl.reset(this, this.config.columnCount, this.config.rowCount);\n\t\tkey.init(this); //keyboard shortcuts\n\t\t\n\t\tthis._table.attachEvent(\"onAfterAreaAdd\", () =>\n\t\t\tthis.callEvent(\"onAfterSelect\", [ this.getSelectedId(true) ]));\n\n\t\tthis.callEvent(\"onComponentInit\", []);\n\t},\n\t$onLoad:function(obj, driver){\n\t\t//when loading data by data:, we can get $onLoad before _set_handlers call\n\t\tthis._set_handlers();\n\n\t\tif (obj.excel)\n\t\t\tobj = this._parseExcel(obj, driver);\n\t\telse if(!obj.data && typeof obj == \"string\" && (driver.cell || driver.row))\n\t\t\tobj = this._parseCsv(obj, driver);\n\n\t\tsheets.load(this, obj);\n\t}\n};\napi(component);\nwebix.protoUI(component, webix.AtomDataLoader, webix.IdSpace, webix.ui.layout);\n","import {isCellSelected, isColSelected,isRowSelected,selectRow,selectColumn} from \"./operations/column_operations\";\nimport {getColumnOperation, getRowOperation, getClearOperation} from \"./toolbar/buttons\";\n\nexport function init(view){\n\tview.attachEvent(\"onComponentInit\", () => view.$$(\"context\").attachTo(view._table.$view));\n\n\tvar locale = webix.i18n.spreadsheet.menus;\n\tconst lists = {\n\t\tdata:[\n\t\t\t{ id:\"clear\",\t\tvalue: locale[\"clear\"], submenu: getClearOperation()},\n\t\t\t{ id:\"lock-cell\",\t\tvalue: locale[\"lock-cell\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"sort\",\tvalue: locale.sort, submenu:[\n\t\t\t\t{id: \"sort-asc\", value: locale[\"sort-asc\"]},\n\t\t\t\t{id: \"sort-desc\", value: locale[\"sort-desc\"]}\n\t\t\t]},\n\t\t\t{id:\"create-filter\",\t\tvalue: locale[\"create-filter\"]},\n\t\t\t{ $template: \"Separator\"},\n\t\t\t{ id:\"add-range\",\t\tvalue: locale[\"add-range\"]},\n\t\t\t{ id:\"add-link\",\t\tvalue: locale[\"add-link\"]},\n\t\t\t{ id:\"add-comment\",\t\tvalue: locale[\"add-comment\"]}\n\t\t],\n\t\tcolumn: getColumnOperation(view),\n\t\trow: getRowOperation(view)\n\t};\n\n\n\tvar context = {\n\t\tview: \"contextmenu\",\n\t\tid: \"context\",\n\t\tpadding:0,\n\t\tsizeToContent:true,\n\t\tsubmenuConfig:{\n\t\t\tpadding:0,\n\t\t\ton:{\n\t\t\t\tonBeforeShow:function(){\n\t\t\t\t\tthis.sizeToContent();\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\tdata:[],\n\t\ton:{\n\t\t\tonMenuItemClick(id) {\n\t\t\t\tview.callEvent(\"onCommand\", [this.getMenuItem(id)]);\n\t\t\t},\n\t\t\tonBeforeShow(pos) {\n\t\t\t\twebix.callEvent(\"onClick\", []);\n\t\t\t\tvar mode, trg;\n\n\t\t\t\ttrg = view._table.locate(pos);\n\t\t\t\tif (!trg) return false;\n\n\t\t\t\tmode = \"\";\n\t\t\t\tif (trg.header && trg.column !== \"rowId\"){\n\t\t\t\t\tif (!isColSelected(trg.column, view))\n\t\t\t\t\t\tselectColumn(trg.column, view);\n\t\t\t\t\tmode = \"column\";\n\t\t\t\t} else if (trg.row){\n\t\t\t\t\tif (trg.column === \"rowId\"){\n\t\t\t\t\t\tif (!isRowSelected(trg.row, view))\n\t\t\t\t\t\t\tselectRow(trg.row, view);\n\t\t\t\t\t\tmode = \"row\";\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (!isCellSelected(trg.row, trg.column, view))\n\t\t\t\t\t\t\tview._table.addSelectArea(trg, trg);\n\t\t\t\t\t\tmode = \"data\";\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (mode){\n\t\t\t\t\tvar data = getMenuData(view, mode, lists[mode]);\n\t\t\t\t\tif (data){\n\t\t\t\t\t\tthis.clearAll();\n\t\t\t\t\t\tthis.parse(data);\n\t\t\t\t\t\twebix.html.preventEvent(pos);\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t};\n\n\tview.callEvent(\"onViewInit\", [\"context\", context]);\n\tview.ui(context);\n}\n\nexport function getMenuData(view, name, data){\n\tvar ev = { area:name, data:data };\n\tif (view.callEvent(\"onContextMenuConfig\", [ev]))\n\t\treturn ev && ev.data;\n\treturn null;\n}","import * as m1  from \"./add_row_col\";\nimport * as m6  from \"./clipboard\";\nimport * as m12 from \"./column_operations\";\nimport * as m2  from \"./conditional_formats\";\nimport * as m16a from \"../math/math\";\nimport * as m17 from \"./data\";\nimport * as m18 from \"./dropdown\";\nimport * as m7  from \"./formats\";\nimport * as m13 from \"./hide_row_col\";\nimport * as m14 from \"./lock_cell\";\nimport * as m3  from \"./resize\";\nimport * as m9  from \"./selection\";\nimport * as m10 from \"./sorting\";\nimport * as m16 from \"./spans\";\nimport * as m19 from \"./states\";\nimport * as m5  from \"./styles\";\nimport * as m11 from \"./undo\";\nimport * as m20 from \"./import\";\nimport * as m21 from \"./filter\";\nimport * as m22 from \"./print\";\nimport * as m23 from \"./export\";\nimport * as m24 from \"./load\";\nimport * as m25 from \"./clear_styles\";\nimport * as m26 from \"./comments\";\nimport * as m27 from \"./save\";\nimport * as m28 from \"./hide_headers\";\nimport * as m29 from \"./hide_gridlines\";\n\nexport function operations(view){\n\t//order in some cases does matter\n\t//resize must be applied after math, to size data by the result of math calculation\n\tvar all = [m1,m2,m5,m6,m7,m9,m10,m11,m12,m13,m14,m16,m16a,m3,m17,m18,m19,m20,m21,m22,m23,m24,m25,m26,m27,m28,m29];\n\tfor (var i = 0; i < all.length; i++)\n\t\tif (all[i].init)\n\t\t\tall[i].init(view);\n}","import * as rco from \"./row_col_operations\";\nimport * as lcl from \"./lock_cell\";\nimport * as fcl from \"./freeze\";\nimport * as hbr from \"./hide_gridlines\";\nimport * as hhd from \"./hide_headers\";\nimport * as hrc from \"./hide_rows\";\nimport * as mat from \"./math\";\nimport * as ops from \"./operations\";\nimport * as cor from \"./core\";\nimport * as sav from \"./save\";\nimport * as dpd from \"./dropdown\";\nimport * as cfm from \"./confirm\";\nimport * as und from \"./undo\";\nimport * as fmt from \"./number_formats\";\n\nexport function api(view){\n\tvar all = [rco, lcl, fcl, hbr, hhd, hrc, mat, ops, cor, sav, dpd, cfm, und, fmt];\n\tfor (var i = 0; i < all.length; i++)\n\t\twebix.extend(view, all[i]);\n}"],"names":["isChar","char","code","charCodeAt","getWord","formula","i","passive","max","length","sheet","quotes","j","key","substr","webix","i18n","spreadsheet","labels","tooltips","menus","table","protoUI","name","$cssName","$init","config","options","view","body","tooltip","template","xCount","yCount","data","ui","richselect","defaults","width","margin","cols","scroll","select","obj","id","on","onAfterSelect","this","getParentView","updateMasterValue","value","rows","css","title","onChange","hide","getValue","$$","master","setValue","getList","getColorView","getSelectedId","getBody","getChildViews","getItemText","suggest","fitMaster","$ready","push","bind","getPopup","isArray","callEvent","join","palette","colorboard","icon","borderless","height","onSelect","setMasterValue","$view","className","$renderInput","divStart","color","renderColor","call","replace","match","p1","p2","p3","colorpicker","prototype","$setValue","popup","toString","getColorNode","style","backgroundColor","firstChild","childNodes","$renderIcon","text","apply","arguments","buttons","getHeaderConfig","label","paddingX","paddingY","click","getTopParentView","getBodyConfig","content","elements","getFormElements","cancel","autowidth","save","body_setter","_typeof","window","head_setter","padding","move","head","autofocus","IdSpace","headerRowHeight","datatable","a","setHTML","type","dataview","contextmenu","filter","item","editor","cursor","getCursor","val","charAt","str1","substring","str2","search","toLowerCase","indexOf","attachEvent","node","tagName","_this","sizes","html","offset","textWidth","getTextSize","selectionStart","y","x","show","refresh","setValueHere","$enterKey","isVisible","operand","isPosition","test","position","word","row","sum","mode","flags","chars","namedRangeCode","deps","ranges","getCode","sheetInd","split","rangeCode","b","r1","c1","r2","c2","t","crosssheet","lines","index","ph","end","next","pushLine","getPopupConfig","onItemClick","button","params","getItem","area","getSelectArea","concat","start","_highlightedCells","e","_update_range","Date","_last_value_set","showActiveSheet","updateCellValue","delay","_table","moveSelection","preventDefault","getInputNode","ev","env","isIE8","eventRemove","inputEv","keydownEv","event","_this2","_cursor","highlightCells","setCursor","endEdit","input","suggestData","$handleSelection","_activeMath","getActiveSheet","cell","activeCell","define","showSheet","column","_this3","innerText","forEach","removeCellCss","_ranges","parts","colorIndex","crossheet","activeMath","activeSheet","cellText","rangeName","nextCell","nextCellText","cells","Math","min","col","addCellCss","innerHTML","getDocumentCursor","isUndefined","cursorNode","startContainer","contains","paintValue","sel","document","getSelection","rangeCount","getRangeAt","focus","pos","UIManager","setFocus","which","keyCode","dir","getItemNode","newv","getCellValue","setCellValue","$setValueHere","updatedStr","expectRange","trim","expectOperator","setRange","range","len","lastPos","symbolsBefore","childs","textLength","createRange","setStart","collapse","removeAllRanges","addRange","startOffset","parent","parentNode","layout","drag","dragscroll","EditAbility","list","toggle","onValue","offValue","common","inp","awidth","aheight","arrow","elementsConfig","labelWidth","_initOnChange","blockEvent","$eventSource","count","_count","$all","_findNext","unblockEvent","keys","base","labelRight","baseHeight","skin","$active","inputHeight","getValues","output","form","onSelectChange","group","set","method","uid","url","all","serialize","sheets","proxy","$parse","$proxy","ajax","headers","post","init","thread","events","handler","newName","_loading_data","clearTimeout","decode","encode","alpha","prefixIndex","parseInt","str","adress","size","nind","d1","d2","notAlphaNum","escapeSheet","toRange","x2","y2","rangeObj","eachRange","callback","rangeTest","isRange","changeRange","inc","updated","toolbarSizes","sectorPadding","sectorMargin","defaultStyles","sizeEl","style_names","_style_map","align","rowHeight","border_checks","_style_handlers","modes","_updateStyle","reset","_styles","_styles_cache","_styles_max","prefix","$index","removeStyle","getStyle","styles","getRow","$cellCss","styleid","addStyle","props","origin","_styleFromText","_styleToText","cache","_addStyle","_parse","styleObj","update_style_data","nstyle","copy","$cellFormat","format","setStyle","_setStyle","setRangeStyle","appendChild","scrollWidth","scrollHeight","removeChild","old","saveCell","silent","_buildCssString","clearRangeStyle","compactStyles","used","newStyles","formats","formatsCount","formatSources","formatCache","_applyStyles","eachSelectedCell","_applyCellStyles","ostyle","_serialize","_undoStyle","create","formatHelpers","setDefaultFormats","price","getFormat","extra","priceFormat","values","extend","zeros","priceSettings","decimalSize","symbol","separator","negative","getDelimiters","numberFormat","percent","round","serializeFormat","formToValues","groupSign","groupDelimiter","decimalSign","decimalDelimiter","getFormatSource","toexcel","parceFormat","getFormatName","format2code","addFormat","nev","delimiters","splitFormat","conditional","separated","separateFmt","genCode","condition","fmt","Function","check","line","ind","isAbs","genFormatCode","isQuote","comma","inserted","betweenPlaceholders","placeholder","decimal","getParts","left","right","reverse","lzeros","lfills","rzeros","rfills","rmax","changeAreaDecimals","getCells","r","c","firstValue","firstStyle","rules","isNumber","changeCellDecimals","setValues","updateDecimals","parced","decimals","placeholders","Array","slice","withoutText","withoutPlaceholders","hasOwnProperty","isCustom","formValues","toExcel","leftText","leftPlaceholders","rightText","fmtParts","sepFmtParts","getFmtPartValues","fmtPart","firstPlaceholder","Infinity","k","load","actions","span","isMerged","c0","getSpan","splitCell","confirm","res","combineCells","undo","redo","hideGridlines","hideHeaders","freezeColumns","freezeRows","fontFamily","getColumnOperation","locale","colOperations","resizeCell","getRowOperation","rowOperations","getClearOperation","getLocaleClear","$template","borders","styleFormats","colorButton","iconButton","btn","segmented","popupWidth","popupTemplate","popupEvents","titleHeight","condFormat","buttonsMap","getFontSize","numbers","fontSize","px","getCellFormats","currency","example","number","getText","getAllElements","calcButtons","groups","result","$button","insert","ready","selected","barStyles","toolbar","allElements","elm","bottombar","toolbarButtons","structure","checkButtons","getButtons","columns","block","blockColumns","bar","source","viewId","innerId","selectRow","endRow","last","_selectRange","selectAll","order","firstColumn","selectColumn","endColumn","isColSelected","selectedArea","isCellSelected","isRowSelected","selectColumns","addSelectArea","adjustColumn","eachRow","rowobj","$height","setColumnWidth","adjustRow","eachColumn","getColumnConfig","setRowHeight","highlightColRow","header","sr","er","sc","ec","getHeaderNode","addCss","removeCss","dragStartColumn","grid","showHandler","comments","_activeComment","editStatus","locate","visible","commentsView","get","viewonly","target","math","editMath","st","ed","undefined","addEventListener","cellIndex","dragEndColumn","cop","getEditor","isCellLocked","finalStep","ids","lastHeaderClick","headerClick","dblClick","shiftKey","lastClickedRow","editStop","activeElement","isContentEditable","getFocus","need_focus","setDefaultCss","$name","spans","leftSplit","areaselect","editable","editaction","liveEditor","minColumnWidth","minRowHeight","navigation","clipboard","clipboardDecimalDelimiter","templateCopy","cell_template","commented","helper","parsed","parseFloat","isNaN","newvalue","clearAll","columnCount","rowCount","el","nms","_hideColumn","refreshColumns","map","hideColumn","parse","_hideRow","isMac","addHotKey","readonly","$anyKey","edit","del","styleHotKey","v","ctrlU","preventEvent","ctrlP","attr","elementOn","state","_to_number","_combine","arr","SUM","AVERAGE","COUNT","COUNTA","COUNTBLANK","MAX","MIN","PRODUCT","product","SUMPRODUCT","sets","sp","s","SUMSQ","sq","pow","VARP","avg","STDEVP","sqrt","POWER","num","n","p","QUOTIENT","div","d","SQRT","ABS","abs","RAND","random","PI","INT","ROUND","digits","toFixed","ROUNDDOWN","floor","ROUNDUP","ceil","TRUNC","EVEN","ODD","CONCATENATE","LEFT","MID","RIGHT","LOWER","UPPER","toUpperCase","PROPER","temp","idx","TRIM","LEN","IMAGE","escape","SPARKLINE","color1","color2","negativeColor","Sparklines","getTemplate","LINK","IF","neg","methods","strings","other","methodsName","startEdit","clear","cellEditor","fillEditor","disableEditor","getCellEditor","disable","enable","en","pasteRange","updateRange","isEnabled","disabled","find","func","findIndex","actionMap","remove","_activeSheet","add","prepare","selectSheet","showItem","command","changePagerVisability","sheetTabWidth","showBatch","changePagerStatus","scrollPos","getScrollState","tabWidth","context","dataOrder","_sheets","splice","rename","defaultBottom","hidden","editValue","onClick","webix_ssheet_sheet_arrow","initSheetMenu","$sheetMenu","menuInit","menu","callAction","getMark","disableItem","enableItem","batch","scrollSheets","direction","scrollTo","newIndex","getNewTitle","getSheet","newSheet","changeId","tabs","getActive","getDimension","_resetTable","Dialog","$dialog","$hide","$show","close","unescape","DialogBox","box","preview","parseImage","server","images","showPreview","upload","startLoad","endLoad","onSaveClick","okClick","dialog","image","fillUrl","addImage","onHideClick","onCancelClick","file","reader","FileReader","onload","getFormView","readAsDataURL","response","imageURL","actives","passives","core","struct","pair","pairsheet","rawword","triggers","parser","_build_function","error_function","updateMath","action","stack","isRowFix","isColumnFix","cut","updateSheetNames","oldName","thisSheet","multiSheet","helpers","_mathSheetCache","param","getAccessor","clearMathCache","_mathSheetCore","_mathSheetHelpers","SheetAccessor","activeAccessor","passiveAccessor","page","formulas","getRangeCode","getCell","execute","getRange","getRangeValue","nullFilter","rangeValue","vals","unique","sort","empty","unshift","$empty","Ranges","_master","needUpdate","types","els","parseChart","color_def","color_pos","color_neg","renderPreview","visibleBatch","labelPosition","typesChangeHandler","sparkConfig","checkRange","addSparkline","alert","getSelectedRange","getRanges","toSheetRange","validate","exists","updateItem","theform","removeRange","editRange","correct","gravity","saveClick","autoheight","setCellEditor","fillForm","getFormats","updateForm","closeWin","forms","_safeInt","value2","collection","conditions","_getCondition","activeValue","_setCondition","_clean","display","onFocus","current_view","clearRow","getRows","getConditionStyle","conditionStyle","_this4","getSheets","filename","restoreValue","paper","fit","sheetnames","modal","vertical","print","_setComment","textarea","queryView","minWidth","minHeight","relative","resize","onViewResize","animate","showInput","addComment","onBlur","showTemplate","changeTextarea","comment","open","getHead","columnWidth","bases","aiw","asw","rgs","dpd","cnd","exp","lnk","pnt","cmt","lockCss","lockCell","_mapCellsCalls","_locks","newValue","cm","lock","updatePosition","locked","ignoreUndoReset","restoreHistory","_ssUndoHistory","_ssUndoCursor","addToHistory","$skipHistory","ignoreUndo","ignoreReset","step","prevData","undoHandlers","nvalue","ovalue","addSpan","setSpanValue","isEmpty","removeSpan","lx","ly","rx","ry","cx","cy","borderChecks","adjustSpan","checkSpan","selection","isFirstCell","oldValue","pasteSpan","cutted","translate","mapCells","rid","cid","pull","isUndo","undoSpan","setLockCss","checkSpanBorders","process","newData","oldData","getUpdateValues","_addColumn","add_column_count","_delColumn","del_column_count","deleted","_addRow","add_row_count","_delRow","del_row_count","update","loadChangedData","fixSelectArea","calculate","get_core","_execute","error","isFinite","active","rs","vs","m","solvedMath","solvedCounter","backtrak","applyMath","tkey","check_trigger","srow","scolumn","recalckCell","remove_triggers","trs","back","adds","bcell","add_triggers","blist","add_backtrack","holders","setPlaceholder","psh","recalckAll","getState","_dataParse","addEmptyCollection","_empty","_pull","rowId","columnId","clearConditionalFormats","_changeCondition","pasteCondition","oldCondition","newCondition","handlers","first","second","type_action","_undoCondition","_setCssFormat","cssFormat","_ssEditors","_ssFilters","clearEditors","refilter","filterSpreadSheet","isFilter","filters","addCellFilter","initial","pasteDropdown","updateFilters","dropdown","setCellFilter","setFilter","getFilterRange","useAsFilter","styledata","clipdata","$popup","on_click","ss_filter","editors","tblEditors","_clipboardToTable","cdata","fromSheet","ctrlKey","metaKey","_get_sel_style","mapSelection","getElementsByClassName","Object","allFiltersInZone","startRow","startCol","endCol","_clip_to_sel","leftTop","csv","delimiter","_changeDelimiter","record","removeFilter","_add_row_col","maxRow","maxCol","row_ind","col_ind","subtrans","tconfig","frozenColumns","frozenRows","_frozenColumns","_frozenRows","topSplit","hasValue","_undoValue","_hidden_cols_hash","_hidden_rows_hash","getIds","setColumnState","_showColumn","isColumnVisible","setRowState","_showRow","isRowVisible","showColumn","unselect","_updatePosition","h","hrows","hcols","_adjustRowHeight","wrap","headerOnly","refreshSelectArea","getColumn","_undoResize","defWidth","defHeight","nsizes","o","bs","blockStart","blockEnd","removeSelectArea","sorters","sortRange","fullrange","expandSelection","maxY","maxX","nr1","nr2","nc1","nc2","newrange","by","fullRow","element","shift","newMath","gridlines","getFilters","removeComment","getComment","removeCommentsRange","commentCell","_undoComment","modules","m1","m2","m3","m4","m5","m6","m7","m8","uploader","XMLHttpRequest","apiOnly","accept","startImport","fileDialog","_buildHtml","doc","xCorrection","baseIndex","sheetname","$customPrint","br","insertBefore","docFooter","_cleanHtml","_safeColor","_getStyles","cached","_getDefaults","font","sz","alignment","horizontal","wrapText","docHeader","_getDocStyle","delta","rIndex","cIndex","_getCellStyle","stl","border","rgb","fill","fgColor","italic","underline","bold","bottom","top","$exportView","rawValues","ignore","export_mode","_exportExcel","dataOnly","Sheet","Name","Ref","_excel_to_data","dataObj","styleshash","stylescount","_safeFont","va","safe","_parseExcel","driver","full","names","_parseCsv","getRecords","clearRange","callCommand","setSize","insertRow","deleteRow","insertColumn","deleteColumn","checkSpans","changeSpan","getColumnIndex","getIndexById","hideRow","chart","getSheetData","recalculate","registerMathMethod","addMethod","sid","spn","prop","rangeStr","setRangeValue","addSheet","clearSheet","renameSheet","editSheet","removeSheet","und","srt","cb","tbl","drd","addFilter","fs","isNull","modalbox","ok","resetUndo","groupUndo","setFormat","changeDecimals","defaultMenu","submenu","getMenuData","component","_base_index","getDefaultStyles","_sub_init","_set_handlers","$skin","setSkinDefaults","material","subbar","tblObj","attachTo","lists","sizeToContent","submenuConfig","onBeforeShow","onMenuItemClick","getMenuItem","trg","dialogs","rows_setter","operations","m9","m10","m11","m12","m13","m14","m16","m16a","m17","m18","m19","m20","m21","m22","m23","m24","m25","m26","m27","m28","m29","$onLoad","excel","api","rco","lcl","fcl","hbr","hhd","hrc","mat","ops","cor","sav","cfm","AtomDataLoader"],"mappings":"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"}